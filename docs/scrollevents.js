webpackJsonp([0,3],[,,,function(t,n,e){"use strict";function r(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}function i(t,n,e){return function(r,i){function o(){h.forEach(function(r,i){var a=Math.abs(p.window.scrollOrigin.x-r.positionOrigin.x),u=Math.abs(p.window.scrollOrigin.y-r.positionOrigin.y);1.1*p.window.rect.width>a&&1.1*p.window.rect.height>u&&(t.apply(void 0,[r.element].concat(s)),n.apply(void 0,[r.element].concat(s)),e.apply(void 0,[r.element].concat(s)),h.splice(i,1),h.length<=0&&p.off("scroll",o))})}function a(){h.forEach(function(r,i){var o=Math.abs(r.parent.scrollOrigin.x-r.positionOrigin.x),u=Math.abs(p.window.scrollOrigin.y-r.parent.positionOrigin.y);1.1*r.parent.rect.width>o&&1.1*p.window.rect.height>u&&(t.apply(void 0,[r.element].concat(s)),n.apply(void 0,[r.element].concat(s)),e.apply(void 0,[r.element].concat(s)),h.splice(i,1),h.length<=0&&p.off("scroll",a))})}function c(){h.forEach(function(r,i){var o=Math.abs(p.window.scrollOrigin.x-r.parent.positionOrigin.x),a=Math.abs(r.parent.scrollOrigin.y-r.positionOrigin.y);1.1*p.window.rect.width>o&&1.1*r.parent.rect.height>a&&(t.apply(void 0,[r.element].concat(s)),n.apply(void 0,[r.element].concat(s)),e.apply(void 0,[r.element].concat(s)),h.splice(i,1),h.length<=0&&p.off("scroll",c))})}for(var l=arguments.length,s=Array(l>2?l-2:0),f=2;f<l;f++)s[f-2]=arguments[f];var p=new u.Container(r,i),h=p.children;p.parents.length<=0||h.length<=0||("[object Window]"===toString.apply(p.parents[0].element)?(p.on("scroll",o),o()):p.parents[0].rect.width<p.parents[0].rect.scrollWidth?(p.on("scroll",a),a()):p.parents[0].rect.height<p.parents[0].rect.scrollHeight&&(p.on("scroll",c),c()))}}function o(t,n,e){return function(i){for(var o=arguments.length,a=Array(o>1?o-1:0),u=1;u<o;u++)a[u-1]=arguments[u];var l=document.querySelectorAll(i);l.forEach(function(i){function o(){var t=c.scrollY||c.pageYOffset;if(s<=t){var o=[i,!1].concat(a);n.apply(void 0,r(o)),e.apply(void 0,r(o))}else{var u=[i,!0].concat(a);n.apply(void 0,r(u)),e.apply(void 0,r(u))}}var u=i.getBoundingClientRect(),l=Math.floor(u.top)+(c.scrollY||c.pageYOffset),s=u.height+l;return t.apply(void 0,r([i].concat(a))),c.addEventListener("scroll",o,!1),o(),i})}}function a(t,n,e){return function(i){for(var o=arguments.length,a=Array(o>1?o-1:0),u=1;u<o;u++)a[u-1]=arguments[u];var c=[i].concat(a);t.apply(void 0,r(c)),n.apply(void 0,r(c)),e.apply(void 0,r(c))}}Object.defineProperty(n,"__esModule",{value:!0}),n.onScroll=i,n.onTop=o,n.onBottom=a;var u=e(14),c=document.defaultView},,,,function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0}),n.stickyheader=n.lazyimage=n.lazyaction=void 0;var i=e(15),o=r(i),a=e(16),u=r(a),c=e(17),l=r(c);n.lazyaction=o.default,n.lazyimage=u.default,n.stickyheader=l.default},,,function(t,n,e){var r=e(20);"string"==typeof r&&(r=[[t.i,r,""]]);e(1)(r,{});r.locals&&(t.exports=r.locals)},function(t,n,e){var r=e(21);"string"==typeof r&&(r=[[t.i,r,""]]);e(1)(r,{});r.locals&&(t.exports=r.locals)},,,function(t,n,e){"use strict";(function(t){function r(t){return t&&t.__esModule?t:{default:t}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.Container=n.ParentContainer=n.WindowContainer=n.TargetContainer=void 0;var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=e(23),u=r(a),c=document.defaultView,l=function(){function t(n,e){i(this,t),this.element=n,this.parent=e}return o(t,[{key:"position",get:function(){return{x:Math.floor(this.rect.left)+this.parent.scroll.x,y:Math.floor(this.rect.top)+this.parent.scroll.y}}},{key:"positionOrigin",get:function(){return{x:Math.floor(this.rect.width/2)+this.position.x,y:Math.floor(this.rect.height/2)+this.position.y}}},{key:"rect",get:function(){return this.element.getBoundingClientRect()}}]),t}(),s=function(){function t(n){var e=this;if(i(this,t),this.window=this,this.element=c,n){var r=document.querySelectorAll(n);this.children=Array.from(r,function(t){return new l(t,e)})}}return o(t,[{key:"on",value:function(t,n){this.element.addEventListener(t,n,!1)}},{key:"off",value:function(t,n){this.element.removeEventListener(t,n)}},{key:"position",get:function(){return{x:Math.floor(this.rect.width/2),y:Math.floor(this.rect.height/2)}}},{key:"rect",get:function(){return{top:0,left:0,width:this.element.innerWidth,height:this.element.innerHeight,scrollWidth:document.body.clientWidth,scrollHeight:document.body.clientHeight}}},{key:"scroll",get:function(){return{x:this.element.scrollX||this.element.pageXOffset,y:this.element.scrollY||this.element.pageYOffset}}},{key:"scrollOrigin",get:function(){return{x:Math.floor(this.rect.width/2)+this.scroll.x,y:Math.floor(this.rect.height/2)+this.scroll.y}}}]),t}(),f=function(){function n(t,e){var r=this;i(this,n),this.window=new s,this.element=t;var o=this.element.querySelectorAll(e);this.children=Array.from(o,function(t){return new l(t,r)})}return o(n,[{key:"on",value:function(t,n){this.element.addEventListener(t,n,!1)}},{key:"off",value:function(t,n){this.element.removeEventListener(t,n)}},{key:"position",get:function(){return{x:Math.floor(this.rect.left)+this.window.scroll.x,y:Math.floor(this.rect.top)+this.window.scroll.y}}},{key:"positionOrigin",get:function(){return{x:Math.floor(this.rect.width/2)+this.position.x,y:Math.floor(this.rect.height/2)+this.position.y}}},{key:"rect",get:function(){return Object.assign(this.element.getBoundingClientRect(),{scrollWidth:this.element.scrollWidth,scrollHeight:this.element.scrollHeight})}},{key:"scroll",get:function(){return{x:this.element.scrollLeft,y:this.element.scrollTop}}},{key:"scrollOrigin",get:function(){return{x:Math.floor(this.rect.width/2)+this.element.scrollLeft,y:Math.floor(this.rect.height/2)+this.element.scrollTop}}},{key:"style",get:function(){return t.getComputedStyle(this.element)}}]),n}(),p=function(){function t(n,e){if(i(this,t),this.window=new s,this.parents=[],"[object Window]"===toString.apply(n))this.parents.push(new s(e));else if("[object String]"===toString.apply(n)){var r=document.querySelectorAll(n);this.parents=Array.from(r,function(t){return new f(t,e)})}this.children=u.default.flatten(this.parents.map(function(t){return t.children}))}return o(t,[{key:"on",value:function(t,n){this.parents.forEach(function(e){return e.on(t,n)}),this.window.on(t,n)}},{key:"off",value:function(t,n){this.parents.forEach(function(e){return e.off(t,n)}),this.window.off(t,n)}}]),t}();n.TargetContainer=l,n.WindowContainer=s,n.ParentContainer=f,n.Container=p}).call(n,e(4))},function(t,n,e){"use strict";function r(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}function i(){}function o(t,n){for(var e=arguments.length,i=Array(e>2?e-2:0),o=2;o<e;o++)i[o-2]=arguments[o];n.apply(void 0,r([t].concat(i)))}function a(){}function u(t,n){for(var e=arguments.length,r=Array(e>2?e-2:0),u=2;u<e;u++)r[u-2]=arguments[u];var l=Object.assign({parent:window},r[r.length-1]);return(0,c.onScroll)(i,o,a).apply(void 0,[l.parent,t,n].concat(r))}Object.defineProperty(n,"__esModule",{value:!0}),n.default=u;var c=e(3)},function(t,n,e){"use strict";function r(t){t.setAttribute("aria-hidden","true")}function i(t,n){t.addEventListener("load",function n(e){t.removeEventListener(e.type,n),t.setAttribute("aria-busy","false"),t.setAttribute("aria-hidden","false")},!1);var e=t.getAttribute("data-"+n);t.setAttribute("src",e),t.setAttribute("aria-busy","true")}function o(t,n){t.removeAttribute("data-"+n)}function a(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{parent:window};return(0,u.onScroll)(r,i,o)(e.parent,t,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var u=e(3)},function(t,n,e){"use strict";function r(){}function i(t,n){if(n)t.setAttribute("aria-label","scroll"),t.style.top="",t.style.transform="";else{var e=t.getBoundingClientRect();t.setAttribute("aria-label","fixed"),t.style.top="-"+e.height+"px",t.style.transform="translate3d(0, "+e.height+"px, 0)"}}function o(){}Object.defineProperty(n,"__esModule",{value:!0});var a=e(3),u=(0,a.onTop)(r,i,o);n.default=u},,,function(t,n,e){n=t.exports=e(0)(),n.push([t.i,".lazyimage{transition-property:opacity,visibility;transition-duration:.3s}.lazyimage[aria-hidden=true]{opacity:0;visibility:hidden}.lazyimage[aria-hidden=false]{opacity:1;visibility:visible}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxhenlpbWFnZS5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsV0FDRSx1Q0FBeUMsQUFDekMsdUJBQTBCLENBVzNCLEFBVEMsNkJBQ0UsVUFBVyxBQUNYLGlCQUFtQixDQUNwQixBQUVELDhCQUNFLFVBQVcsQUFDWCxrQkFBb0IsQ0FDckIiLCJmaWxlIjoibGF6eWltYWdlLmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5sYXp5aW1hZ2Uge1xuICB0cmFuc2l0aW9uLXByb3BlcnR5OiBvcGFjaXR5LCB2aXNpYmlsaXR5O1xuICB0cmFuc2l0aW9uLWR1cmF0aW9uOiAwLjNzO1xuXG4gIEBuZXN0ICZbYXJpYS1oaWRkZW49XCJ0cnVlXCJdIHtcbiAgICBvcGFjaXR5OiAwO1xuICAgIHZpc2liaWxpdHk6IGhpZGRlbjtcbiAgfVxuXG4gIEBuZXN0ICZbYXJpYS1oaWRkZW49XCJmYWxzZVwiXSB7XG4gICAgb3BhY2l0eTogMTtcbiAgICB2aXNpYmlsaXR5OiB2aXNpYmxlO1xuICB9XG59XG4iXX0= */",""])},function(t,n,e){n=t.exports=e(0)(),n.push([t.i,".stickyheader{transition-property:transform;transition-duration:.3s}.stickyheader[aria-label=scroll]{position:relative}.stickyheader[aria-label=fixed]{left:0;position:fixed;z-index:1}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0aWNreWhlYWRlci5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsY0FDRSw4QkFBK0IsQUFDL0IsdUJBQTBCLENBVzNCLEFBVEMsaUNBQ0UsaUJBQW1CLENBQ3BCLEFBRUQsZ0NBQ0UsT0FBUSxBQUNSLGVBQWdCLEFBQ2hCLFNBQVcsQ0FDWiIsImZpbGUiOiJzdGlja3loZWFkZXIuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnN0aWNreWhlYWRlciB7XG4gIHRyYW5zaXRpb24tcHJvcGVydHk6IHRyYW5zZm9ybTtcbiAgdHJhbnNpdGlvbi1kdXJhdGlvbjogMC4zcztcblxuICBAbmVzdCAmW2FyaWEtbGFiZWw9XCJzY3JvbGxcIl0ge1xuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgfVxuXG4gIEBuZXN0ICZbYXJpYS1sYWJlbD1cImZpeGVkXCJdIHtcbiAgICBsZWZ0OiAwO1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB6LWluZGV4OiAxO1xuICB9XG59XG4iXX0= */",""])},,function(t,n,e){var r,i;(function(){function e(t){function n(n,e,r,i,o,a){for(;o>=0&&o<a;o+=t){var u=i?i[o]:o;r=e(r,n[u],u,n)}return r}return function(e,r,i,o){r=A(r,o,4);var a=!_(e)&&O.keys(e),u=(a||e).length,c=t>0?0:u-1;return arguments.length<3&&(i=e[a?a[c]:c],c+=t),n(e,r,i,a,c,u)}}function o(t){return function(n,e,r){e=B(e,r);for(var i=M(n),o=t>0?0:i-1;o>=0&&o<i;o+=t)if(e(n[o],o,n))return o;return-1}}function a(t,n,e){return function(r,i,o){var a=0,u=M(r);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+u,a):u=o>=0?Math.min(o+1,u):o+u+1;else if(e&&o&&u)return o=e(r,i),r[o]===i?o:-1;if(i!==i)return o=n(y.call(r,a,u),O.isNaN),o>=0?o+a:-1;for(o=t>0?a:u-1;o>=0&&o<u;o+=t)if(r[o]===i)return o;return-1}}function u(t,n){var e=z.length,r=t.constructor,i=O.isFunction(r)&&r.prototype||f,o="constructor";for(O.has(t,o)&&!O.contains(n,o)&&n.push(o);e--;)o=z[e],o in t&&t[o]!==i[o]&&!O.contains(n,o)&&n.push(o)}var c=this,l=c._,s=Array.prototype,f=Object.prototype,p=Function.prototype,h=s.push,y=s.slice,d=f.toString,v=f.hasOwnProperty,g=Array.isArray,m=Object.keys,b=p.bind,w=Object.create,x=function(){},O=function(t){return t instanceof O?t:this instanceof O?void(this._wrapped=t):new O(t)};"undefined"!=typeof t&&t.exports&&(n=t.exports=O),n._=O,O.VERSION="1.8.3";var A=function(t,n,e){if(void 0===n)return t;switch(null==e?3:e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,i){return t.call(n,e,r,i)};case 4:return function(e,r,i,o){return t.call(n,e,r,i,o)}}return function(){return t.apply(n,arguments)}},B=function(t,n,e){return null==t?O.identity:O.isFunction(t)?A(t,n,e):O.isObject(t)?O.matcher(t):O.property(t)};O.iteratee=function(t,n){return B(t,n,1/0)};var k=function(t,n){return function(e){var r=arguments.length;if(r<2||null==e)return e;for(var i=1;i<r;i++)for(var o=arguments[i],a=t(o),u=a.length,c=0;c<u;c++){var l=a[c];n&&void 0!==e[l]||(e[l]=o[l])}return e}},j=function(t){if(!O.isObject(t))return{};if(w)return w(t);x.prototype=t;var n=new x;return x.prototype=null,n},I=function(t){return function(n){return null==n?void 0:n[t]}},C=Math.pow(2,53)-1,M=I("length"),_=function(t){var n=M(t);return"number"==typeof n&&n>=0&&n<=C};O.each=O.forEach=function(t,n,e){n=A(n,e);var r,i;if(_(t))for(r=0,i=t.length;r<i;r++)n(t[r],r,t);else{var o=O.keys(t);for(r=0,i=o.length;r<i;r++)n(t[o[r]],o[r],t)}return t},O.map=O.collect=function(t,n,e){n=B(n,e);for(var r=!_(t)&&O.keys(t),i=(r||t).length,o=Array(i),a=0;a<i;a++){var u=r?r[a]:a;o[a]=n(t[u],u,t)}return o},O.reduce=O.foldl=O.inject=e(1),O.reduceRight=O.foldr=e(-1),O.find=O.detect=function(t,n,e){var r;if(r=_(t)?O.findIndex(t,n,e):O.findKey(t,n,e),void 0!==r&&r!==-1)return t[r]},O.filter=O.select=function(t,n,e){var r=[];return n=B(n,e),O.each(t,function(t,e,i){n(t,e,i)&&r.push(t)}),r},O.reject=function(t,n,e){return O.filter(t,O.negate(B(n)),e)},O.every=O.all=function(t,n,e){n=B(n,e);for(var r=!_(t)&&O.keys(t),i=(r||t).length,o=0;o<i;o++){var a=r?r[o]:o;if(!n(t[a],a,t))return!1}return!0},O.some=O.any=function(t,n,e){n=B(n,e);for(var r=!_(t)&&O.keys(t),i=(r||t).length,o=0;o<i;o++){var a=r?r[o]:o;if(n(t[a],a,t))return!0}return!1},O.contains=O.includes=O.include=function(t,n,e,r){return _(t)||(t=O.values(t)),("number"!=typeof e||r)&&(e=0),O.indexOf(t,n,e)>=0},O.invoke=function(t,n){var e=y.call(arguments,2),r=O.isFunction(n);return O.map(t,function(t){var i=r?n:t[n];return null==i?i:i.apply(t,e)})},O.pluck=function(t,n){return O.map(t,O.property(n))},O.where=function(t,n){return O.filter(t,O.matcher(n))},O.findWhere=function(t,n){return O.find(t,O.matcher(n))},O.max=function(t,n,e){var r,i,o=-(1/0),a=-(1/0);if(null==n&&null!=t){t=_(t)?t:O.values(t);for(var u=0,c=t.length;u<c;u++)r=t[u],r>o&&(o=r)}else n=B(n,e),O.each(t,function(t,e,r){i=n(t,e,r),(i>a||i===-(1/0)&&o===-(1/0))&&(o=t,a=i)});return o},O.min=function(t,n,e){var r,i,o=1/0,a=1/0;if(null==n&&null!=t){t=_(t)?t:O.values(t);for(var u=0,c=t.length;u<c;u++)r=t[u],r<o&&(o=r)}else n=B(n,e),O.each(t,function(t,e,r){i=n(t,e,r),(i<a||i===1/0&&o===1/0)&&(o=t,a=i)});return o},O.shuffle=function(t){for(var n,e=_(t)?t:O.values(t),r=e.length,i=Array(r),o=0;o<r;o++)n=O.random(0,o),n!==o&&(i[o]=i[n]),i[n]=e[o];return i},O.sample=function(t,n,e){return null==n||e?(_(t)||(t=O.values(t)),t[O.random(t.length-1)]):O.shuffle(t).slice(0,Math.max(0,n))},O.sortBy=function(t,n,e){return n=B(n,e),O.pluck(O.map(t,function(t,e,r){return{value:t,index:e,criteria:n(t,e,r)}}).sort(function(t,n){var e=t.criteria,r=n.criteria;if(e!==r){if(e>r||void 0===e)return 1;if(e<r||void 0===r)return-1}return t.index-n.index}),"value")};var W=function(t){return function(n,e,r){var i={};return e=B(e,r),O.each(n,function(r,o){var a=e(r,o,n);t(i,r,a)}),i}};O.groupBy=W(function(t,n,e){O.has(t,e)?t[e].push(n):t[e]=[n]}),O.indexBy=W(function(t,n,e){t[e]=n}),O.countBy=W(function(t,n,e){O.has(t,e)?t[e]++:t[e]=1}),O.toArray=function(t){return t?O.isArray(t)?y.call(t):_(t)?O.map(t,O.identity):O.values(t):[]},O.size=function(t){return null==t?0:_(t)?t.length:O.keys(t).length},O.partition=function(t,n,e){n=B(n,e);var r=[],i=[];return O.each(t,function(t,e,o){(n(t,e,o)?r:i).push(t)}),[r,i]},O.first=O.head=O.take=function(t,n,e){if(null!=t)return null==n||e?t[0]:O.initial(t,t.length-n)},O.initial=function(t,n,e){return y.call(t,0,Math.max(0,t.length-(null==n||e?1:n)))},O.last=function(t,n,e){if(null!=t)return null==n||e?t[t.length-1]:O.rest(t,Math.max(0,t.length-n))},O.rest=O.tail=O.drop=function(t,n,e){return y.call(t,null==n||e?1:n)},O.compact=function(t){return O.filter(t,O.identity)};var F=function(t,n,e,r){for(var i=[],o=0,a=r||0,u=M(t);a<u;a++){var c=t[a];if(_(c)&&(O.isArray(c)||O.isArguments(c))){n||(c=F(c,n,e));var l=0,s=c.length;for(i.length+=s;l<s;)i[o++]=c[l++]}else e||(i[o++]=c)}return i};O.flatten=function(t,n){return F(t,n,!1)},O.without=function(t){return O.difference(t,y.call(arguments,1))},O.uniq=O.unique=function(t,n,e,r){O.isBoolean(n)||(r=e,e=n,n=!1),null!=e&&(e=B(e,r));for(var i=[],o=[],a=0,u=M(t);a<u;a++){var c=t[a],l=e?e(c,a,t):c;n?(a&&o===l||i.push(c),o=l):e?O.contains(o,l)||(o.push(l),i.push(c)):O.contains(i,c)||i.push(c)}return i},O.union=function(){return O.uniq(F(arguments,!0,!0))},O.intersection=function(t){for(var n=[],e=arguments.length,r=0,i=M(t);r<i;r++){var o=t[r];if(!O.contains(n,o)){for(var a=1;a<e&&O.contains(arguments[a],o);a++);a===e&&n.push(o)}}return n},O.difference=function(t){var n=F(arguments,!0,!0,1);return O.filter(t,function(t){return!O.contains(n,t)})},O.zip=function(){return O.unzip(arguments)},O.unzip=function(t){for(var n=t&&O.max(t,M).length||0,e=Array(n),r=0;r<n;r++)e[r]=O.pluck(t,r);return e},O.object=function(t,n){for(var e={},r=0,i=M(t);r<i;r++)n?e[t[r]]=n[r]:e[t[r][0]]=t[r][1];return e},O.findIndex=o(1),O.findLastIndex=o(-1),O.sortedIndex=function(t,n,e,r){e=B(e,r,1);for(var i=e(n),o=0,a=M(t);o<a;){var u=Math.floor((o+a)/2);e(t[u])<i?o=u+1:a=u}return o},O.indexOf=a(1,O.findIndex,O.sortedIndex),O.lastIndexOf=a(-1,O.findLastIndex),O.range=function(t,n,e){null==n&&(n=t||0,t=0),e=e||1;for(var r=Math.max(Math.ceil((n-t)/e),0),i=Array(r),o=0;o<r;o++,t+=e)i[o]=t;return i};var X=function(t,n,e,r,i){if(!(r instanceof n))return t.apply(e,i);var o=j(t.prototype),a=t.apply(o,i);return O.isObject(a)?a:o};O.bind=function(t,n){if(b&&t.bind===b)return b.apply(t,y.call(arguments,1));if(!O.isFunction(t))throw new TypeError("Bind must be called on a function");var e=y.call(arguments,2),r=function(){return X(t,r,n,this,e.concat(y.call(arguments)))};return r},O.partial=function(t){var n=y.call(arguments,1),e=function(){for(var r=0,i=n.length,o=Array(i),a=0;a<i;a++)o[a]=n[a]===O?arguments[r++]:n[a];for(;r<arguments.length;)o.push(arguments[r++]);return X(t,e,this,this,o)};return e},O.bindAll=function(t){var n,e,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(n=1;n<r;n++)e=arguments[n],t[e]=O.bind(t[e],t);return t},O.memoize=function(t,n){var e=function(r){var i=e.cache,o=""+(n?n.apply(this,arguments):r);return O.has(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return e.cache={},e},O.delay=function(t,n){var e=y.call(arguments,2);return setTimeout(function(){return t.apply(null,e)},n)},O.defer=O.partial(O.delay,O,1),O.throttle=function(t,n,e){var r,i,o,a=null,u=0;e||(e={});var c=function(){u=e.leading===!1?0:O.now(),a=null,o=t.apply(r,i),a||(r=i=null)};return function(){var l=O.now();u||e.leading!==!1||(u=l);var s=n-(l-u);return r=this,i=arguments,s<=0||s>n?(a&&(clearTimeout(a),a=null),u=l,o=t.apply(r,i),a||(r=i=null)):a||e.trailing===!1||(a=setTimeout(c,s)),o}},O.debounce=function(t,n,e){var r,i,o,a,u,c=function(){var l=O.now()-a;l<n&&l>=0?r=setTimeout(c,n-l):(r=null,e||(u=t.apply(o,i),r||(o=i=null)))};return function(){o=this,i=arguments,a=O.now();var l=e&&!r;return r||(r=setTimeout(c,n)),l&&(u=t.apply(o,i),o=i=null),u}},O.wrap=function(t,n){return O.partial(n,t)},O.negate=function(t){return function(){return!t.apply(this,arguments)}},O.compose=function(){var t=arguments,n=t.length-1;return function(){for(var e=n,r=t[n].apply(this,arguments);e--;)r=t[e].call(this,r);return r}},O.after=function(t,n){return function(){if(--t<1)return n.apply(this,arguments)}},O.before=function(t,n){var e;return function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=null),e}},O.once=O.partial(O.before,2);var E=!{toString:null}.propertyIsEnumerable("toString"),z=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];O.keys=function(t){if(!O.isObject(t))return[];if(m)return m(t);var n=[];for(var e in t)O.has(t,e)&&n.push(e);return E&&u(t,n),n},O.allKeys=function(t){if(!O.isObject(t))return[];var n=[];for(var e in t)n.push(e);return E&&u(t,n),n},O.values=function(t){for(var n=O.keys(t),e=n.length,r=Array(e),i=0;i<e;i++)r[i]=t[n[i]];return r},O.mapObject=function(t,n,e){n=B(n,e);for(var r,i=O.keys(t),o=i.length,a={},u=0;u<o;u++)r=i[u],a[r]=n(t[r],r,t);return a},O.pairs=function(t){for(var n=O.keys(t),e=n.length,r=Array(e),i=0;i<e;i++)r[i]=[n[i],t[n[i]]];return r},O.invert=function(t){for(var n={},e=O.keys(t),r=0,i=e.length;r<i;r++)n[t[e[r]]]=e[r];return n},O.functions=O.methods=function(t){var n=[];for(var e in t)O.isFunction(t[e])&&n.push(e);return n.sort()},O.extend=k(O.allKeys),O.extendOwn=O.assign=k(O.keys),O.findKey=function(t,n,e){n=B(n,e);for(var r,i=O.keys(t),o=0,a=i.length;o<a;o++)if(r=i[o],n(t[r],r,t))return r},O.pick=function(t,n,e){var r,i,o={},a=t;if(null==a)return o;O.isFunction(n)?(i=O.allKeys(a),r=A(n,e)):(i=F(arguments,!1,!1,1),r=function(t,n,e){return n in e},a=Object(a));for(var u=0,c=i.length;u<c;u++){var l=i[u],s=a[l];r(s,l,a)&&(o[l]=s)}return o},O.omit=function(t,n,e){if(O.isFunction(n))n=O.negate(n);else{var r=O.map(F(arguments,!1,!1,1),String);n=function(t,n){return!O.contains(r,n)}}return O.pick(t,n,e)},O.defaults=k(O.allKeys,!0),O.create=function(t,n){var e=j(t);return n&&O.extendOwn(e,n),e},O.clone=function(t){return O.isObject(t)?O.isArray(t)?t.slice():O.extend({},t):t},O.tap=function(t,n){return n(t),t},O.isMatch=function(t,n){var e=O.keys(n),r=e.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var a=e[o];if(n[a]!==i[a]||!(a in i))return!1}return!0};var N=function(t,n,e,r){if(t===n)return 0!==t||1/t===1/n;if(null==t||null==n)return t===n;t instanceof O&&(t=t._wrapped),n instanceof O&&(n=n._wrapped);var i=d.call(t);if(i!==d.call(n))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!==+t?+n!==+n:0===+t?1/+t===1/n:+t===+n;case"[object Date]":case"[object Boolean]":return+t===+n}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof n)return!1;var a=t.constructor,u=n.constructor;if(a!==u&&!(O.isFunction(a)&&a instanceof a&&O.isFunction(u)&&u instanceof u)&&"constructor"in t&&"constructor"in n)return!1}e=e||[],r=r||[];for(var c=e.length;c--;)if(e[c]===t)return r[c]===n;if(e.push(t),r.push(n),o){if(c=t.length,c!==n.length)return!1;for(;c--;)if(!N(t[c],n[c],e,r))return!1}else{var l,s=O.keys(t);if(c=s.length,O.keys(n).length!==c)return!1;for(;c--;)if(l=s[c],!O.has(n,l)||!N(t[l],n[l],e,r))return!1}return e.pop(),r.pop(),!0};O.isEqual=function(t,n){return N(t,n)},O.isEmpty=function(t){return null==t||(_(t)&&(O.isArray(t)||O.isString(t)||O.isArguments(t))?0===t.length:0===O.keys(t).length)},O.isElement=function(t){return!(!t||1!==t.nodeType)},O.isArray=g||function(t){return"[object Array]"===d.call(t)},O.isObject=function(t){var n=typeof t;return"function"===n||"object"===n&&!!t},O.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){O["is"+t]=function(n){return d.call(n)==="[object "+t+"]"}}),O.isArguments(arguments)||(O.isArguments=function(t){return O.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(O.isFunction=function(t){return"function"==typeof t||!1}),O.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},O.isNaN=function(t){return O.isNumber(t)&&t!==+t},O.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===d.call(t)},O.isNull=function(t){return null===t},O.isUndefined=function(t){return void 0===t},O.has=function(t,n){return null!=t&&v.call(t,n)},O.noConflict=function(){return c._=l,this},O.identity=function(t){return t},O.constant=function(t){return function(){return t}},O.noop=function(){},O.property=I,O.propertyOf=function(t){return null==t?function(){}:function(n){return t[n]}},O.matcher=O.matches=function(t){return t=O.extendOwn({},t),function(n){return O.isMatch(n,t)}},O.times=function(t,n,e){var r=Array(Math.max(0,t));n=A(n,e,1);for(var i=0;i<t;i++)r[i]=n(i);return r},O.random=function(t,n){return null==n&&(n=t,t=0),t+Math.floor(Math.random()*(n-t+1))},O.now=Date.now||function(){return(new Date).getTime()};var L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},S=O.invert(L),Y=function(t){var n=function(n){return t[n]},e="(?:"+O.keys(t).join("|")+")",r=RegExp(e),i=RegExp(e,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,n):t}};O.escape=Y(L),O.unescape=Y(S),O.result=function(t,n,e){var r=null==t?void 0:t[n];return void 0===r&&(r=e),O.isFunction(r)?r.call(t):r};var Z=0;O.uniqueId=function(t){var n=++Z+"";return t?t+n:n},O.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Q=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},J=/\\|'|\r|\n|\u2028|\u2029/g,U=function(t){return"\\"+R[t]};O.template=function(t,n,e){!n&&e&&(n=e),n=O.defaults({},n,O.templateSettings);var r=RegExp([(n.escape||Q).source,(n.interpolate||Q).source,(n.evaluate||Q).source].join("|")+"|$","g"),i=0,o="__p+='";t.replace(r,function(n,e,r,a,u){return o+=t.slice(i,u).replace(J,U),i=u+n.length,e?o+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),n}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=new Function(n.variable||"obj","_",o)}catch(t){throw t.source=o,t}var u=function(t){return a.call(this,t,O)},c=n.variable||"obj";return u.source="function("+c+"){\n"+o+"}",u},O.chain=function(t){var n=O(t);return n._chain=!0,n};var V=function(t,n){return t._chain?O(n).chain():n};O.mixin=function(t){O.each(O.functions(t),function(n){var e=O[n]=t[n];O.prototype[n]=function(){var t=[this._wrapped];return h.apply(t,arguments),V(this,e.apply(O,t))}})},O.mixin(O),O.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=s[t];O.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!==t&&"splice"!==t||0!==e.length||delete e[0],V(this,e)}}),O.each(["concat","join","slice"],function(t){var n=s[t];O.prototype[t]=function(){return V(this,n.apply(this._wrapped,arguments))}}),O.prototype.value=function(){return this._wrapped},O.prototype.valueOf=O.prototype.toJSON=O.prototype.value,O.prototype.toString=function(){return""+this._wrapped},r=[],i=function(){return O}.apply(n,r),!(void 0!==i&&(t.exports=i))}).call(this)},,,function(t,n,e){"use strict";function r(t,n){t.textContent="Hello, "+n()+"."}function i(t){document.removeEventListener(t.type,i),(0,o.lazyaction)(".lazyaction",r,Date.now),(0,o.lazyimage)(".horizontal-scroll-box .lazyimage","src",{parent:".horizontal-scroll-box"}),(0,o.lazyimage)(".vertical-scroll-area .lazyimage","src"),(0,o.lazyimage)(".vertical-scroll-box .lazyimage","src",{parent:".vertical-scroll-box"}),(0,o.stickyheader)(".stickyheader")}var o=e(7);e(10),e(11),e(2),document.addEventListener("DOMContentLoaded",i,!1)}],[26]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc2Nyb2xsZXZlbnRzLmpzIiwid2VicGFjazovLy8uL3NyYy9TY3JvbGxBY3Rpb24vc2Nyb2xsYWN0aW9uLmpzIiwid2VicGFjazovLy8uL3NyYy9TY3JvbGxBY3Rpb24vaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Njcm9sbEFjdGlvbi9sYXp5aW1hZ2UuY3NzP2RjNTEiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Njcm9sbEFjdGlvbi9zdGlja3loZWFkZXIuY3NzPzlkMjMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Njcm9sbEFjdGlvbi9jb250YWluZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Njcm9sbEFjdGlvbi9sYXp5YWN0aW9uLmpzIiwid2VicGFjazovLy8uL3NyYy9TY3JvbGxBY3Rpb24vbGF6eWltYWdlLmpzIiwid2VicGFjazovLy8uL3NyYy9TY3JvbGxBY3Rpb24vc3RpY2t5aGVhZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9TY3JvbGxBY3Rpb24vbGF6eWltYWdlLmNzcyIsIndlYnBhY2s6Ly8vLi9zcmMvU2Nyb2xsQWN0aW9uL3N0aWNreWhlYWRlci5jc3MiLCJ3ZWJwYWNrOi8vLy4vfi91bmRlcnNjb3JlL3VuZGVyc2NvcmUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3Njcm9sbGV2ZW50cy5qcyJdLCJuYW1lcyI6WyJ3ZWJwYWNrSnNvbnAiLCJtb2R1bGUiLCJleHBvcnRzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIl90b0NvbnN1bWFibGVBcnJheSIsImFyciIsIkFycmF5IiwiaXNBcnJheSIsImkiLCJhcnIyIiwibGVuZ3RoIiwiZnJvbSIsIm9uU2Nyb2xsIiwicHJlcHJvY2VzcyIsInByb2Nlc3MiLCJwb3N0cHJvY2VzcyIsInBhcmVudFNlbGVjdG9yIiwidGFyZ2V0U2VsZWN0b3IiLCJzY3JvbGwiLCJ0YXJnZXRzIiwiZm9yRWFjaCIsInRhcmdldCIsImluZGV4IiwiZGlmZmVyZW5jZVgiLCJNYXRoIiwiYWJzIiwiY29udGFpbmVyIiwid2luZG93Iiwic2Nyb2xsT3JpZ2luIiwieCIsInBvc2l0aW9uT3JpZ2luIiwiZGlmZmVyZW5jZVkiLCJ5IiwicmVjdCIsIndpZHRoIiwiaGVpZ2h0IiwiZWxlbWVudCIsImNvbmNhdCIsImFyZ3MiLCJzcGxpY2UiLCJvZmYiLCJvdmVyZmxvd1giLCJwYXJlbnQiLCJvdmVyZmxvd1kiLCJfbGVuIiwiYXJndW1lbnRzIiwiX2tleSIsIl9jb250YWluZXIiLCJDb250YWluZXIiLCJjaGlsZHJlbiIsInBhcmVudHMiLCJ0b1N0cmluZyIsImFwcGx5Iiwib24iLCJzY3JvbGxXaWR0aCIsInNjcm9sbEhlaWdodCIsIm9uVG9wIiwic2VsZWN0b3IiLCJfbGVuMiIsIl9rZXkyIiwiZWxlbWVudHMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ3aW5kb3dTY3JvbGxZIiwid2luIiwic2Nyb2xsWSIsInBhZ2VZT2Zmc2V0IiwiZWxlbWVudE9yaWdpblkiLCJwcm9jZXNzQXJncyIsImVsZW1lbnRSZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiZWxlbWVudFBvc2l0aW9uWSIsImZsb29yIiwidG9wIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uQm90dG9tIiwiX2xlbjMiLCJfa2V5MyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJkZWZhdWx0VmlldyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsInN0aWNreWhlYWRlciIsImxhenlpbWFnZSIsImxhenlhY3Rpb24iLCJ1bmRlZmluZWQiLCJfbGF6eWFjdGlvbiIsIl9sYXp5YWN0aW9uMiIsIl9sYXp5aW1hZ2UiLCJfbGF6eWltYWdlMiIsIl9zdGlja3loZWFkZXIiLCJfc3RpY2t5aGVhZGVyMiIsImNvbnRlbnQiLCJsb2NhbHMiLCJnbG9iYWwiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiUGFyZW50Q29udGFpbmVyIiwiV2luZG93Q29udGFpbmVyIiwiVGFyZ2V0Q29udGFpbmVyIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInByb3BzIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIl91bmRlcnNjb3JlIiwiX3VuZGVyc2NvcmUyIiwidGFyZ2V0RWxlbWVudCIsInBhcmVudENvbnRhaW5lciIsInRoaXMiLCJnZXQiLCJsZWZ0IiwicG9zaXRpb24iLCJjaGlsZHJlblNlbGVjdG9yIiwiX3RoaXMiLCJjaGlsZCIsImV2ZW50bmFtZSIsImNhbGxiYWNrIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsImJvZHkiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsInNjcm9sbFgiLCJwYWdlWE9mZnNldCIsInBhcmVudEVsZW1lbnQiLCJfdGhpczIiLCJhc3NpZ24iLCJzY3JvbGxMZWZ0Iiwic2Nyb2xsVG9wIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInB1c2giLCJwYXJlbnRFbGVtZW50cyIsImZsYXR0ZW4iLCJtYXAiLCJjYWxsIiwib3B0aW9ucyIsIl9zY3JvbGxhY3Rpb24iLCJzZXRBdHRyaWJ1dGUiLCJkYXRhbmFtZSIsImxvYWQiLCJldiIsInR5cGUiLCJkYXRhYXR0ciIsImdldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsIm9udG9wIiwic3R5bGUiLCJ0cmFuc2Zvcm0iLCJfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18iLCJjcmVhdGVSZWR1Y2UiLCJkaXIiLCJpdGVyYXRvciIsIml0ZXJhdGVlIiwibWVtbyIsImtleXMiLCJjdXJyZW50S2V5IiwiY29udGV4dCIsIm9wdGltaXplQ2IiLCJpc0FycmF5TGlrZSIsIl8iLCJjcmVhdGVQcmVkaWNhdGVJbmRleEZpbmRlciIsImFycmF5IiwicHJlZGljYXRlIiwiY2IiLCJnZXRMZW5ndGgiLCJjcmVhdGVJbmRleEZpbmRlciIsInByZWRpY2F0ZUZpbmQiLCJzb3J0ZWRJbmRleCIsIml0ZW0iLCJpZHgiLCJtYXgiLCJtaW4iLCJzbGljZSIsImlzTmFOIiwiY29sbGVjdE5vbkVudW1Qcm9wcyIsIm5vbkVudW1JZHgiLCJub25FbnVtZXJhYmxlUHJvcHMiLCJjb25zdHJ1Y3RvciIsInByb3RvIiwiaXNGdW5jdGlvbiIsIk9ialByb3RvIiwicHJvcCIsImhhcyIsImNvbnRhaW5zIiwicm9vdCIsInByZXZpb3VzVW5kZXJzY29yZSIsIkFycmF5UHJvdG8iLCJGdW5jUHJvdG8iLCJGdW5jdGlvbiIsImhhc093blByb3BlcnR5IiwibmF0aXZlSXNBcnJheSIsIm5hdGl2ZUtleXMiLCJuYXRpdmVCaW5kIiwiYmluZCIsIm5hdGl2ZUNyZWF0ZSIsImNyZWF0ZSIsIkN0b3IiLCJfd3JhcHBlZCIsIlZFUlNJT04iLCJmdW5jIiwiYXJnQ291bnQiLCJvdGhlciIsImNvbGxlY3Rpb24iLCJhY2N1bXVsYXRvciIsImlkZW50aXR5IiwiaXNPYmplY3QiLCJtYXRjaGVyIiwicHJvcGVydHkiLCJJbmZpbml0eSIsImNyZWF0ZUFzc2lnbmVyIiwia2V5c0Z1bmMiLCJ1bmRlZmluZWRPbmx5Iiwic291cmNlIiwibCIsImJhc2VDcmVhdGUiLCJyZXN1bHQiLCJNQVhfQVJSQVlfSU5ERVgiLCJwb3ciLCJlYWNoIiwiY29sbGVjdCIsInJlc3VsdHMiLCJyZWR1Y2UiLCJmb2xkbCIsImluamVjdCIsInJlZHVjZVJpZ2h0IiwiZm9sZHIiLCJmaW5kIiwiZGV0ZWN0IiwiZmluZEluZGV4IiwiZmluZEtleSIsImZpbHRlciIsInNlbGVjdCIsImxpc3QiLCJyZWplY3QiLCJuZWdhdGUiLCJldmVyeSIsImFsbCIsInNvbWUiLCJhbnkiLCJpbmNsdWRlcyIsImluY2x1ZGUiLCJmcm9tSW5kZXgiLCJndWFyZCIsInZhbHVlcyIsImluZGV4T2YiLCJpbnZva2UiLCJtZXRob2QiLCJpc0Z1bmMiLCJwbHVjayIsIndoZXJlIiwiYXR0cnMiLCJmaW5kV2hlcmUiLCJjb21wdXRlZCIsImxhc3RDb21wdXRlZCIsInNodWZmbGUiLCJyYW5kIiwic2V0Iiwic2h1ZmZsZWQiLCJyYW5kb20iLCJzYW1wbGUiLCJuIiwic29ydEJ5IiwiY3JpdGVyaWEiLCJzb3J0IiwicmlnaHQiLCJhIiwiYiIsImdyb3VwIiwiYmVoYXZpb3IiLCJncm91cEJ5IiwiaW5kZXhCeSIsImNvdW50QnkiLCJ0b0FycmF5Iiwic2l6ZSIsInBhcnRpdGlvbiIsInBhc3MiLCJmYWlsIiwiZmlyc3QiLCJoZWFkIiwidGFrZSIsImluaXRpYWwiLCJsYXN0IiwicmVzdCIsInRhaWwiLCJkcm9wIiwiY29tcGFjdCIsImlucHV0Iiwic2hhbGxvdyIsInN0cmljdCIsInN0YXJ0SW5kZXgiLCJvdXRwdXQiLCJpc0FyZ3VtZW50cyIsImoiLCJsZW4iLCJ3aXRob3V0IiwiZGlmZmVyZW5jZSIsInVuaXEiLCJ1bmlxdWUiLCJpc1NvcnRlZCIsImlzQm9vbGVhbiIsInNlZW4iLCJ1bmlvbiIsImludGVyc2VjdGlvbiIsImFyZ3NMZW5ndGgiLCJ6aXAiLCJ1bnppcCIsIm9iamVjdCIsImZpbmRMYXN0SW5kZXgiLCJsb3ciLCJoaWdoIiwibWlkIiwibGFzdEluZGV4T2YiLCJyYW5nZSIsInN0YXJ0Iiwic3RvcCIsInN0ZXAiLCJjZWlsIiwiZXhlY3V0ZUJvdW5kIiwic291cmNlRnVuYyIsImJvdW5kRnVuYyIsImNhbGxpbmdDb250ZXh0Iiwic2VsZiIsImJvdW5kIiwicGFydGlhbCIsImJvdW5kQXJncyIsImJpbmRBbGwiLCJFcnJvciIsIm1lbW9pemUiLCJoYXNoZXIiLCJjYWNoZSIsImFkZHJlc3MiLCJkZWxheSIsIndhaXQiLCJzZXRUaW1lb3V0IiwiZGVmZXIiLCJ0aHJvdHRsZSIsInRpbWVvdXQiLCJwcmV2aW91cyIsImxhdGVyIiwibGVhZGluZyIsIm5vdyIsInJlbWFpbmluZyIsImNsZWFyVGltZW91dCIsInRyYWlsaW5nIiwiZGVib3VuY2UiLCJpbW1lZGlhdGUiLCJ0aW1lc3RhbXAiLCJjYWxsTm93Iiwid3JhcCIsIndyYXBwZXIiLCJjb21wb3NlIiwiYWZ0ZXIiLCJ0aW1lcyIsImJlZm9yZSIsIm9uY2UiLCJoYXNFbnVtQnVnIiwicHJvcGVydHlJc0VudW1lcmFibGUiLCJhbGxLZXlzIiwibWFwT2JqZWN0IiwicGFpcnMiLCJpbnZlcnQiLCJmdW5jdGlvbnMiLCJtZXRob2RzIiwibmFtZXMiLCJleHRlbmQiLCJleHRlbmRPd24iLCJwaWNrIiwib2l0ZXJhdGVlIiwib21pdCIsIlN0cmluZyIsImRlZmF1bHRzIiwiY2xvbmUiLCJ0YXAiLCJpbnRlcmNlcHRvciIsImlzTWF0Y2giLCJlcSIsImFTdGFjayIsImJTdGFjayIsImNsYXNzTmFtZSIsImFyZUFycmF5cyIsImFDdG9yIiwiYkN0b3IiLCJwb3AiLCJpc0VxdWFsIiwiaXNFbXB0eSIsImlzU3RyaW5nIiwiaXNFbGVtZW50Iiwibm9kZVR5cGUiLCJuYW1lIiwiSW50OEFycmF5IiwiaXNGaW5pdGUiLCJwYXJzZUZsb2F0IiwiaXNOdW1iZXIiLCJpc051bGwiLCJpc1VuZGVmaW5lZCIsIm5vQ29uZmxpY3QiLCJjb25zdGFudCIsIm5vb3AiLCJwcm9wZXJ0eU9mIiwibWF0Y2hlcyIsImFjY3VtIiwiRGF0ZSIsImdldFRpbWUiLCJlc2NhcGVNYXAiLCImIiwiPCIsIj4iLCJcIiIsIiciLCJgIiwidW5lc2NhcGVNYXAiLCJjcmVhdGVFc2NhcGVyIiwiZXNjYXBlciIsIm1hdGNoIiwiam9pbiIsInRlc3RSZWdleHAiLCJSZWdFeHAiLCJyZXBsYWNlUmVnZXhwIiwic3RyaW5nIiwidGVzdCIsInJlcGxhY2UiLCJlc2NhcGUiLCJ1bmVzY2FwZSIsImZhbGxiYWNrIiwiaWRDb3VudGVyIiwidW5pcXVlSWQiLCJwcmVmaXgiLCJpZCIsInRlbXBsYXRlU2V0dGluZ3MiLCJldmFsdWF0ZSIsImludGVycG9sYXRlIiwibm9NYXRjaCIsImVzY2FwZXMiLCJcXCIsIlxyIiwiXG4iLCLigKgiLCLigKkiLCJlc2NhcGVDaGFyIiwidGVtcGxhdGUiLCJ0ZXh0Iiwic2V0dGluZ3MiLCJvbGRTZXR0aW5ncyIsIm9mZnNldCIsInZhcmlhYmxlIiwicmVuZGVyIiwiZSIsImRhdGEiLCJhcmd1bWVudCIsImNoYWluIiwiX2NoYWluIiwibWl4aW4iLCJ2YWx1ZU9mIiwidG9KU09OIiwiYWN0aW9uIiwidGV4dENvbnRlbnQiLCJpbml0IiwiX2luZGV4Il0sIm1hcHBpbmdzIjoiQUFBQUEsY0FBYyxFQUFFLElBQ1QsQ0FDQSxDQUNBLENBRUQsU0FBVUMsRUFBUUMsRUFBU0MsR0FFakMsWUFZQSxTQUFTQyxHQUFtQkMsR0FBTyxHQUFJQyxNQUFNQyxRQUFRRixHQUFNLENBQUUsSUFBSyxHQUFJRyxHQUFJLEVBQUdDLEVBQU9ILE1BQU1ELEVBQUlLLFFBQVNGLEVBQUlILEVBQUlLLE9BQVFGLElBQU9DLEVBQUtELEdBQUtILEVBQUlHLEVBQU0sT0FBT0MsR0FBZSxNQUFPSCxPQUFNSyxLQUFLTixHQ1puTCxRQUFTTyxHQUFVQyxFQUFZQyxFQUFTQyxHQUM3QyxNQUFPLFVBQVVDLEVBQWdCQyxHQU0vQixRQUFTQyxLQUNQQyxFQUFRQyxRQUFRLFNBQUNDLEVBQVFDLEdBQ3ZCLEdBQU1DLEdBQWNDLEtBQUtDLElBQUlDLEVBQVVDLE9BQU9DLGFBQWFDLEVBQUlSLEVBQU9TLGVBQWVELEdBQy9FRSxFQUFjUCxLQUFLQyxJQUFJQyxFQUFVQyxPQUFPQyxhQUFhSSxFQUFJWCxFQUFPUyxlQUFlRSxFQUVuRCxLQUE5Qk4sRUFBVUMsT0FBT00sS0FBS0MsTUFBY1gsR0FDTCxJQUEvQkcsRUFBVUMsT0FBT00sS0FBS0UsT0FBZUosSUFDdkNsQixnQkFBV1EsRUFBT2UsU0FBbEJDLE9BQThCQyxJQUM5QnhCLGdCQUFRTyxFQUFPZSxTQUFmQyxPQUEyQkMsSUFDM0J2QixnQkFBWU0sRUFBT2UsU0FBbkJDLE9BQStCQyxJQUMvQm5CLEVBQVFvQixPQUFPakIsRUFBTyxHQUNsQkgsRUFB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YixFQUFTK1QsR0FDeEIvVCxFQUFRa2IsWUFBUixVQUFnQ25ILElBQWhDLElBR0YsUUFBU29ILEdBQU03VCxHQUNiN0YsU0FBU3FFLG9CQUFvQndCLEVBQUdDLEtBQU00VCxJQUN0QyxFQUFBQyxFQUFBaFksWUFBVyxjQUFlNlgsRUFBUXJELEtBQUs3RCxNQUN2QyxFQUFBcUgsRUFBQWpZLFdBQVUsb0NBQXFDLE9BQVM3QyxPQUFRLDRCQUNoRSxFQUFBOGEsRUFBQWpZLFdBQVUsbUNBQW9DLFFBQzlDLEVBQUFpWSxFQUFBalksV0FBVSxrQ0FBbUMsT0FBUzdDLE9BQVEsMEJBQzlELEVBQUE4YSxFQUFBbFksY0FBYSxpQkFmZixHQUFBa1ksR0FBQXJkLEVBQUEsRUFDQUEsR0FBQSxJQUNBQSxFQUFBLElBQ0FBLEVBQUEsR0FlQTBELFNBQVNhLGlCQUFpQixtQkFBb0I2WSxHQUFNLE1aMHBFakQiLCJmaWxlIjoic2Nyb2xsZXZlbnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsid2VicGFja0pzb25wKFswLDNdLFtcbi8qIDAgKi8sXG4vKiAxICovLFxuLyogMiAqLyxcbi8qIDMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMub25TY3JvbGwgPSBvblNjcm9sbDtcbmV4cG9ydHMub25Ub3AgPSBvblRvcDtcbmV4cG9ydHMub25Cb3R0b20gPSBvbkJvdHRvbTtcblxudmFyIF9jb250YWluZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KTtcblxuZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfSBlbHNlIHsgcmV0dXJuIEFycmF5LmZyb20oYXJyKTsgfSB9XG5cbnZhciB3aW4gPSBkb2N1bWVudC5kZWZhdWx0VmlldztcblxuLyoqXG4gKiBEZXRlY3Qgc2Nyb2xsIGV2ZW50cyBmb3IgZWxlbWVudHNcbiAqL1xuZnVuY3Rpb24gb25TY3JvbGwocHJlcHJvY2VzcywgcHJvY2VzcywgcG9zdHByb2Nlc3MpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChwYXJlbnRTZWxlY3RvciwgdGFyZ2V0U2VsZWN0b3IpIHtcbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4gPiAyID8gX2xlbiAtIDIgOiAwKSwgX2tleSA9IDI7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDJdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIHZhciBjb250YWluZXIgPSBuZXcgX2NvbnRhaW5lci5Db250YWluZXIocGFyZW50U2VsZWN0b3IsIHRhcmdldFNlbGVjdG9yKTtcbiAgICB2YXIgdGFyZ2V0cyA9IGNvbnRhaW5lci5jaGlsZHJlbjtcblxuICAgIGlmIChjb250YWluZXIucGFyZW50cy5sZW5ndGggPD0gMCB8fCB0YXJnZXRzLmxlbmd0aCA8PSAwKSByZXR1cm47XG5cbiAgICBmdW5jdGlvbiBzY3JvbGwoKSB7XG4gICAgICB0YXJnZXRzLmZvckVhY2goZnVuY3Rpb24gKHRhcmdldCwgaW5kZXgpIHtcbiAgICAgICAgdmFyIGRpZmZlcmVuY2VYID0gTWF0aC5hYnMoY29udGFpbmVyLndpbmRvdy5zY3JvbGxPcmlnaW4ueCAtIHRhcmdldC5wb3NpdGlvbk9yaWdpbi54KTtcbiAgICAgICAgdmFyIGRpZmZlcmVuY2VZID0gTWF0aC5hYnMoY29udGFpbmVyLndpbmRvdy5zY3JvbGxPcmlnaW4ueSAtIHRhcmdldC5wb3NpdGlvbk9yaWdpbi55KTtcblxuICAgICAgICBpZiAoY29udGFpbmVyLndpbmRvdy5yZWN0LndpZHRoICogMS4xID4gZGlmZmVyZW5jZVggJiYgY29udGFpbmVyLndpbmRvdy5yZWN0LmhlaWdodCAqIDEuMSA+IGRpZmZlcmVuY2VZKSB7XG4gICAgICAgICAgcHJlcHJvY2Vzcy5hcHBseSh1bmRlZmluZWQsIFt0YXJnZXQuZWxlbWVudF0uY29uY2F0KGFyZ3MpKTtcbiAgICAgICAgICBwcm9jZXNzLmFwcGx5KHVuZGVmaW5lZCwgW3RhcmdldC5lbGVtZW50XS5jb25jYXQoYXJncykpO1xuICAgICAgICAgIHBvc3Rwcm9jZXNzLmFwcGx5KHVuZGVmaW5lZCwgW3RhcmdldC5lbGVtZW50XS5jb25jYXQoYXJncykpO1xuICAgICAgICAgIHRhcmdldHMuc3BsaWNlKGluZGV4LCAxKTsgLy8gUmVtb3ZlIGFuIGl0ZW0gZnJvbSB0YXJnZXRzIGJ5IHNpZGUgZWZmZWN0XG4gICAgICAgICAgaWYgKHRhcmdldHMubGVuZ3RoIDw9IDApIGNvbnRhaW5lci5vZmYoJ3Njcm9sbCcsIHNjcm9sbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG92ZXJmbG93WCgpIHtcbiAgICAgIHRhcmdldHMuZm9yRWFjaChmdW5jdGlvbiAodGFyZ2V0LCBpbmRleCkge1xuICAgICAgICB2YXIgZGlmZmVyZW5jZVggPSBNYXRoLmFicyh0YXJnZXQucGFyZW50LnNjcm9sbE9yaWdpbi54IC0gdGFyZ2V0LnBvc2l0aW9uT3JpZ2luLngpO1xuICAgICAgICB2YXIgZGlmZmVyZW5jZVkgPSBNYXRoLmFicyhjb250YWluZXIud2luZG93LnNjcm9sbE9yaWdpbi55IC0gdGFyZ2V0LnBhcmVudC5wb3NpdGlvbk9yaWdpbi55KTtcblxuICAgICAgICBpZiAodGFyZ2V0LnBhcmVudC5yZWN0LndpZHRoICogMS4xID4gZGlmZmVyZW5jZVggJiYgY29udGFpbmVyLndpbmRvdy5yZWN0LmhlaWdodCAqIDEuMSA+IGRpZmZlcmVuY2VZKSB7XG4gICAgICAgICAgcHJlcHJvY2Vzcy5hcHBseSh1bmRlZmluZWQsIFt0YXJnZXQuZWxlbWVudF0uY29uY2F0KGFyZ3MpKTtcbiAgICAgICAgICBwcm9jZXNzLmFwcGx5KHVuZGVmaW5lZCwgW3RhcmdldC5lbGVtZW50XS5jb25jYXQoYXJncykpO1xuICAgICAgICAgIHBvc3Rwcm9jZXNzLmFwcGx5KHVuZGVmaW5lZCwgW3RhcmdldC5lbGVtZW50XS5jb25jYXQoYXJncykpO1xuICAgICAgICAgIHRhcmdldHMuc3BsaWNlKGluZGV4LCAxKTsgLy8gUmVtb3ZlIGFuIGl0ZW0gZnJvbSB0YXJnZXRzIGJ5IHNpZGUgZWZmZWN0XG4gICAgICAgICAgaWYgKHRhcmdldHMubGVuZ3RoIDw9IDApIGNvbnRhaW5lci5vZmYoJ3Njcm9sbCcsIG92ZXJmbG93WCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG92ZXJmbG93WSgpIHtcbiAgICAgIHRhcmdldHMuZm9yRWFjaChmdW5jdGlvbiAodGFyZ2V0LCBpbmRleCkge1xuICAgICAgICB2YXIgZGlmZmVyZW5jZVggPSBNYXRoLmFicyhjb250YWluZXIud2luZG93LnNjcm9sbE9yaWdpbi54IC0gdGFyZ2V0LnBhcmVudC5wb3NpdGlvbk9yaWdpbi54KTtcbiAgICAgICAgdmFyIGRpZmZlcmVuY2VZID0gTWF0aC5hYnModGFyZ2V0LnBhcmVudC5zY3JvbGxPcmlnaW4ueSAtIHRhcmdldC5wb3NpdGlvbk9yaWdpbi55KTtcblxuICAgICAgICBpZiAoY29udGFpbmVyLndpbmRvdy5yZWN0LndpZHRoICogMS4xID4gZGlmZmVyZW5jZVggJiYgdGFyZ2V0LnBhcmVudC5yZWN0LmhlaWdodCAqIDEuMSA+IGRpZmZlcmVuY2VZKSB7XG4gICAgICAgICAgcHJlcHJvY2Vzcy5hcHBseSh1bmRlZmluZWQsIFt0YXJnZXQuZWxlbWVudF0uY29uY2F0KGFyZ3MpKTtcbiAgICAgICAgICBwcm9jZXNzLmFwcGx5KHVuZGVmaW5lZCwgW3RhcmdldC5lbGVtZW50XS5jb25jYXQoYXJncykpO1xuICAgICAgICAgIHBvc3Rwcm9jZXNzLmFwcGx5KHVuZGVmaW5lZCwgW3RhcmdldC5lbGVtZW50XS5jb25jYXQoYXJncykpO1xuICAgICAgICAgIHRhcmdldHMuc3BsaWNlKGluZGV4LCAxKTsgLy8gUmVtb3ZlIGFuIGl0ZW0gZnJvbSB0YXJnZXRzIGJ5IHNpZGUgZWZmZWN0XG4gICAgICAgICAgaWYgKHRhcmdldHMubGVuZ3RoIDw9IDApIGNvbnRhaW5lci5vZmYoJ3Njcm9sbCcsIG92ZXJmbG93WSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0b1N0cmluZy5hcHBseShjb250YWluZXIucGFyZW50c1swXS5lbGVtZW50KSA9PT0gJ1tvYmplY3QgV2luZG93XScpIHtcbiAgICAgIGNvbnRhaW5lci5vbignc2Nyb2xsJywgc2Nyb2xsKTtcbiAgICAgIHNjcm9sbCgpO1xuICAgIH0gZWxzZSBpZiAoY29udGFpbmVyLnBhcmVudHNbMF0ucmVjdC53aWR0aCA8IGNvbnRhaW5lci5wYXJlbnRzWzBdLnJlY3Quc2Nyb2xsV2lkdGgpIHtcbiAgICAgIGNvbnRhaW5lci5vbignc2Nyb2xsJywgb3ZlcmZsb3dYKTtcbiAgICAgIG92ZXJmbG93WCgpO1xuICAgIH0gZWxzZSBpZiAoY29udGFpbmVyLnBhcmVudHNbMF0ucmVjdC5oZWlnaHQgPCBjb250YWluZXIucGFyZW50c1swXS5yZWN0LnNjcm9sbEhlaWdodCkge1xuICAgICAgY29udGFpbmVyLm9uKCdzY3JvbGwnLCBvdmVyZmxvd1kpO1xuICAgICAgb3ZlcmZsb3dZKCk7XG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIERldGVjdCBlbGVtZW50cyBvbiB0b3Agb2Ygd2luZG93XG4gKi9cbmZ1bmN0aW9uIG9uVG9wKHByZXByb2Nlc3MsIHByb2Nlc3MsIHBvc3Rwcm9jZXNzKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoc2VsZWN0b3IpIHtcbiAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuMiA+IDEgPyBfbGVuMiAtIDEgOiAwKSwgX2tleTIgPSAxOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgICBhcmdzW19rZXkyIC0gMV0gPSBhcmd1bWVudHNbX2tleTJdO1xuICAgIH1cblxuICAgIHZhciBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xuXG4gICAgZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgdmFyIGVsZW1lbnRSZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIHZhciBlbGVtZW50UG9zaXRpb25ZID0gTWF0aC5mbG9vcihlbGVtZW50UmVjdC50b3ApICsgKHdpbi5zY3JvbGxZIHx8IHdpbi5wYWdlWU9mZnNldCk7XG4gICAgICB2YXIgZWxlbWVudE9yaWdpblkgPSBlbGVtZW50UmVjdC5oZWlnaHQgKyBlbGVtZW50UG9zaXRpb25ZO1xuXG4gICAgICBmdW5jdGlvbiBzY3JvbGwoKSB7XG4gICAgICAgIHZhciB3aW5kb3dTY3JvbGxZID0gd2luLnNjcm9sbFkgfHwgd2luLnBhZ2VZT2Zmc2V0O1xuXG4gICAgICAgIGlmIChlbGVtZW50T3JpZ2luWSA8PSB3aW5kb3dTY3JvbGxZKSB7XG4gICAgICAgICAgdmFyIHByb2Nlc3NBcmdzID0gW2VsZW1lbnQsIGZhbHNlXS5jb25jYXQoYXJncyk7XG4gICAgICAgICAgcHJvY2Vzcy5hcHBseSh1bmRlZmluZWQsIF90b0NvbnN1bWFibGVBcnJheShwcm9jZXNzQXJncykpO1xuICAgICAgICAgIHBvc3Rwcm9jZXNzLmFwcGx5KHVuZGVmaW5lZCwgX3RvQ29uc3VtYWJsZUFycmF5KHByb2Nlc3NBcmdzKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIF9wcm9jZXNzQXJncyA9IFtlbGVtZW50LCB0cnVlXS5jb25jYXQoYXJncyk7XG4gICAgICAgICAgcHJvY2Vzcy5hcHBseSh1bmRlZmluZWQsIF90b0NvbnN1bWFibGVBcnJheShfcHJvY2Vzc0FyZ3MpKTtcbiAgICAgICAgICBwb3N0cHJvY2Vzcy5hcHBseSh1bmRlZmluZWQsIF90b0NvbnN1bWFibGVBcnJheShfcHJvY2Vzc0FyZ3MpKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBwcmVwcm9jZXNzLmFwcGx5KHVuZGVmaW5lZCwgX3RvQ29uc3VtYWJsZUFycmF5KFtlbGVtZW50XS5jb25jYXQoYXJncykpKTtcbiAgICAgIHdpbi5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBzY3JvbGwsIGZhbHNlKTtcbiAgICAgIHNjcm9sbCgpO1xuXG4gICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9KTtcbiAgfTtcbn1cblxuLyoqXG4gKlxuICovXG5mdW5jdGlvbiBvbkJvdHRvbShwcmVwcm9jZXNzLCBwcm9jZXNzLCBwb3N0cHJvY2Vzcykge1xuICByZXR1cm4gZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG4gICAgZm9yICh2YXIgX2xlbjMgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gQXJyYXkoX2xlbjMgPiAxID8gX2xlbjMgLSAxIDogMCksIF9rZXkzID0gMTsgX2tleTMgPCBfbGVuMzsgX2tleTMrKykge1xuICAgICAgYXJnc1tfa2V5MyAtIDFdID0gYXJndW1lbnRzW19rZXkzXTtcbiAgICB9XG5cbiAgICB2YXIgcHJvY2Vzc0FyZ3MgPSBbc2VsZWN0b3JdLmNvbmNhdChhcmdzKTtcbiAgICBwcmVwcm9jZXNzLmFwcGx5KHVuZGVmaW5lZCwgX3RvQ29uc3VtYWJsZUFycmF5KHByb2Nlc3NBcmdzKSk7XG4gICAgcHJvY2Vzcy5hcHBseSh1bmRlZmluZWQsIF90b0NvbnN1bWFibGVBcnJheShwcm9jZXNzQXJncykpO1xuICAgIHBvc3Rwcm9jZXNzLmFwcGx5KHVuZGVmaW5lZCwgX3RvQ29uc3VtYWJsZUFycmF5KHByb2Nlc3NBcmdzKSk7XG4gIH07XG59XG5cbi8qKiovIH0pLFxuLyogNCAqLyxcbi8qIDUgKi8sXG4vKiA2ICovLFxuLyogNyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5zdGlja3loZWFkZXIgPSBleHBvcnRzLmxhenlpbWFnZSA9IGV4cG9ydHMubGF6eWFjdGlvbiA9IHVuZGVmaW5lZDtcblxudmFyIF9sYXp5YWN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7XG5cbnZhciBfbGF6eWFjdGlvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sYXp5YWN0aW9uKTtcblxudmFyIF9sYXp5aW1hZ2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTtcblxudmFyIF9sYXp5aW1hZ2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbGF6eWltYWdlKTtcblxudmFyIF9zdGlja3loZWFkZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTtcblxudmFyIF9zdGlja3loZWFkZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3RpY2t5aGVhZGVyKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZXhwb3J0cy5sYXp5YWN0aW9uID0gX2xhenlhY3Rpb24yLmRlZmF1bHQ7XG5leHBvcnRzLmxhenlpbWFnZSA9IF9sYXp5aW1hZ2UyLmRlZmF1bHQ7XG5leHBvcnRzLnN0aWNreWhlYWRlciA9IF9zdGlja3loZWFkZXIyLmRlZmF1bHQ7XG5cbi8qKiovIH0pLFxuLyogOCAqLyxcbi8qIDkgKi8sXG4vKiAxMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG4vLyBzdHlsZS1sb2FkZXI6IEFkZHMgc29tZSBjc3MgdG8gdGhlIERPTSBieSBhZGRpbmcgYSA8c3R5bGU+IHRhZ1xuXG4vLyBsb2FkIHRoZSBzdHlsZXNcbnZhciBjb250ZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7XG5pZih0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIGNvbnRlbnQgPSBbW21vZHVsZS5pLCBjb250ZW50LCAnJ11dO1xuLy8gYWRkIHRoZSBzdHlsZXMgdG8gdGhlIERPTVxudmFyIHVwZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oMSkoY29udGVudCwge30pO1xuaWYoY29udGVudC5sb2NhbHMpIG1vZHVsZS5leHBvcnRzID0gY29udGVudC5sb2NhbHM7XG4vLyBIb3QgTW9kdWxlIFJlcGxhY2VtZW50XG5pZihmYWxzZSkge1xuXHQvLyBXaGVuIHRoZSBzdHlsZXMgY2hhbmdlLCB1cGRhdGUgdGhlIDxzdHlsZT4gdGFnc1xuXHRpZighY29udGVudC5sb2NhbHMpIHtcblx0XHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcz9pbXBvcnRMb2FkZXJzPTEhLi8uLi8uLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvaW5kZXguanM/c291cmNlTWFwPWlubGluZSEuL2xhenlpbWFnZS5jc3NcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanM/aW1wb3J0TG9hZGVycz0xIS4vLi4vLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL2luZGV4LmpzP3NvdXJjZU1hcD1pbmxpbmUhLi9sYXp5aW1hZ2UuY3NzXCIpO1xuXHRcdFx0aWYodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdzdHJpbmcnKSBuZXdDb250ZW50ID0gW1ttb2R1bGUuaWQsIG5ld0NvbnRlbnQsICcnXV07XG5cdFx0XHR1cGRhdGUobmV3Q29udGVudCk7XG5cdFx0fSk7XG5cdH1cblx0Ly8gV2hlbiB0aGUgbW9kdWxlIGlzIGRpc3Bvc2VkLCByZW1vdmUgdGhlIDxzdHlsZT4gdGFnc1xuXHRtb2R1bGUuaG90LmRpc3Bvc2UoZnVuY3Rpb24oKSB7IHVwZGF0ZSgpOyB9KTtcbn1cblxuLyoqKi8gfSksXG4vKiAxMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG4vLyBzdHlsZS1sb2FkZXI6IEFkZHMgc29tZSBjc3MgdG8gdGhlIERPTSBieSBhZGRpbmcgYSA8c3R5bGU+IHRhZ1xuXG4vLyBsb2FkIHRoZSBzdHlsZXNcbnZhciBjb250ZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSk7XG5pZih0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIGNvbnRlbnQgPSBbW21vZHVsZS5pLCBjb250ZW50LCAnJ11dO1xuLy8gYWRkIHRoZSBzdHlsZXMgdG8gdGhlIERPTVxudmFyIHVwZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oMSkoY29udGVudCwge30pO1xuaWYoY29udGVudC5sb2NhbHMpIG1vZHVsZS5leHBvcnRzID0gY29udGVudC5sb2NhbHM7XG4vLyBIb3QgTW9kdWxlIFJlcGxhY2VtZW50XG5pZihmYWxzZSkge1xuXHQvLyBXaGVuIHRoZSBzdHlsZXMgY2hhbmdlLCB1cGRhdGUgdGhlIDxzdHlsZT4gdGFnc1xuXHRpZighY29udGVudC5sb2NhbHMpIHtcblx0XHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcz9pbXBvcnRMb2FkZXJzPTEhLi8uLi8uLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvaW5kZXguanM/c291cmNlTWFwPWlubGluZSEuL3N0aWNreWhlYWRlci5jc3NcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanM/aW1wb3J0TG9hZGVycz0xIS4vLi4vLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL2luZGV4LmpzP3NvdXJjZU1hcD1pbmxpbmUhLi9zdGlja3loZWFkZXIuY3NzXCIpO1xuXHRcdFx0aWYodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdzdHJpbmcnKSBuZXdDb250ZW50ID0gW1ttb2R1bGUuaWQsIG5ld0NvbnRlbnQsICcnXV07XG5cdFx0XHR1cGRhdGUobmV3Q29udGVudCk7XG5cdFx0fSk7XG5cdH1cblx0Ly8gV2hlbiB0aGUgbW9kdWxlIGlzIGRpc3Bvc2VkLCByZW1vdmUgdGhlIDxzdHlsZT4gdGFnc1xuXHRtb2R1bGUuaG90LmRpc3Bvc2UoZnVuY3Rpb24oKSB7IHVwZGF0ZSgpOyB9KTtcbn1cblxuLyoqKi8gfSksXG4vKiAxMiAqLyxcbi8qIDEzICovLFxuLyogMTQgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG4vKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkNvbnRhaW5lciA9IGV4cG9ydHMuUGFyZW50Q29udGFpbmVyID0gZXhwb3J0cy5XaW5kb3dDb250YWluZXIgPSBleHBvcnRzLlRhcmdldENvbnRhaW5lciA9IHVuZGVmaW5lZDtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF91bmRlcnNjb3JlID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7XG5cbnZhciBfdW5kZXJzY29yZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91bmRlcnNjb3JlKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIHdpbiA9IGRvY3VtZW50LmRlZmF1bHRWaWV3O1xuXG52YXIgVGFyZ2V0Q29udGFpbmVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBUYXJnZXRDb250YWluZXIodGFyZ2V0RWxlbWVudCwgcGFyZW50Q29udGFpbmVyKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRhcmdldENvbnRhaW5lcik7XG5cbiAgICB0aGlzLmVsZW1lbnQgPSB0YXJnZXRFbGVtZW50OyAvLyBlbGVtZW50XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnRDb250YWluZXI7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoVGFyZ2V0Q29udGFpbmVyLCBbe1xuICAgIGtleTogJ3Bvc2l0aW9uJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHg6IE1hdGguZmxvb3IodGhpcy5yZWN0LmxlZnQpICsgdGhpcy5wYXJlbnQuc2Nyb2xsLngsXG4gICAgICAgIHk6IE1hdGguZmxvb3IodGhpcy5yZWN0LnRvcCkgKyB0aGlzLnBhcmVudC5zY3JvbGwueVxuICAgICAgfTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdwb3NpdGlvbk9yaWdpbicsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB4OiBNYXRoLmZsb29yKHRoaXMucmVjdC53aWR0aCAvIDIpICsgdGhpcy5wb3NpdGlvbi54LFxuICAgICAgICB5OiBNYXRoLmZsb29yKHRoaXMucmVjdC5oZWlnaHQgLyAyKSArIHRoaXMucG9zaXRpb24ueVxuICAgICAgfTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdyZWN0JyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFRhcmdldENvbnRhaW5lcjtcbn0oKTtcblxudmFyIFdpbmRvd0NvbnRhaW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gV2luZG93Q29udGFpbmVyKGNoaWxkcmVuU2VsZWN0b3IpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFdpbmRvd0NvbnRhaW5lcik7XG5cbiAgICB0aGlzLndpbmRvdyA9IHRoaXM7XG4gICAgdGhpcy5lbGVtZW50ID0gd2luO1xuICAgIGlmIChjaGlsZHJlblNlbGVjdG9yKSB7XG4gICAgICB2YXIgY2hpbGRyZW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNoaWxkcmVuU2VsZWN0b3IpO1xuICAgICAgdGhpcy5jaGlsZHJlbiA9IEFycmF5LmZyb20oY2hpbGRyZW4sIGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICByZXR1cm4gbmV3IFRhcmdldENvbnRhaW5lcihjaGlsZCwgX3RoaXMpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFdpbmRvd0NvbnRhaW5lciwgW3tcbiAgICBrZXk6ICdvbicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGV2ZW50bmFtZSwgY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50bmFtZSwgY2FsbGJhY2ssIGZhbHNlKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdvZmYnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvZmYoZXZlbnRuYW1lLCBjYWxsYmFjaykge1xuICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRuYW1lLCBjYWxsYmFjayk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAncG9zaXRpb24nLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgeDogTWF0aC5mbG9vcih0aGlzLnJlY3Qud2lkdGggLyAyKSxcbiAgICAgICAgeTogTWF0aC5mbG9vcih0aGlzLnJlY3QuaGVpZ2h0IC8gMilcbiAgICAgIH07XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAncmVjdCcsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b3A6IDAsXG4gICAgICAgIGxlZnQ6IDAsXG4gICAgICAgIHdpZHRoOiB0aGlzLmVsZW1lbnQuaW5uZXJXaWR0aCxcbiAgICAgICAgaGVpZ2h0OiB0aGlzLmVsZW1lbnQuaW5uZXJIZWlnaHQsXG4gICAgICAgIHNjcm9sbFdpZHRoOiBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoLFxuICAgICAgICBzY3JvbGxIZWlnaHQ6IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0XG4gICAgICB9O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3Njcm9sbCcsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB4OiB0aGlzLmVsZW1lbnQuc2Nyb2xsWCB8fCB0aGlzLmVsZW1lbnQucGFnZVhPZmZzZXQsXG4gICAgICAgIHk6IHRoaXMuZWxlbWVudC5zY3JvbGxZIHx8IHRoaXMuZWxlbWVudC5wYWdlWU9mZnNldFxuICAgICAgfTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdzY3JvbGxPcmlnaW4nLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgeDogTWF0aC5mbG9vcih0aGlzLnJlY3Qud2lkdGggLyAyKSArIHRoaXMuc2Nyb2xsLngsXG4gICAgICAgIHk6IE1hdGguZmxvb3IodGhpcy5yZWN0LmhlaWdodCAvIDIpICsgdGhpcy5zY3JvbGwueVxuICAgICAgfTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gV2luZG93Q29udGFpbmVyO1xufSgpO1xuXG52YXIgUGFyZW50Q29udGFpbmVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBQYXJlbnRDb250YWluZXIocGFyZW50RWxlbWVudCwgY2hpbGRyZW5TZWxlY3Rvcikge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBhcmVudENvbnRhaW5lcik7XG5cbiAgICB0aGlzLndpbmRvdyA9IG5ldyBXaW5kb3dDb250YWluZXIoKTtcbiAgICB0aGlzLmVsZW1lbnQgPSBwYXJlbnRFbGVtZW50O1xuICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNoaWxkcmVuU2VsZWN0b3IpO1xuICAgIHRoaXMuY2hpbGRyZW4gPSBBcnJheS5mcm9tKGNoaWxkcmVuLCBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgIHJldHVybiBuZXcgVGFyZ2V0Q29udGFpbmVyKGNoaWxkLCBfdGhpczIpO1xuICAgIH0pO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFBhcmVudENvbnRhaW5lciwgW3tcbiAgICBrZXk6ICdvbicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGV2ZW50bmFtZSwgY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50bmFtZSwgY2FsbGJhY2ssIGZhbHNlKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdvZmYnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvZmYoZXZlbnRuYW1lLCBjYWxsYmFjaykge1xuICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRuYW1lLCBjYWxsYmFjayk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAncG9zaXRpb24nLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgeDogTWF0aC5mbG9vcih0aGlzLnJlY3QubGVmdCkgKyB0aGlzLndpbmRvdy5zY3JvbGwueCxcbiAgICAgICAgeTogTWF0aC5mbG9vcih0aGlzLnJlY3QudG9wKSArIHRoaXMud2luZG93LnNjcm9sbC55XG4gICAgICB9O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3Bvc2l0aW9uT3JpZ2luJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHg6IE1hdGguZmxvb3IodGhpcy5yZWN0LndpZHRoIC8gMikgKyB0aGlzLnBvc2l0aW9uLngsXG4gICAgICAgIHk6IE1hdGguZmxvb3IodGhpcy5yZWN0LmhlaWdodCAvIDIpICsgdGhpcy5wb3NpdGlvbi55XG4gICAgICB9O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3JlY3QnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24odGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCB7XG4gICAgICAgIHNjcm9sbFdpZHRoOiB0aGlzLmVsZW1lbnQuc2Nyb2xsV2lkdGgsXG4gICAgICAgIHNjcm9sbEhlaWdodDogdGhpcy5lbGVtZW50LnNjcm9sbEhlaWdodFxuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnc2Nyb2xsJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHg6IHRoaXMuZWxlbWVudC5zY3JvbGxMZWZ0LFxuICAgICAgICB5OiB0aGlzLmVsZW1lbnQuc2Nyb2xsVG9wXG4gICAgICB9O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3Njcm9sbE9yaWdpbicsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB4OiBNYXRoLmZsb29yKHRoaXMucmVjdC53aWR0aCAvIDIpICsgdGhpcy5lbGVtZW50LnNjcm9sbExlZnQsXG4gICAgICAgIHk6IE1hdGguZmxvb3IodGhpcy5yZWN0LmhlaWdodCAvIDIpICsgdGhpcy5lbGVtZW50LnNjcm9sbFRvcFxuICAgICAgfTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdzdHlsZScsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gZ2xvYmFsLmdldENvbXB1dGVkU3R5bGUodGhpcy5lbGVtZW50KTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gUGFyZW50Q29udGFpbmVyO1xufSgpO1xuXG52YXIgQ29udGFpbmVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBDb250YWluZXIocGFyZW50U2VsZWN0b3IsIHRhcmdldFNlbGVjdG9yKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbnRhaW5lcik7XG5cbiAgICB0aGlzLndpbmRvdyA9IG5ldyBXaW5kb3dDb250YWluZXIoKTtcblxuICAgIHRoaXMucGFyZW50cyA9IFtdO1xuXG4gICAgaWYgKHRvU3RyaW5nLmFwcGx5KHBhcmVudFNlbGVjdG9yKSA9PT0gJ1tvYmplY3QgV2luZG93XScpIHtcbiAgICAgIHRoaXMucGFyZW50cy5wdXNoKG5ldyBXaW5kb3dDb250YWluZXIodGFyZ2V0U2VsZWN0b3IpKTtcbiAgICB9IGVsc2UgaWYgKHRvU3RyaW5nLmFwcGx5KHBhcmVudFNlbGVjdG9yKSA9PT0gJ1tvYmplY3QgU3RyaW5nXScpIHtcbiAgICAgIHZhciBwYXJlbnRFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwocGFyZW50U2VsZWN0b3IpO1xuICAgICAgdGhpcy5wYXJlbnRzID0gQXJyYXkuZnJvbShwYXJlbnRFbGVtZW50cywgZnVuY3Rpb24gKHBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQYXJlbnRDb250YWluZXIocGFyZW50RWxlbWVudCwgdGFyZ2V0U2VsZWN0b3IpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5jaGlsZHJlbiA9IF91bmRlcnNjb3JlMi5kZWZhdWx0LmZsYXR0ZW4odGhpcy5wYXJlbnRzLm1hcChmdW5jdGlvbiAocGFyZW50KSB7XG4gICAgICByZXR1cm4gcGFyZW50LmNoaWxkcmVuO1xuICAgIH0pKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhDb250YWluZXIsIFt7XG4gICAga2V5OiAnb24nLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbihldmVudG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICB0aGlzLnBhcmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGFyZW50KSB7XG4gICAgICAgIHJldHVybiBwYXJlbnQub24oZXZlbnRuYW1lLCBjYWxsYmFjayk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMud2luZG93Lm9uKGV2ZW50bmFtZSwgY2FsbGJhY2spO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ29mZicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9mZihldmVudG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICB0aGlzLnBhcmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGFyZW50KSB7XG4gICAgICAgIHJldHVybiBwYXJlbnQub2ZmKGV2ZW50bmFtZSwgY2FsbGJhY2spO1xuICAgICAgfSk7XG4gICAgICB0aGlzLndpbmRvdy5vZmYoZXZlbnRuYW1lLCBjYWxsYmFjayk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIENvbnRhaW5lcjtcbn0oKTtcblxuZXhwb3J0cy5UYXJnZXRDb250YWluZXIgPSBUYXJnZXRDb250YWluZXI7XG5leHBvcnRzLldpbmRvd0NvbnRhaW5lciA9IFdpbmRvd0NvbnRhaW5lcjtcbmV4cG9ydHMuUGFyZW50Q29udGFpbmVyID0gUGFyZW50Q29udGFpbmVyO1xuZXhwb3J0cy5Db250YWluZXIgPSBDb250YWluZXI7XG4vKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg0KSkpXG5cbi8qKiovIH0pLFxuLyogMTUgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGxhenlhY3Rpb247XG5cbnZhciBfc2Nyb2xsYWN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblxuZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfSBlbHNlIHsgcmV0dXJuIEFycmF5LmZyb20oYXJyKTsgfSB9XG5cbmZ1bmN0aW9uIHByZXByb2Nlc3MoKSB7fVxuXG5mdW5jdGlvbiBwcm9jZXNzKGVsZW1lbnQsIGNhbGxiYWNrKSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gQXJyYXkoX2xlbiA+IDIgPyBfbGVuIC0gMiA6IDApLCBfa2V5ID0gMjsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIGFyZ3NbX2tleSAtIDJdID0gYXJndW1lbnRzW19rZXldO1xuICB9XG5cbiAgY2FsbGJhY2suYXBwbHkodW5kZWZpbmVkLCBfdG9Db25zdW1hYmxlQXJyYXkoW2VsZW1lbnRdLmNvbmNhdChhcmdzKSkpO1xufVxuXG5mdW5jdGlvbiBwb3N0cHJvY2VzcygpIHt9XG5cbmZ1bmN0aW9uIGxhenlhY3Rpb24odGFyZ2V0LCBjYWxsYmFjaykge1xuICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuMiA+IDIgPyBfbGVuMiAtIDIgOiAwKSwgX2tleTIgPSAyOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgYXJnc1tfa2V5MiAtIDJdID0gYXJndW1lbnRzW19rZXkyXTtcbiAgfVxuXG4gIHZhciBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7XG4gICAgcGFyZW50OiB3aW5kb3dcbiAgfSwgYXJnc1thcmdzLmxlbmd0aCAtIDFdKTtcblxuICByZXR1cm4gKDAsIF9zY3JvbGxhY3Rpb24ub25TY3JvbGwpKHByZXByb2Nlc3MsIHByb2Nlc3MsIHBvc3Rwcm9jZXNzKS5hcHBseSh1bmRlZmluZWQsIFtvcHRpb25zLnBhcmVudCwgdGFyZ2V0LCBjYWxsYmFja10uY29uY2F0KGFyZ3MpKTtcbn1cblxuLyoqKi8gfSksXG4vKiAxNiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gbGF6eWltYWdlO1xuXG52YXIgX3Njcm9sbGFjdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cbmZ1bmN0aW9uIHByZXByb2Nlc3MoZWxlbWVudCkge1xuICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xufVxuXG5mdW5jdGlvbiBwcm9jZXNzKGVsZW1lbnQsIGRhdGFuYW1lKSB7XG4gIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uIGxvYWQoZXYpIHtcbiAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXYudHlwZSwgbG9hZCk7XG4gICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtYnVzeScsICdmYWxzZScpO1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICdmYWxzZScpO1xuICB9LCBmYWxzZSk7XG4gIHZhciBkYXRhYXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLScgKyBkYXRhbmFtZSk7XG4gIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdzcmMnLCBkYXRhYXR0cik7XG4gIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWJ1c3knLCAndHJ1ZScpO1xufVxuXG5mdW5jdGlvbiBwb3N0cHJvY2VzcyhlbGVtZW50LCBkYXRhbmFtZSkge1xuICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS0nICsgZGF0YW5hbWUpO1xufVxuXG5mdW5jdGlvbiBsYXp5aW1hZ2UodGFyZ2V0LCBkYXRhbmFtZSkge1xuICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogeyBwYXJlbnQ6IHdpbmRvdyB9O1xuXG4gIHJldHVybiAoMCwgX3Njcm9sbGFjdGlvbi5vblNjcm9sbCkocHJlcHJvY2VzcywgcHJvY2VzcywgcG9zdHByb2Nlc3MpKG9wdGlvbnMucGFyZW50LCB0YXJnZXQsIGRhdGFuYW1lKTtcbn1cblxuLyoqKi8gfSksXG4vKiAxNyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3Njcm9sbGFjdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cbmZ1bmN0aW9uIHByZXByb2Nlc3MoKSB7fVxuXG5mdW5jdGlvbiBwcm9jZXNzKGVsZW1lbnQsIG9udG9wKSB7XG4gIC8qIGVzbGludC1kaXNhYmxlIG5vLXBhcmFtLXJlYXNzaWduICovXG4gIGlmIChvbnRvcCkge1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ3Njcm9sbCcpO1xuICAgIGVsZW1lbnQuc3R5bGUudG9wID0gJyc7XG4gICAgZWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSAnJztcbiAgfSBlbHNlIHtcbiAgICB2YXIgZWxlbWVudFJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ2ZpeGVkJyk7XG4gICAgZWxlbWVudC5zdHlsZS50b3AgPSAnLScgKyBlbGVtZW50UmVjdC5oZWlnaHQgKyAncHgnO1xuICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKDAsICcgKyBlbGVtZW50UmVjdC5oZWlnaHQgKyAncHgsIDApJztcbiAgfVxufVxuXG5mdW5jdGlvbiBwb3N0cHJvY2VzcygpIHt9XG5cbnZhciBzdGlja3loZWFkZXIgPSAoMCwgX3Njcm9sbGFjdGlvbi5vblRvcCkocHJlcHJvY2VzcywgcHJvY2VzcywgcG9zdHByb2Nlc3MpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBzdGlja3loZWFkZXI7XG5cbi8qKiovIH0pLFxuLyogMTggKi8sXG4vKiAxOSAqLyxcbi8qIDIwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkoKTtcbi8vIGltcG9ydHNcblxuXG4vLyBtb2R1bGVcbmV4cG9ydHMucHVzaChbbW9kdWxlLmksIFwiLmxhenlpbWFnZXt0cmFuc2l0aW9uLXByb3BlcnR5Om9wYWNpdHksdmlzaWJpbGl0eTt0cmFuc2l0aW9uLWR1cmF0aW9uOi4zc30ubGF6eWltYWdlW2FyaWEtaGlkZGVuPXRydWVde29wYWNpdHk6MDt2aXNpYmlsaXR5OmhpZGRlbn0ubGF6eWltYWdlW2FyaWEtaGlkZGVuPWZhbHNlXXtvcGFjaXR5OjE7dmlzaWJpbGl0eTp2aXNpYmxlfVxcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSnpiM1Z5WTJWeklqcGJJbXhoZW5scGJXRm5aUzVqYzNNaVhTd2libUZ0WlhNaU9sdGRMQ0p0WVhCd2FXNW5jeUk2SWtGQlFVRXNWMEZEUlN4MVEwRkJlVU1zUVVGRGVrTXNkVUpCUVRCQ0xFTkJWek5DTEVGQlZFTXNOa0pCUTBVc1ZVRkJWeXhCUVVOWUxHbENRVUZ0UWl4RFFVTndRaXhCUVVWRUxEaENRVU5GTEZWQlFWY3NRVUZEV0N4clFrRkJiMElzUTBGRGNrSWlMQ0ptYVd4bElqb2liR0Y2ZVdsdFlXZGxMbU56Y3lJc0luTnZkWEpqWlhORGIyNTBaVzUwSWpwYklpNXNZWHA1YVcxaFoyVWdlMXh1SUNCMGNtRnVjMmwwYVc5dUxYQnliM0JsY25SNU9pQnZjR0ZqYVhSNUxDQjJhWE5wWW1sc2FYUjVPMXh1SUNCMGNtRnVjMmwwYVc5dUxXUjFjbUYwYVc5dU9pQXdMak56TzF4dVhHNGdJRUJ1WlhOMElDWmJZWEpwWVMxb2FXUmtaVzQ5WENKMGNuVmxYQ0pkSUh0Y2JpQWdJQ0J2Y0dGamFYUjVPaUF3TzF4dUlDQWdJSFpwYzJsaWFXeHBkSGs2SUdocFpHUmxianRjYmlBZ2ZWeHVYRzRnSUVCdVpYTjBJQ1piWVhKcFlTMW9hV1JrWlc0OVhDSm1ZV3h6WlZ3aVhTQjdYRzRnSUNBZ2IzQmhZMmwwZVRvZ01UdGNiaUFnSUNCMmFYTnBZbWxzYVhSNU9pQjJhWE5wWW14bE8xeHVJQ0I5WEc1OVhHNGlYWDA9ICovXCIsIFwiXCJdKTtcblxuLy8gZXhwb3J0c1xuXG5cbi8qKiovIH0pLFxuLyogMjEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKSgpO1xuLy8gaW1wb3J0c1xuXG5cbi8vIG1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaSwgXCIuc3RpY2t5aGVhZGVye3RyYW5zaXRpb24tcHJvcGVydHk6dHJhbnNmb3JtO3RyYW5zaXRpb24tZHVyYXRpb246LjNzfS5zdGlja3loZWFkZXJbYXJpYS1sYWJlbD1zY3JvbGxde3Bvc2l0aW9uOnJlbGF0aXZlfS5zdGlja3loZWFkZXJbYXJpYS1sYWJlbD1maXhlZF17bGVmdDowO3Bvc2l0aW9uOmZpeGVkO3otaW5kZXg6MX1cXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0p6YjNWeVkyVnpJanBiSW5OMGFXTnJlV2hsWVdSbGNpNWpjM01pWFN3aWJtRnRaWE1pT2x0ZExDSnRZWEJ3YVc1bmN5STZJa0ZCUVVFc1kwRkRSU3c0UWtGQkswSXNRVUZETDBJc2RVSkJRVEJDTEVOQlZ6TkNMRUZCVkVNc2FVTkJRMFVzYVVKQlFXMUNMRU5CUTNCQ0xFRkJSVVFzWjBOQlEwVXNUMEZCVVN4QlFVTlNMR1ZCUVdkQ0xFRkJRMmhDTEZOQlFWY3NRMEZEV2lJc0ltWnBiR1VpT2lKemRHbGphM2xvWldGa1pYSXVZM056SWl3aWMyOTFjbU5sYzBOdmJuUmxiblFpT2xzaUxuTjBhV05yZVdobFlXUmxjaUI3WEc0Z0lIUnlZVzV6YVhScGIyNHRjSEp2Y0dWeWRIazZJSFJ5WVc1elptOXliVHRjYmlBZ2RISmhibk5wZEdsdmJpMWtkWEpoZEdsdmJqb2dNQzR6Y3p0Y2JseHVJQ0JBYm1WemRDQW1XMkZ5YVdFdGJHRmlaV3c5WENKelkzSnZiR3hjSWwwZ2UxeHVJQ0FnSUhCdmMybDBhVzl1T2lCeVpXeGhkR2wyWlR0Y2JpQWdmVnh1WEc0Z0lFQnVaWE4wSUNaYllYSnBZUzFzWVdKbGJEMWNJbVpwZUdWa1hDSmRJSHRjYmlBZ0lDQnNaV1owT2lBd08xeHVJQ0FnSUhCdmMybDBhVzl1T2lCbWFYaGxaRHRjYmlBZ0lDQjZMV2x1WkdWNE9pQXhPMXh1SUNCOVhHNTlYRzRpWFgwPSAqL1wiLCBcIlwiXSk7XG5cbi8vIGV4cG9ydHNcblxuXG4vKioqLyB9KSxcbi8qIDIyICovLFxuLyogMjMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxudmFyIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8vICAgICBVbmRlcnNjb3JlLmpzIDEuOC4zXG4vLyAgICAgaHR0cDovL3VuZGVyc2NvcmVqcy5vcmdcbi8vICAgICAoYykgMjAwOS0yMDE1IEplcmVteSBBc2hrZW5hcywgRG9jdW1lbnRDbG91ZCBhbmQgSW52ZXN0aWdhdGl2ZSBSZXBvcnRlcnMgJiBFZGl0b3JzXG4vLyAgICAgVW5kZXJzY29yZSBtYXkgYmUgZnJlZWx5IGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cblxuKGZ1bmN0aW9uKCkge1xuXG4gIC8vIEJhc2VsaW5lIHNldHVwXG4gIC8vIC0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gRXN0YWJsaXNoIHRoZSByb290IG9iamVjdCwgYHdpbmRvd2AgaW4gdGhlIGJyb3dzZXIsIG9yIGBleHBvcnRzYCBvbiB0aGUgc2VydmVyLlxuICB2YXIgcm9vdCA9IHRoaXM7XG5cbiAgLy8gU2F2ZSB0aGUgcHJldmlvdXMgdmFsdWUgb2YgdGhlIGBfYCB2YXJpYWJsZS5cbiAgdmFyIHByZXZpb3VzVW5kZXJzY29yZSA9IHJvb3QuXztcblxuICAvLyBTYXZlIGJ5dGVzIGluIHRoZSBtaW5pZmllZCAoYnV0IG5vdCBnemlwcGVkKSB2ZXJzaW9uOlxuICB2YXIgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZSwgT2JqUHJvdG8gPSBPYmplY3QucHJvdG90eXBlLCBGdW5jUHJvdG8gPSBGdW5jdGlvbi5wcm90b3R5cGU7XG5cbiAgLy8gQ3JlYXRlIHF1aWNrIHJlZmVyZW5jZSB2YXJpYWJsZXMgZm9yIHNwZWVkIGFjY2VzcyB0byBjb3JlIHByb3RvdHlwZXMuXG4gIHZhclxuICAgIHB1c2ggICAgICAgICAgICAgPSBBcnJheVByb3RvLnB1c2gsXG4gICAgc2xpY2UgICAgICAgICAgICA9IEFycmF5UHJvdG8uc2xpY2UsXG4gICAgdG9TdHJpbmcgICAgICAgICA9IE9ialByb3RvLnRvU3RyaW5nLFxuICAgIGhhc093blByb3BlcnR5ICAgPSBPYmpQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuICAvLyBBbGwgKipFQ01BU2NyaXB0IDUqKiBuYXRpdmUgZnVuY3Rpb24gaW1wbGVtZW50YXRpb25zIHRoYXQgd2UgaG9wZSB0byB1c2VcbiAgLy8gYXJlIGRlY2xhcmVkIGhlcmUuXG4gIHZhclxuICAgIG5hdGl2ZUlzQXJyYXkgICAgICA9IEFycmF5LmlzQXJyYXksXG4gICAgbmF0aXZlS2V5cyAgICAgICAgID0gT2JqZWN0LmtleXMsXG4gICAgbmF0aXZlQmluZCAgICAgICAgID0gRnVuY1Byb3RvLmJpbmQsXG4gICAgbmF0aXZlQ3JlYXRlICAgICAgID0gT2JqZWN0LmNyZWF0ZTtcblxuICAvLyBOYWtlZCBmdW5jdGlvbiByZWZlcmVuY2UgZm9yIHN1cnJvZ2F0ZS1wcm90b3R5cGUtc3dhcHBpbmcuXG4gIHZhciBDdG9yID0gZnVuY3Rpb24oKXt9O1xuXG4gIC8vIENyZWF0ZSBhIHNhZmUgcmVmZXJlbmNlIHRvIHRoZSBVbmRlcnNjb3JlIG9iamVjdCBmb3IgdXNlIGJlbG93LlxuICB2YXIgXyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGlmIChvYmogaW5zdGFuY2VvZiBfKSByZXR1cm4gb2JqO1xuICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBfKSkgcmV0dXJuIG5ldyBfKG9iaik7XG4gICAgdGhpcy5fd3JhcHBlZCA9IG9iajtcbiAgfTtcblxuICAvLyBFeHBvcnQgdGhlIFVuZGVyc2NvcmUgb2JqZWN0IGZvciAqKk5vZGUuanMqKiwgd2l0aFxuICAvLyBiYWNrd2FyZHMtY29tcGF0aWJpbGl0eSBmb3IgdGhlIG9sZCBgcmVxdWlyZSgpYCBBUEkuIElmIHdlJ3JlIGluXG4gIC8vIHRoZSBicm93c2VyLCBhZGQgYF9gIGFzIGEgZ2xvYmFsIG9iamVjdC5cbiAgaWYgKHRydWUpIHtcbiAgICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICAgIGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IF87XG4gICAgfVxuICAgIGV4cG9ydHMuXyA9IF87XG4gIH0gZWxzZSB7XG4gICAgcm9vdC5fID0gXztcbiAgfVxuXG4gIC8vIEN1cnJlbnQgdmVyc2lvbi5cbiAgXy5WRVJTSU9OID0gJzEuOC4zJztcblxuICAvLyBJbnRlcm5hbCBmdW5jdGlvbiB0aGF0IHJldHVybnMgYW4gZWZmaWNpZW50IChmb3IgY3VycmVudCBlbmdpbmVzKSB2ZXJzaW9uXG4gIC8vIG9mIHRoZSBwYXNzZWQtaW4gY2FsbGJhY2ssIHRvIGJlIHJlcGVhdGVkbHkgYXBwbGllZCBpbiBvdGhlciBVbmRlcnNjb3JlXG4gIC8vIGZ1bmN0aW9ucy5cbiAgdmFyIG9wdGltaXplQ2IgPSBmdW5jdGlvbihmdW5jLCBjb250ZXh0LCBhcmdDb3VudCkge1xuICAgIGlmIChjb250ZXh0ID09PSB2b2lkIDApIHJldHVybiBmdW5jO1xuICAgIHN3aXRjaCAoYXJnQ291bnQgPT0gbnVsbCA/IDMgOiBhcmdDb3VudCkge1xuICAgICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbChjb250ZXh0LCB2YWx1ZSk7XG4gICAgICB9O1xuICAgICAgY2FzZSAyOiByZXR1cm4gZnVuY3Rpb24odmFsdWUsIG90aGVyKSB7XG4gICAgICAgIHJldHVybiBmdW5jLmNhbGwoY29udGV4dCwgdmFsdWUsIG90aGVyKTtcbiAgICAgIH07XG4gICAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgICAgfTtcbiAgICAgIGNhc2UgNDogcmV0dXJuIGZ1bmN0aW9uKGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbChjb250ZXh0LCBhY2N1bXVsYXRvciwgdmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKTtcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfTtcblxuICAvLyBBIG1vc3RseS1pbnRlcm5hbCBmdW5jdGlvbiB0byBnZW5lcmF0ZSBjYWxsYmFja3MgdGhhdCBjYW4gYmUgYXBwbGllZFxuICAvLyB0byBlYWNoIGVsZW1lbnQgaW4gYSBjb2xsZWN0aW9uLCByZXR1cm5pbmcgdGhlIGRlc2lyZWQgcmVzdWx0IOKAlCBlaXRoZXJcbiAgLy8gaWRlbnRpdHksIGFuIGFyYml0cmFyeSBjYWxsYmFjaywgYSBwcm9wZXJ0eSBtYXRjaGVyLCBvciBhIHByb3BlcnR5IGFjY2Vzc29yLlxuICB2YXIgY2IgPSBmdW5jdGlvbih2YWx1ZSwgY29udGV4dCwgYXJnQ291bnQpIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIF8uaWRlbnRpdHk7XG4gICAgaWYgKF8uaXNGdW5jdGlvbih2YWx1ZSkpIHJldHVybiBvcHRpbWl6ZUNiKHZhbHVlLCBjb250ZXh0LCBhcmdDb3VudCk7XG4gICAgaWYgKF8uaXNPYmplY3QodmFsdWUpKSByZXR1cm4gXy5tYXRjaGVyKHZhbHVlKTtcbiAgICByZXR1cm4gXy5wcm9wZXJ0eSh2YWx1ZSk7XG4gIH07XG4gIF8uaXRlcmF0ZWUgPSBmdW5jdGlvbih2YWx1ZSwgY29udGV4dCkge1xuICAgIHJldHVybiBjYih2YWx1ZSwgY29udGV4dCwgSW5maW5pdHkpO1xuICB9O1xuXG4gIC8vIEFuIGludGVybmFsIGZ1bmN0aW9uIGZvciBjcmVhdGluZyBhc3NpZ25lciBmdW5jdGlvbnMuXG4gIHZhciBjcmVhdGVBc3NpZ25lciA9IGZ1bmN0aW9uKGtleXNGdW5jLCB1bmRlZmluZWRPbmx5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikge1xuICAgICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICBpZiAobGVuZ3RoIDwgMiB8fCBvYmogPT0gbnVsbCkgcmV0dXJuIG9iajtcbiAgICAgIGZvciAodmFyIGluZGV4ID0gMTsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpbmRleF0sXG4gICAgICAgICAgICBrZXlzID0ga2V5c0Z1bmMoc291cmNlKSxcbiAgICAgICAgICAgIGwgPSBrZXlzLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICAgICAgICBpZiAoIXVuZGVmaW5lZE9ubHkgfHwgb2JqW2tleV0gPT09IHZvaWQgMCkgb2JqW2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG9iajtcbiAgICB9O1xuICB9O1xuXG4gIC8vIEFuIGludGVybmFsIGZ1bmN0aW9uIGZvciBjcmVhdGluZyBhIG5ldyBvYmplY3QgdGhhdCBpbmhlcml0cyBmcm9tIGFub3RoZXIuXG4gIHZhciBiYXNlQ3JlYXRlID0gZnVuY3Rpb24ocHJvdG90eXBlKSB7XG4gICAgaWYgKCFfLmlzT2JqZWN0KHByb3RvdHlwZSkpIHJldHVybiB7fTtcbiAgICBpZiAobmF0aXZlQ3JlYXRlKSByZXR1cm4gbmF0aXZlQ3JlYXRlKHByb3RvdHlwZSk7XG4gICAgQ3Rvci5wcm90b3R5cGUgPSBwcm90b3R5cGU7XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBDdG9yO1xuICAgIEN0b3IucHJvdG90eXBlID0gbnVsbDtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIHZhciBwcm9wZXJ0eSA9IGZ1bmN0aW9uKGtleSkge1xuICAgIHJldHVybiBmdW5jdGlvbihvYmopIHtcbiAgICAgIHJldHVybiBvYmogPT0gbnVsbCA/IHZvaWQgMCA6IG9ialtrZXldO1xuICAgIH07XG4gIH07XG5cbiAgLy8gSGVscGVyIGZvciBjb2xsZWN0aW9uIG1ldGhvZHMgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgYSBjb2xsZWN0aW9uXG4gIC8vIHNob3VsZCBiZSBpdGVyYXRlZCBhcyBhbiBhcnJheSBvciBhcyBhbiBvYmplY3RcbiAgLy8gUmVsYXRlZDogaHR0cDovL3Blb3BsZS5tb3ppbGxhLm9yZy9+am9yZW5kb3JmZi9lczYtZHJhZnQuaHRtbCNzZWMtdG9sZW5ndGhcbiAgLy8gQXZvaWRzIGEgdmVyeSBuYXN0eSBpT1MgOCBKSVQgYnVnIG9uIEFSTS02NC4gIzIwOTRcbiAgdmFyIE1BWF9BUlJBWV9JTkRFWCA9IE1hdGgucG93KDIsIDUzKSAtIDE7XG4gIHZhciBnZXRMZW5ndGggPSBwcm9wZXJ0eSgnbGVuZ3RoJyk7XG4gIHZhciBpc0FycmF5TGlrZSA9IGZ1bmN0aW9uKGNvbGxlY3Rpb24pIHtcbiAgICB2YXIgbGVuZ3RoID0gZ2V0TGVuZ3RoKGNvbGxlY3Rpb24pO1xuICAgIHJldHVybiB0eXBlb2YgbGVuZ3RoID09ICdudW1iZXInICYmIGxlbmd0aCA+PSAwICYmIGxlbmd0aCA8PSBNQVhfQVJSQVlfSU5ERVg7XG4gIH07XG5cbiAgLy8gQ29sbGVjdGlvbiBGdW5jdGlvbnNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBUaGUgY29ybmVyc3RvbmUsIGFuIGBlYWNoYCBpbXBsZW1lbnRhdGlvbiwgYWthIGBmb3JFYWNoYC5cbiAgLy8gSGFuZGxlcyByYXcgb2JqZWN0cyBpbiBhZGRpdGlvbiB0byBhcnJheS1saWtlcy4gVHJlYXRzIGFsbFxuICAvLyBzcGFyc2UgYXJyYXktbGlrZXMgYXMgaWYgdGhleSB3ZXJlIGRlbnNlLlxuICBfLmVhY2ggPSBfLmZvckVhY2ggPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgaXRlcmF0ZWUgPSBvcHRpbWl6ZUNiKGl0ZXJhdGVlLCBjb250ZXh0KTtcbiAgICB2YXIgaSwgbGVuZ3RoO1xuICAgIGlmIChpc0FycmF5TGlrZShvYmopKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBvYmoubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaXRlcmF0ZWUob2JqW2ldLCBpLCBvYmopO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgICAgZm9yIChpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBpdGVyYXRlZShvYmpba2V5c1tpXV0sIGtleXNbaV0sIG9iaik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSByZXN1bHRzIG9mIGFwcGx5aW5nIHRoZSBpdGVyYXRlZSB0byBlYWNoIGVsZW1lbnQuXG4gIF8ubWFwID0gXy5jb2xsZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpO1xuICAgIHZhciBrZXlzID0gIWlzQXJyYXlMaWtlKG9iaikgJiYgXy5rZXlzKG9iaiksXG4gICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoLFxuICAgICAgICByZXN1bHRzID0gQXJyYXkobGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICB2YXIgY3VycmVudEtleSA9IGtleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4O1xuICAgICAgcmVzdWx0c1tpbmRleF0gPSBpdGVyYXRlZShvYmpbY3VycmVudEtleV0sIGN1cnJlbnRLZXksIG9iaik7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHRzO1xuICB9O1xuXG4gIC8vIENyZWF0ZSBhIHJlZHVjaW5nIGZ1bmN0aW9uIGl0ZXJhdGluZyBsZWZ0IG9yIHJpZ2h0LlxuICBmdW5jdGlvbiBjcmVhdGVSZWR1Y2UoZGlyKSB7XG4gICAgLy8gT3B0aW1pemVkIGl0ZXJhdG9yIGZ1bmN0aW9uIGFzIHVzaW5nIGFyZ3VtZW50cy5sZW5ndGhcbiAgICAvLyBpbiB0aGUgbWFpbiBmdW5jdGlvbiB3aWxsIGRlb3B0aW1pemUgdGhlLCBzZWUgIzE5OTEuXG4gICAgZnVuY3Rpb24gaXRlcmF0b3Iob2JqLCBpdGVyYXRlZSwgbWVtbywga2V5cywgaW5kZXgsIGxlbmd0aCkge1xuICAgICAgZm9yICg7IGluZGV4ID49IDAgJiYgaW5kZXggPCBsZW5ndGg7IGluZGV4ICs9IGRpcikge1xuICAgICAgICB2YXIgY3VycmVudEtleSA9IGtleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4O1xuICAgICAgICBtZW1vID0gaXRlcmF0ZWUobWVtbywgb2JqW2N1cnJlbnRLZXldLCBjdXJyZW50S2V5LCBvYmopO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1lbW87XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIG1lbW8sIGNvbnRleHQpIHtcbiAgICAgIGl0ZXJhdGVlID0gb3B0aW1pemVDYihpdGVyYXRlZSwgY29udGV4dCwgNCk7XG4gICAgICB2YXIga2V5cyA9ICFpc0FycmF5TGlrZShvYmopICYmIF8ua2V5cyhvYmopLFxuICAgICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoLFxuICAgICAgICAgIGluZGV4ID0gZGlyID4gMCA/IDAgOiBsZW5ndGggLSAxO1xuICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBpbml0aWFsIHZhbHVlIGlmIG5vbmUgaXMgcHJvdmlkZWQuXG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgbWVtbyA9IG9ialtrZXlzID8ga2V5c1tpbmRleF0gOiBpbmRleF07XG4gICAgICAgIGluZGV4ICs9IGRpcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBpdGVyYXRvcihvYmosIGl0ZXJhdGVlLCBtZW1vLCBrZXlzLCBpbmRleCwgbGVuZ3RoKTtcbiAgICB9O1xuICB9XG5cbiAgLy8gKipSZWR1Y2UqKiBidWlsZHMgdXAgYSBzaW5nbGUgcmVzdWx0IGZyb20gYSBsaXN0IG9mIHZhbHVlcywgYWthIGBpbmplY3RgLFxuICAvLyBvciBgZm9sZGxgLlxuICBfLnJlZHVjZSA9IF8uZm9sZGwgPSBfLmluamVjdCA9IGNyZWF0ZVJlZHVjZSgxKTtcblxuICAvLyBUaGUgcmlnaHQtYXNzb2NpYXRpdmUgdmVyc2lvbiBvZiByZWR1Y2UsIGFsc28ga25vd24gYXMgYGZvbGRyYC5cbiAgXy5yZWR1Y2VSaWdodCA9IF8uZm9sZHIgPSBjcmVhdGVSZWR1Y2UoLTEpO1xuXG4gIC8vIFJldHVybiB0aGUgZmlyc3QgdmFsdWUgd2hpY2ggcGFzc2VzIGEgdHJ1dGggdGVzdC4gQWxpYXNlZCBhcyBgZGV0ZWN0YC5cbiAgXy5maW5kID0gXy5kZXRlY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHZhciBrZXk7XG4gICAgaWYgKGlzQXJyYXlMaWtlKG9iaikpIHtcbiAgICAgIGtleSA9IF8uZmluZEluZGV4KG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KTtcbiAgICB9IGVsc2Uge1xuICAgICAga2V5ID0gXy5maW5kS2V5KG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KTtcbiAgICB9XG4gICAgaWYgKGtleSAhPT0gdm9pZCAwICYmIGtleSAhPT0gLTEpIHJldHVybiBvYmpba2V5XTtcbiAgfTtcblxuICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyB0aGF0IHBhc3MgYSB0cnV0aCB0ZXN0LlxuICAvLyBBbGlhc2VkIGFzIGBzZWxlY3RgLlxuICBfLmZpbHRlciA9IF8uc2VsZWN0ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7XG4gICAgXy5lYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpZiAocHJlZGljYXRlKHZhbHVlLCBpbmRleCwgbGlzdCkpIHJlc3VsdHMucHVzaCh2YWx1ZSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGFsbCB0aGUgZWxlbWVudHMgZm9yIHdoaWNoIGEgdHJ1dGggdGVzdCBmYWlscy5cbiAgXy5yZWplY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHJldHVybiBfLmZpbHRlcihvYmosIF8ubmVnYXRlKGNiKHByZWRpY2F0ZSkpLCBjb250ZXh0KTtcbiAgfTtcblxuICAvLyBEZXRlcm1pbmUgd2hldGhlciBhbGwgb2YgdGhlIGVsZW1lbnRzIG1hdGNoIGEgdHJ1dGggdGVzdC5cbiAgLy8gQWxpYXNlZCBhcyBgYWxsYC5cbiAgXy5ldmVyeSA9IF8uYWxsID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIHZhciBrZXlzID0gIWlzQXJyYXlMaWtlKG9iaikgJiYgXy5rZXlzKG9iaiksXG4gICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoO1xuICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIHZhciBjdXJyZW50S2V5ID0ga2V5cyA/IGtleXNbaW5kZXhdIDogaW5kZXg7XG4gICAgICBpZiAoIXByZWRpY2F0ZShvYmpbY3VycmVudEtleV0sIGN1cnJlbnRLZXksIG9iaikpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cbiAgLy8gRGV0ZXJtaW5lIGlmIGF0IGxlYXN0IG9uZSBlbGVtZW50IGluIHRoZSBvYmplY3QgbWF0Y2hlcyBhIHRydXRoIHRlc3QuXG4gIC8vIEFsaWFzZWQgYXMgYGFueWAuXG4gIF8uc29tZSA9IF8uYW55ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIHZhciBrZXlzID0gIWlzQXJyYXlMaWtlKG9iaikgJiYgXy5rZXlzKG9iaiksXG4gICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoO1xuICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIHZhciBjdXJyZW50S2V5ID0ga2V5cyA/IGtleXNbaW5kZXhdIDogaW5kZXg7XG4gICAgICBpZiAocHJlZGljYXRlKG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKSkgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICAvLyBEZXRlcm1pbmUgaWYgdGhlIGFycmF5IG9yIG9iamVjdCBjb250YWlucyBhIGdpdmVuIGl0ZW0gKHVzaW5nIGA9PT1gKS5cbiAgLy8gQWxpYXNlZCBhcyBgaW5jbHVkZXNgIGFuZCBgaW5jbHVkZWAuXG4gIF8uY29udGFpbnMgPSBfLmluY2x1ZGVzID0gXy5pbmNsdWRlID0gZnVuY3Rpb24ob2JqLCBpdGVtLCBmcm9tSW5kZXgsIGd1YXJkKSB7XG4gICAgaWYgKCFpc0FycmF5TGlrZShvYmopKSBvYmogPSBfLnZhbHVlcyhvYmopO1xuICAgIGlmICh0eXBlb2YgZnJvbUluZGV4ICE9ICdudW1iZXInIHx8IGd1YXJkKSBmcm9tSW5kZXggPSAwO1xuICAgIHJldHVybiBfLmluZGV4T2Yob2JqLCBpdGVtLCBmcm9tSW5kZXgpID49IDA7XG4gIH07XG5cbiAgLy8gSW52b2tlIGEgbWV0aG9kICh3aXRoIGFyZ3VtZW50cykgb24gZXZlcnkgaXRlbSBpbiBhIGNvbGxlY3Rpb24uXG4gIF8uaW52b2tlID0gZnVuY3Rpb24ob2JqLCBtZXRob2QpIHtcbiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcbiAgICB2YXIgaXNGdW5jID0gXy5pc0Z1bmN0aW9uKG1ldGhvZCk7XG4gICAgcmV0dXJuIF8ubWFwKG9iaiwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBmdW5jID0gaXNGdW5jID8gbWV0aG9kIDogdmFsdWVbbWV0aG9kXTtcbiAgICAgIHJldHVybiBmdW5jID09IG51bGwgPyBmdW5jIDogZnVuYy5hcHBseSh2YWx1ZSwgYXJncyk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNvbW1vbiB1c2UgY2FzZSBvZiBgbWFwYDogZmV0Y2hpbmcgYSBwcm9wZXJ0eS5cbiAgXy5wbHVjayA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7XG4gICAgcmV0dXJuIF8ubWFwKG9iaiwgXy5wcm9wZXJ0eShrZXkpKTtcbiAgfTtcblxuICAvLyBDb252ZW5pZW5jZSB2ZXJzaW9uIG9mIGEgY29tbW9uIHVzZSBjYXNlIG9mIGBmaWx0ZXJgOiBzZWxlY3Rpbmcgb25seSBvYmplY3RzXG4gIC8vIGNvbnRhaW5pbmcgc3BlY2lmaWMgYGtleTp2YWx1ZWAgcGFpcnMuXG4gIF8ud2hlcmUgPSBmdW5jdGlvbihvYmosIGF0dHJzKSB7XG4gICAgcmV0dXJuIF8uZmlsdGVyKG9iaiwgXy5tYXRjaGVyKGF0dHJzKSk7XG4gIH07XG5cbiAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNvbW1vbiB1c2UgY2FzZSBvZiBgZmluZGA6IGdldHRpbmcgdGhlIGZpcnN0IG9iamVjdFxuICAvLyBjb250YWluaW5nIHNwZWNpZmljIGBrZXk6dmFsdWVgIHBhaXJzLlxuICBfLmZpbmRXaGVyZSA9IGZ1bmN0aW9uKG9iaiwgYXR0cnMpIHtcbiAgICByZXR1cm4gXy5maW5kKG9iaiwgXy5tYXRjaGVyKGF0dHJzKSk7XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSBtYXhpbXVtIGVsZW1lbnQgKG9yIGVsZW1lbnQtYmFzZWQgY29tcHV0YXRpb24pLlxuICBfLm1heCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0ID0gLUluZmluaXR5LCBsYXN0Q29tcHV0ZWQgPSAtSW5maW5pdHksXG4gICAgICAgIHZhbHVlLCBjb21wdXRlZDtcbiAgICBpZiAoaXRlcmF0ZWUgPT0gbnVsbCAmJiBvYmogIT0gbnVsbCkge1xuICAgICAgb2JqID0gaXNBcnJheUxpa2Uob2JqKSA/IG9iaiA6IF8udmFsdWVzKG9iaik7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gb2JqLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhbHVlID0gb2JqW2ldO1xuICAgICAgICBpZiAodmFsdWUgPiByZXN1bHQpIHtcbiAgICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpdGVyYXRlZSA9IGNiKGl0ZXJhdGVlLCBjb250ZXh0KTtcbiAgICAgIF8uZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgICBjb21wdXRlZCA9IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgbGlzdCk7XG4gICAgICAgIGlmIChjb21wdXRlZCA+IGxhc3RDb21wdXRlZCB8fCBjb21wdXRlZCA9PT0gLUluZmluaXR5ICYmIHJlc3VsdCA9PT0gLUluZmluaXR5KSB7XG4gICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgbGFzdENvbXB1dGVkID0gY29tcHV0ZWQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgbWluaW11bSBlbGVtZW50IChvciBlbGVtZW50LWJhc2VkIGNvbXB1dGF0aW9uKS5cbiAgXy5taW4gPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdCA9IEluZmluaXR5LCBsYXN0Q29tcHV0ZWQgPSBJbmZpbml0eSxcbiAgICAgICAgdmFsdWUsIGNvbXB1dGVkO1xuICAgIGlmIChpdGVyYXRlZSA9PSBudWxsICYmIG9iaiAhPSBudWxsKSB7XG4gICAgICBvYmogPSBpc0FycmF5TGlrZShvYmopID8gb2JqIDogXy52YWx1ZXMob2JqKTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBvYmoubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFsdWUgPSBvYmpbaV07XG4gICAgICAgIGlmICh2YWx1ZSA8IHJlc3VsdCkge1xuICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpO1xuICAgICAgXy5lYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICAgIGNvbXB1dGVkID0gaXRlcmF0ZWUodmFsdWUsIGluZGV4LCBsaXN0KTtcbiAgICAgICAgaWYgKGNvbXB1dGVkIDwgbGFzdENvbXB1dGVkIHx8IGNvbXB1dGVkID09PSBJbmZpbml0eSAmJiByZXN1bHQgPT09IEluZmluaXR5KSB7XG4gICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgbGFzdENvbXB1dGVkID0gY29tcHV0ZWQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFNodWZmbGUgYSBjb2xsZWN0aW9uLCB1c2luZyB0aGUgbW9kZXJuIHZlcnNpb24gb2YgdGhlXG4gIC8vIFtGaXNoZXItWWF0ZXMgc2h1ZmZsZV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GaXNoZXLigJNZYXRlc19zaHVmZmxlKS5cbiAgXy5zaHVmZmxlID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIHNldCA9IGlzQXJyYXlMaWtlKG9iaikgPyBvYmogOiBfLnZhbHVlcyhvYmopO1xuICAgIHZhciBsZW5ndGggPSBzZXQubGVuZ3RoO1xuICAgIHZhciBzaHVmZmxlZCA9IEFycmF5KGxlbmd0aCk7XG4gICAgZm9yICh2YXIgaW5kZXggPSAwLCByYW5kOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgcmFuZCA9IF8ucmFuZG9tKDAsIGluZGV4KTtcbiAgICAgIGlmIChyYW5kICE9PSBpbmRleCkgc2h1ZmZsZWRbaW5kZXhdID0gc2h1ZmZsZWRbcmFuZF07XG4gICAgICBzaHVmZmxlZFtyYW5kXSA9IHNldFtpbmRleF07XG4gICAgfVxuICAgIHJldHVybiBzaHVmZmxlZDtcbiAgfTtcblxuICAvLyBTYW1wbGUgKipuKiogcmFuZG9tIHZhbHVlcyBmcm9tIGEgY29sbGVjdGlvbi5cbiAgLy8gSWYgKipuKiogaXMgbm90IHNwZWNpZmllZCwgcmV0dXJucyBhIHNpbmdsZSByYW5kb20gZWxlbWVudC5cbiAgLy8gVGhlIGludGVybmFsIGBndWFyZGAgYXJndW1lbnQgYWxsb3dzIGl0IHRvIHdvcmsgd2l0aCBgbWFwYC5cbiAgXy5zYW1wbGUgPSBmdW5jdGlvbihvYmosIG4sIGd1YXJkKSB7XG4gICAgaWYgKG4gPT0gbnVsbCB8fCBndWFyZCkge1xuICAgICAgaWYgKCFpc0FycmF5TGlrZShvYmopKSBvYmogPSBfLnZhbHVlcyhvYmopO1xuICAgICAgcmV0dXJuIG9ialtfLnJhbmRvbShvYmoubGVuZ3RoIC0gMSldO1xuICAgIH1cbiAgICByZXR1cm4gXy5zaHVmZmxlKG9iaikuc2xpY2UoMCwgTWF0aC5tYXgoMCwgbikpO1xuICB9O1xuXG4gIC8vIFNvcnQgdGhlIG9iamVjdCdzIHZhbHVlcyBieSBhIGNyaXRlcmlvbiBwcm9kdWNlZCBieSBhbiBpdGVyYXRlZS5cbiAgXy5zb3J0QnkgPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7XG4gICAgcmV0dXJuIF8ucGx1Y2soXy5tYXAob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICBjcml0ZXJpYTogaXRlcmF0ZWUodmFsdWUsIGluZGV4LCBsaXN0KVxuICAgICAgfTtcbiAgICB9KS5zb3J0KGZ1bmN0aW9uKGxlZnQsIHJpZ2h0KSB7XG4gICAgICB2YXIgYSA9IGxlZnQuY3JpdGVyaWE7XG4gICAgICB2YXIgYiA9IHJpZ2h0LmNyaXRlcmlhO1xuICAgICAgaWYgKGEgIT09IGIpIHtcbiAgICAgICAgaWYgKGEgPiBiIHx8IGEgPT09IHZvaWQgMCkgcmV0dXJuIDE7XG4gICAgICAgIGlmIChhIDwgYiB8fCBiID09PSB2b2lkIDApIHJldHVybiAtMTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBsZWZ0LmluZGV4IC0gcmlnaHQuaW5kZXg7XG4gICAgfSksICd2YWx1ZScpO1xuICB9O1xuXG4gIC8vIEFuIGludGVybmFsIGZ1bmN0aW9uIHVzZWQgZm9yIGFnZ3JlZ2F0ZSBcImdyb3VwIGJ5XCIgb3BlcmF0aW9ucy5cbiAgdmFyIGdyb3VwID0gZnVuY3Rpb24oYmVoYXZpb3IpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7XG4gICAgICBfLmVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIGtleSA9IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgb2JqKTtcbiAgICAgICAgYmVoYXZpb3IocmVzdWx0LCB2YWx1ZSwga2V5KTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9O1xuXG4gIC8vIEdyb3VwcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLiBQYXNzIGVpdGhlciBhIHN0cmluZyBhdHRyaWJ1dGVcbiAgLy8gdG8gZ3JvdXAgYnksIG9yIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBjcml0ZXJpb24uXG4gIF8uZ3JvdXBCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkge1xuICAgIGlmIChfLmhhcyhyZXN1bHQsIGtleSkpIHJlc3VsdFtrZXldLnB1c2godmFsdWUpOyBlbHNlIHJlc3VsdFtrZXldID0gW3ZhbHVlXTtcbiAgfSk7XG5cbiAgLy8gSW5kZXhlcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLCBzaW1pbGFyIHRvIGBncm91cEJ5YCwgYnV0IGZvclxuICAvLyB3aGVuIHlvdSBrbm93IHRoYXQgeW91ciBpbmRleCB2YWx1ZXMgd2lsbCBiZSB1bmlxdWUuXG4gIF8uaW5kZXhCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gIH0pO1xuXG4gIC8vIENvdW50cyBpbnN0YW5jZXMgb2YgYW4gb2JqZWN0IHRoYXQgZ3JvdXAgYnkgYSBjZXJ0YWluIGNyaXRlcmlvbi4gUGFzc1xuICAvLyBlaXRoZXIgYSBzdHJpbmcgYXR0cmlidXRlIHRvIGNvdW50IGJ5LCBvciBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGVcbiAgLy8gY3JpdGVyaW9uLlxuICBfLmNvdW50QnkgPSBncm91cChmdW5jdGlvbihyZXN1bHQsIHZhbHVlLCBrZXkpIHtcbiAgICBpZiAoXy5oYXMocmVzdWx0LCBrZXkpKSByZXN1bHRba2V5XSsrOyBlbHNlIHJlc3VsdFtrZXldID0gMTtcbiAgfSk7XG5cbiAgLy8gU2FmZWx5IGNyZWF0ZSBhIHJlYWwsIGxpdmUgYXJyYXkgZnJvbSBhbnl0aGluZyBpdGVyYWJsZS5cbiAgXy50b0FycmF5ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKCFvYmopIHJldHVybiBbXTtcbiAgICBpZiAoXy5pc0FycmF5KG9iaikpIHJldHVybiBzbGljZS5jYWxsKG9iaik7XG4gICAgaWYgKGlzQXJyYXlMaWtlKG9iaikpIHJldHVybiBfLm1hcChvYmosIF8uaWRlbnRpdHkpO1xuICAgIHJldHVybiBfLnZhbHVlcyhvYmopO1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGFuIG9iamVjdC5cbiAgXy5zaXplID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gMDtcbiAgICByZXR1cm4gaXNBcnJheUxpa2Uob2JqKSA/IG9iai5sZW5ndGggOiBfLmtleXMob2JqKS5sZW5ndGg7XG4gIH07XG5cbiAgLy8gU3BsaXQgYSBjb2xsZWN0aW9uIGludG8gdHdvIGFycmF5czogb25lIHdob3NlIGVsZW1lbnRzIGFsbCBzYXRpc2Z5IHRoZSBnaXZlblxuICAvLyBwcmVkaWNhdGUsIGFuZCBvbmUgd2hvc2UgZWxlbWVudHMgYWxsIGRvIG5vdCBzYXRpc2Z5IHRoZSBwcmVkaWNhdGUuXG4gIF8ucGFydGl0aW9uID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIHZhciBwYXNzID0gW10sIGZhaWwgPSBbXTtcbiAgICBfLmVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBvYmopIHtcbiAgICAgIChwcmVkaWNhdGUodmFsdWUsIGtleSwgb2JqKSA/IHBhc3MgOiBmYWlsKS5wdXNoKHZhbHVlKTtcbiAgICB9KTtcbiAgICByZXR1cm4gW3Bhc3MsIGZhaWxdO1xuICB9O1xuXG4gIC8vIEFycmF5IEZ1bmN0aW9uc1xuICAvLyAtLS0tLS0tLS0tLS0tLS1cblxuICAvLyBHZXQgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYW4gYXJyYXkuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gdGhlIGZpcnN0IE5cbiAgLy8gdmFsdWVzIGluIHRoZSBhcnJheS4gQWxpYXNlZCBhcyBgaGVhZGAgYW5kIGB0YWtlYC4gVGhlICoqZ3VhcmQqKiBjaGVja1xuICAvLyBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBfLm1hcGAuXG4gIF8uZmlyc3QgPSBfLmhlYWQgPSBfLnRha2UgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHtcbiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIHZvaWQgMDtcbiAgICBpZiAobiA9PSBudWxsIHx8IGd1YXJkKSByZXR1cm4gYXJyYXlbMF07XG4gICAgcmV0dXJuIF8uaW5pdGlhbChhcnJheSwgYXJyYXkubGVuZ3RoIC0gbik7XG4gIH07XG5cbiAgLy8gUmV0dXJucyBldmVyeXRoaW5nIGJ1dCB0aGUgbGFzdCBlbnRyeSBvZiB0aGUgYXJyYXkuIEVzcGVjaWFsbHkgdXNlZnVsIG9uXG4gIC8vIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIGFsbCB0aGUgdmFsdWVzIGluXG4gIC8vIHRoZSBhcnJheSwgZXhjbHVkaW5nIHRoZSBsYXN0IE4uXG4gIF8uaW5pdGlhbCA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkge1xuICAgIHJldHVybiBzbGljZS5jYWxsKGFycmF5LCAwLCBNYXRoLm1heCgwLCBhcnJheS5sZW5ndGggLSAobiA9PSBudWxsIHx8IGd1YXJkID8gMSA6IG4pKSk7XG4gIH07XG5cbiAgLy8gR2V0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXkuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gdGhlIGxhc3QgTlxuICAvLyB2YWx1ZXMgaW4gdGhlIGFycmF5LlxuICBfLmxhc3QgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHtcbiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIHZvaWQgMDtcbiAgICBpZiAobiA9PSBudWxsIHx8IGd1YXJkKSByZXR1cm4gYXJyYXlbYXJyYXkubGVuZ3RoIC0gMV07XG4gICAgcmV0dXJuIF8ucmVzdChhcnJheSwgTWF0aC5tYXgoMCwgYXJyYXkubGVuZ3RoIC0gbikpO1xuICB9O1xuXG4gIC8vIFJldHVybnMgZXZlcnl0aGluZyBidXQgdGhlIGZpcnN0IGVudHJ5IG9mIHRoZSBhcnJheS4gQWxpYXNlZCBhcyBgdGFpbGAgYW5kIGBkcm9wYC5cbiAgLy8gRXNwZWNpYWxseSB1c2VmdWwgb24gdGhlIGFyZ3VtZW50cyBvYmplY3QuIFBhc3NpbmcgYW4gKipuKiogd2lsbCByZXR1cm5cbiAgLy8gdGhlIHJlc3QgTiB2YWx1ZXMgaW4gdGhlIGFycmF5LlxuICBfLnJlc3QgPSBfLnRhaWwgPSBfLmRyb3AgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHtcbiAgICByZXR1cm4gc2xpY2UuY2FsbChhcnJheSwgbiA9PSBudWxsIHx8IGd1YXJkID8gMSA6IG4pO1xuICB9O1xuXG4gIC8vIFRyaW0gb3V0IGFsbCBmYWxzeSB2YWx1ZXMgZnJvbSBhbiBhcnJheS5cbiAgXy5jb21wYWN0ID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICByZXR1cm4gXy5maWx0ZXIoYXJyYXksIF8uaWRlbnRpdHkpO1xuICB9O1xuXG4gIC8vIEludGVybmFsIGltcGxlbWVudGF0aW9uIG9mIGEgcmVjdXJzaXZlIGBmbGF0dGVuYCBmdW5jdGlvbi5cbiAgdmFyIGZsYXR0ZW4gPSBmdW5jdGlvbihpbnB1dCwgc2hhbGxvdywgc3RyaWN0LCBzdGFydEluZGV4KSB7XG4gICAgdmFyIG91dHB1dCA9IFtdLCBpZHggPSAwO1xuICAgIGZvciAodmFyIGkgPSBzdGFydEluZGV4IHx8IDAsIGxlbmd0aCA9IGdldExlbmd0aChpbnB1dCk7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHZhbHVlID0gaW5wdXRbaV07XG4gICAgICBpZiAoaXNBcnJheUxpa2UodmFsdWUpICYmIChfLmlzQXJyYXkodmFsdWUpIHx8IF8uaXNBcmd1bWVudHModmFsdWUpKSkge1xuICAgICAgICAvL2ZsYXR0ZW4gY3VycmVudCBsZXZlbCBvZiBhcnJheSBvciBhcmd1bWVudHMgb2JqZWN0XG4gICAgICAgIGlmICghc2hhbGxvdykgdmFsdWUgPSBmbGF0dGVuKHZhbHVlLCBzaGFsbG93LCBzdHJpY3QpO1xuICAgICAgICB2YXIgaiA9IDAsIGxlbiA9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgb3V0cHV0Lmxlbmd0aCArPSBsZW47XG4gICAgICAgIHdoaWxlIChqIDwgbGVuKSB7XG4gICAgICAgICAgb3V0cHV0W2lkeCsrXSA9IHZhbHVlW2orK107XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoIXN0cmljdCkge1xuICAgICAgICBvdXRwdXRbaWR4KytdID0gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQ7XG4gIH07XG5cbiAgLy8gRmxhdHRlbiBvdXQgYW4gYXJyYXksIGVpdGhlciByZWN1cnNpdmVseSAoYnkgZGVmYXVsdCksIG9yIGp1c3Qgb25lIGxldmVsLlxuICBfLmZsYXR0ZW4gPSBmdW5jdGlvbihhcnJheSwgc2hhbGxvdykge1xuICAgIHJldHVybiBmbGF0dGVuKGFycmF5LCBzaGFsbG93LCBmYWxzZSk7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgdmVyc2lvbiBvZiB0aGUgYXJyYXkgdGhhdCBkb2VzIG5vdCBjb250YWluIHRoZSBzcGVjaWZpZWQgdmFsdWUocykuXG4gIF8ud2l0aG91dCA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgcmV0dXJuIF8uZGlmZmVyZW5jZShhcnJheSwgc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgfTtcblxuICAvLyBQcm9kdWNlIGEgZHVwbGljYXRlLWZyZWUgdmVyc2lvbiBvZiB0aGUgYXJyYXkuIElmIHRoZSBhcnJheSBoYXMgYWxyZWFkeVxuICAvLyBiZWVuIHNvcnRlZCwgeW91IGhhdmUgdGhlIG9wdGlvbiBvZiB1c2luZyBhIGZhc3RlciBhbGdvcml0aG0uXG4gIC8vIEFsaWFzZWQgYXMgYHVuaXF1ZWAuXG4gIF8udW5pcSA9IF8udW5pcXVlID0gZnVuY3Rpb24oYXJyYXksIGlzU29ydGVkLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgIGlmICghXy5pc0Jvb2xlYW4oaXNTb3J0ZWQpKSB7XG4gICAgICBjb250ZXh0ID0gaXRlcmF0ZWU7XG4gICAgICBpdGVyYXRlZSA9IGlzU29ydGVkO1xuICAgICAgaXNTb3J0ZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGl0ZXJhdGVlICE9IG51bGwpIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpO1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB2YXIgc2VlbiA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBnZXRMZW5ndGgoYXJyYXkpOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2ldLFxuICAgICAgICAgIGNvbXB1dGVkID0gaXRlcmF0ZWUgPyBpdGVyYXRlZSh2YWx1ZSwgaSwgYXJyYXkpIDogdmFsdWU7XG4gICAgICBpZiAoaXNTb3J0ZWQpIHtcbiAgICAgICAgaWYgKCFpIHx8IHNlZW4gIT09IGNvbXB1dGVkKSByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICAgIHNlZW4gPSBjb21wdXRlZDtcbiAgICAgIH0gZWxzZSBpZiAoaXRlcmF0ZWUpIHtcbiAgICAgICAgaWYgKCFfLmNvbnRhaW5zKHNlZW4sIGNvbXB1dGVkKSkge1xuICAgICAgICAgIHNlZW4ucHVzaChjb21wdXRlZCk7XG4gICAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKCFfLmNvbnRhaW5zKHJlc3VsdCwgdmFsdWUpKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBQcm9kdWNlIGFuIGFycmF5IHRoYXQgY29udGFpbnMgdGhlIHVuaW9uOiBlYWNoIGRpc3RpbmN0IGVsZW1lbnQgZnJvbSBhbGwgb2ZcbiAgLy8gdGhlIHBhc3NlZC1pbiBhcnJheXMuXG4gIF8udW5pb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gXy51bmlxKGZsYXR0ZW4oYXJndW1lbnRzLCB0cnVlLCB0cnVlKSk7XG4gIH07XG5cbiAgLy8gUHJvZHVjZSBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIGV2ZXJ5IGl0ZW0gc2hhcmVkIGJldHdlZW4gYWxsIHRoZVxuICAvLyBwYXNzZWQtaW4gYXJyYXlzLlxuICBfLmludGVyc2VjdGlvbiA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIHZhciBhcmdzTGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gZ2V0TGVuZ3RoKGFycmF5KTsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgaXRlbSA9IGFycmF5W2ldO1xuICAgICAgaWYgKF8uY29udGFpbnMocmVzdWx0LCBpdGVtKSkgY29udGludWU7XG4gICAgICBmb3IgKHZhciBqID0gMTsgaiA8IGFyZ3NMZW5ndGg7IGorKykge1xuICAgICAgICBpZiAoIV8uY29udGFpbnMoYXJndW1lbnRzW2pdLCBpdGVtKSkgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAoaiA9PT0gYXJnc0xlbmd0aCkgcmVzdWx0LnB1c2goaXRlbSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgLy8gVGFrZSB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIG9uZSBhcnJheSBhbmQgYSBudW1iZXIgb2Ygb3RoZXIgYXJyYXlzLlxuICAvLyBPbmx5IHRoZSBlbGVtZW50cyBwcmVzZW50IGluIGp1c3QgdGhlIGZpcnN0IGFycmF5IHdpbGwgcmVtYWluLlxuICBfLmRpZmZlcmVuY2UgPSBmdW5jdGlvbihhcnJheSkge1xuICAgIHZhciByZXN0ID0gZmxhdHRlbihhcmd1bWVudHMsIHRydWUsIHRydWUsIDEpO1xuICAgIHJldHVybiBfLmZpbHRlcihhcnJheSwgZnVuY3Rpb24odmFsdWUpe1xuICAgICAgcmV0dXJuICFfLmNvbnRhaW5zKHJlc3QsIHZhbHVlKTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBaaXAgdG9nZXRoZXIgbXVsdGlwbGUgbGlzdHMgaW50byBhIHNpbmdsZSBhcnJheSAtLSBlbGVtZW50cyB0aGF0IHNoYXJlXG4gIC8vIGFuIGluZGV4IGdvIHRvZ2V0aGVyLlxuICBfLnppcCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfLnVuemlwKGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgLy8gQ29tcGxlbWVudCBvZiBfLnppcC4gVW56aXAgYWNjZXB0cyBhbiBhcnJheSBvZiBhcnJheXMgYW5kIGdyb3Vwc1xuICAvLyBlYWNoIGFycmF5J3MgZWxlbWVudHMgb24gc2hhcmVkIGluZGljZXNcbiAgXy51bnppcCA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgdmFyIGxlbmd0aCA9IGFycmF5ICYmIF8ubWF4KGFycmF5LCBnZXRMZW5ndGgpLmxlbmd0aCB8fCAwO1xuICAgIHZhciByZXN1bHQgPSBBcnJheShsZW5ndGgpO1xuXG4gICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgcmVzdWx0W2luZGV4XSA9IF8ucGx1Y2soYXJyYXksIGluZGV4KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBDb252ZXJ0cyBsaXN0cyBpbnRvIG9iamVjdHMuIFBhc3MgZWl0aGVyIGEgc2luZ2xlIGFycmF5IG9mIGBba2V5LCB2YWx1ZV1gXG4gIC8vIHBhaXJzLCBvciB0d28gcGFyYWxsZWwgYXJyYXlzIG9mIHRoZSBzYW1lIGxlbmd0aCAtLSBvbmUgb2Yga2V5cywgYW5kIG9uZSBvZlxuICAvLyB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZXMuXG4gIF8ub2JqZWN0ID0gZnVuY3Rpb24obGlzdCwgdmFsdWVzKSB7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBnZXRMZW5ndGgobGlzdCk7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHZhbHVlcykge1xuICAgICAgICByZXN1bHRbbGlzdFtpXV0gPSB2YWx1ZXNbaV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRbbGlzdFtpXVswXV0gPSBsaXN0W2ldWzFdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIEdlbmVyYXRvciBmdW5jdGlvbiB0byBjcmVhdGUgdGhlIGZpbmRJbmRleCBhbmQgZmluZExhc3RJbmRleCBmdW5jdGlvbnNcbiAgZnVuY3Rpb24gY3JlYXRlUHJlZGljYXRlSW5kZXhGaW5kZXIoZGlyKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGFycmF5LCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7XG4gICAgICB2YXIgbGVuZ3RoID0gZ2V0TGVuZ3RoKGFycmF5KTtcbiAgICAgIHZhciBpbmRleCA9IGRpciA+IDAgPyAwIDogbGVuZ3RoIC0gMTtcbiAgICAgIGZvciAoOyBpbmRleCA+PSAwICYmIGluZGV4IDwgbGVuZ3RoOyBpbmRleCArPSBkaXIpIHtcbiAgICAgICAgaWYgKHByZWRpY2F0ZShhcnJheVtpbmRleF0sIGluZGV4LCBhcnJheSkpIHJldHVybiBpbmRleDtcbiAgICAgIH1cbiAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICB9XG5cbiAgLy8gUmV0dXJucyB0aGUgZmlyc3QgaW5kZXggb24gYW4gYXJyYXktbGlrZSB0aGF0IHBhc3NlcyBhIHByZWRpY2F0ZSB0ZXN0XG4gIF8uZmluZEluZGV4ID0gY3JlYXRlUHJlZGljYXRlSW5kZXhGaW5kZXIoMSk7XG4gIF8uZmluZExhc3RJbmRleCA9IGNyZWF0ZVByZWRpY2F0ZUluZGV4RmluZGVyKC0xKTtcblxuICAvLyBVc2UgYSBjb21wYXJhdG9yIGZ1bmN0aW9uIHRvIGZpZ3VyZSBvdXQgdGhlIHNtYWxsZXN0IGluZGV4IGF0IHdoaWNoXG4gIC8vIGFuIG9iamVjdCBzaG91bGQgYmUgaW5zZXJ0ZWQgc28gYXMgdG8gbWFpbnRhaW4gb3JkZXIuIFVzZXMgYmluYXJ5IHNlYXJjaC5cbiAgXy5zb3J0ZWRJbmRleCA9IGZ1bmN0aW9uKGFycmF5LCBvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCwgMSk7XG4gICAgdmFyIHZhbHVlID0gaXRlcmF0ZWUob2JqKTtcbiAgICB2YXIgbG93ID0gMCwgaGlnaCA9IGdldExlbmd0aChhcnJheSk7XG4gICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHtcbiAgICAgIHZhciBtaWQgPSBNYXRoLmZsb29yKChsb3cgKyBoaWdoKSAvIDIpO1xuICAgICAgaWYgKGl0ZXJhdGVlKGFycmF5W21pZF0pIDwgdmFsdWUpIGxvdyA9IG1pZCArIDE7IGVsc2UgaGlnaCA9IG1pZDtcbiAgICB9XG4gICAgcmV0dXJuIGxvdztcbiAgfTtcblxuICAvLyBHZW5lcmF0b3IgZnVuY3Rpb24gdG8gY3JlYXRlIHRoZSBpbmRleE9mIGFuZCBsYXN0SW5kZXhPZiBmdW5jdGlvbnNcbiAgZnVuY3Rpb24gY3JlYXRlSW5kZXhGaW5kZXIoZGlyLCBwcmVkaWNhdGVGaW5kLCBzb3J0ZWRJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbihhcnJheSwgaXRlbSwgaWR4KSB7XG4gICAgICB2YXIgaSA9IDAsIGxlbmd0aCA9IGdldExlbmd0aChhcnJheSk7XG4gICAgICBpZiAodHlwZW9mIGlkeCA9PSAnbnVtYmVyJykge1xuICAgICAgICBpZiAoZGlyID4gMCkge1xuICAgICAgICAgICAgaSA9IGlkeCA+PSAwID8gaWR4IDogTWF0aC5tYXgoaWR4ICsgbGVuZ3RoLCBpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxlbmd0aCA9IGlkeCA+PSAwID8gTWF0aC5taW4oaWR4ICsgMSwgbGVuZ3RoKSA6IGlkeCArIGxlbmd0aCArIDE7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoc29ydGVkSW5kZXggJiYgaWR4ICYmIGxlbmd0aCkge1xuICAgICAgICBpZHggPSBzb3J0ZWRJbmRleChhcnJheSwgaXRlbSk7XG4gICAgICAgIHJldHVybiBhcnJheVtpZHhdID09PSBpdGVtID8gaWR4IDogLTE7XG4gICAgICB9XG4gICAgICBpZiAoaXRlbSAhPT0gaXRlbSkge1xuICAgICAgICBpZHggPSBwcmVkaWNhdGVGaW5kKHNsaWNlLmNhbGwoYXJyYXksIGksIGxlbmd0aCksIF8uaXNOYU4pO1xuICAgICAgICByZXR1cm4gaWR4ID49IDAgPyBpZHggKyBpIDogLTE7XG4gICAgICB9XG4gICAgICBmb3IgKGlkeCA9IGRpciA+IDAgPyBpIDogbGVuZ3RoIC0gMTsgaWR4ID49IDAgJiYgaWR4IDwgbGVuZ3RoOyBpZHggKz0gZGlyKSB7XG4gICAgICAgIGlmIChhcnJheVtpZHhdID09PSBpdGVtKSByZXR1cm4gaWR4O1xuICAgICAgfVxuICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gIH1cblxuICAvLyBSZXR1cm4gdGhlIHBvc2l0aW9uIG9mIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGl0ZW0gaW4gYW4gYXJyYXksXG4gIC8vIG9yIC0xIGlmIHRoZSBpdGVtIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGUgYXJyYXkuXG4gIC8vIElmIHRoZSBhcnJheSBpcyBsYXJnZSBhbmQgYWxyZWFkeSBpbiBzb3J0IG9yZGVyLCBwYXNzIGB0cnVlYFxuICAvLyBmb3IgKippc1NvcnRlZCoqIHRvIHVzZSBiaW5hcnkgc2VhcmNoLlxuICBfLmluZGV4T2YgPSBjcmVhdGVJbmRleEZpbmRlcigxLCBfLmZpbmRJbmRleCwgXy5zb3J0ZWRJbmRleCk7XG4gIF8ubGFzdEluZGV4T2YgPSBjcmVhdGVJbmRleEZpbmRlcigtMSwgXy5maW5kTGFzdEluZGV4KTtcblxuICAvLyBHZW5lcmF0ZSBhbiBpbnRlZ2VyIEFycmF5IGNvbnRhaW5pbmcgYW4gYXJpdGhtZXRpYyBwcm9ncmVzc2lvbi4gQSBwb3J0IG9mXG4gIC8vIHRoZSBuYXRpdmUgUHl0aG9uIGByYW5nZSgpYCBmdW5jdGlvbi4gU2VlXG4gIC8vIFt0aGUgUHl0aG9uIGRvY3VtZW50YXRpb25dKGh0dHA6Ly9kb2NzLnB5dGhvbi5vcmcvbGlicmFyeS9mdW5jdGlvbnMuaHRtbCNyYW5nZSkuXG4gIF8ucmFuZ2UgPSBmdW5jdGlvbihzdGFydCwgc3RvcCwgc3RlcCkge1xuICAgIGlmIChzdG9wID09IG51bGwpIHtcbiAgICAgIHN0b3AgPSBzdGFydCB8fCAwO1xuICAgICAgc3RhcnQgPSAwO1xuICAgIH1cbiAgICBzdGVwID0gc3RlcCB8fCAxO1xuXG4gICAgdmFyIGxlbmd0aCA9IE1hdGgubWF4KE1hdGguY2VpbCgoc3RvcCAtIHN0YXJ0KSAvIHN0ZXApLCAwKTtcbiAgICB2YXIgcmFuZ2UgPSBBcnJheShsZW5ndGgpO1xuXG4gICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKywgc3RhcnQgKz0gc3RlcCkge1xuICAgICAgcmFuZ2VbaWR4XSA9IHN0YXJ0O1xuICAgIH1cblxuICAgIHJldHVybiByYW5nZTtcbiAgfTtcblxuICAvLyBGdW5jdGlvbiAoYWhlbSkgRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIERldGVybWluZXMgd2hldGhlciB0byBleGVjdXRlIGEgZnVuY3Rpb24gYXMgYSBjb25zdHJ1Y3RvclxuICAvLyBvciBhIG5vcm1hbCBmdW5jdGlvbiB3aXRoIHRoZSBwcm92aWRlZCBhcmd1bWVudHNcbiAgdmFyIGV4ZWN1dGVCb3VuZCA9IGZ1bmN0aW9uKHNvdXJjZUZ1bmMsIGJvdW5kRnVuYywgY29udGV4dCwgY2FsbGluZ0NvbnRleHQsIGFyZ3MpIHtcbiAgICBpZiAoIShjYWxsaW5nQ29udGV4dCBpbnN0YW5jZW9mIGJvdW5kRnVuYykpIHJldHVybiBzb3VyY2VGdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgIHZhciBzZWxmID0gYmFzZUNyZWF0ZShzb3VyY2VGdW5jLnByb3RvdHlwZSk7XG4gICAgdmFyIHJlc3VsdCA9IHNvdXJjZUZ1bmMuYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgaWYgKF8uaXNPYmplY3QocmVzdWx0KSkgcmV0dXJuIHJlc3VsdDtcbiAgICByZXR1cm4gc2VsZjtcbiAgfTtcblxuICAvLyBDcmVhdGUgYSBmdW5jdGlvbiBib3VuZCB0byBhIGdpdmVuIG9iamVjdCAoYXNzaWduaW5nIGB0aGlzYCwgYW5kIGFyZ3VtZW50cyxcbiAgLy8gb3B0aW9uYWxseSkuIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBGdW5jdGlvbi5iaW5kYCBpZlxuICAvLyBhdmFpbGFibGUuXG4gIF8uYmluZCA9IGZ1bmN0aW9uKGZ1bmMsIGNvbnRleHQpIHtcbiAgICBpZiAobmF0aXZlQmluZCAmJiBmdW5jLmJpbmQgPT09IG5hdGl2ZUJpbmQpIHJldHVybiBuYXRpdmVCaW5kLmFwcGx5KGZ1bmMsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgaWYgKCFfLmlzRnVuY3Rpb24oZnVuYykpIHRocm93IG5ldyBUeXBlRXJyb3IoJ0JpbmQgbXVzdCBiZSBjYWxsZWQgb24gYSBmdW5jdGlvbicpO1xuICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuICAgIHZhciBib3VuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGV4ZWN1dGVCb3VuZChmdW5jLCBib3VuZCwgY29udGV4dCwgdGhpcywgYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7XG4gICAgfTtcbiAgICByZXR1cm4gYm91bmQ7XG4gIH07XG5cbiAgLy8gUGFydGlhbGx5IGFwcGx5IGEgZnVuY3Rpb24gYnkgY3JlYXRpbmcgYSB2ZXJzaW9uIHRoYXQgaGFzIGhhZCBzb21lIG9mIGl0c1xuICAvLyBhcmd1bWVudHMgcHJlLWZpbGxlZCwgd2l0aG91dCBjaGFuZ2luZyBpdHMgZHluYW1pYyBgdGhpc2AgY29udGV4dC4gXyBhY3RzXG4gIC8vIGFzIGEgcGxhY2Vob2xkZXIsIGFsbG93aW5nIGFueSBjb21iaW5hdGlvbiBvZiBhcmd1bWVudHMgdG8gYmUgcHJlLWZpbGxlZC5cbiAgXy5wYXJ0aWFsID0gZnVuY3Rpb24oZnVuYykge1xuICAgIHZhciBib3VuZEFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgdmFyIGJvdW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcG9zaXRpb24gPSAwLCBsZW5ndGggPSBib3VuZEFyZ3MubGVuZ3RoO1xuICAgICAgdmFyIGFyZ3MgPSBBcnJheShsZW5ndGgpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBhcmdzW2ldID0gYm91bmRBcmdzW2ldID09PSBfID8gYXJndW1lbnRzW3Bvc2l0aW9uKytdIDogYm91bmRBcmdzW2ldO1xuICAgICAgfVxuICAgICAgd2hpbGUgKHBvc2l0aW9uIDwgYXJndW1lbnRzLmxlbmd0aCkgYXJncy5wdXNoKGFyZ3VtZW50c1twb3NpdGlvbisrXSk7XG4gICAgICByZXR1cm4gZXhlY3V0ZUJvdW5kKGZ1bmMsIGJvdW5kLCB0aGlzLCB0aGlzLCBhcmdzKTtcbiAgICB9O1xuICAgIHJldHVybiBib3VuZDtcbiAgfTtcblxuICAvLyBCaW5kIGEgbnVtYmVyIG9mIGFuIG9iamVjdCdzIG1ldGhvZHMgdG8gdGhhdCBvYmplY3QuIFJlbWFpbmluZyBhcmd1bWVudHNcbiAgLy8gYXJlIHRoZSBtZXRob2QgbmFtZXMgdG8gYmUgYm91bmQuIFVzZWZ1bCBmb3IgZW5zdXJpbmcgdGhhdCBhbGwgY2FsbGJhY2tzXG4gIC8vIGRlZmluZWQgb24gYW4gb2JqZWN0IGJlbG9uZyB0byBpdC5cbiAgXy5iaW5kQWxsID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIGksIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsIGtleTtcbiAgICBpZiAobGVuZ3RoIDw9IDEpIHRocm93IG5ldyBFcnJvcignYmluZEFsbCBtdXN0IGJlIHBhc3NlZCBmdW5jdGlvbiBuYW1lcycpO1xuICAgIGZvciAoaSA9IDE7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAga2V5ID0gYXJndW1lbnRzW2ldO1xuICAgICAgb2JqW2tleV0gPSBfLmJpbmQob2JqW2tleV0sIG9iaik7XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gTWVtb2l6ZSBhbiBleHBlbnNpdmUgZnVuY3Rpb24gYnkgc3RvcmluZyBpdHMgcmVzdWx0cy5cbiAgXy5tZW1vaXplID0gZnVuY3Rpb24oZnVuYywgaGFzaGVyKSB7XG4gICAgdmFyIG1lbW9pemUgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHZhciBjYWNoZSA9IG1lbW9pemUuY2FjaGU7XG4gICAgICB2YXIgYWRkcmVzcyA9ICcnICsgKGhhc2hlciA/IGhhc2hlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIDoga2V5KTtcbiAgICAgIGlmICghXy5oYXMoY2FjaGUsIGFkZHJlc3MpKSBjYWNoZVthZGRyZXNzXSA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHJldHVybiBjYWNoZVthZGRyZXNzXTtcbiAgICB9O1xuICAgIG1lbW9pemUuY2FjaGUgPSB7fTtcbiAgICByZXR1cm4gbWVtb2l6ZTtcbiAgfTtcblxuICAvLyBEZWxheXMgYSBmdW5jdGlvbiBmb3IgdGhlIGdpdmVuIG51bWJlciBvZiBtaWxsaXNlY29uZHMsIGFuZCB0aGVuIGNhbGxzXG4gIC8vIGl0IHdpdGggdGhlIGFyZ3VtZW50cyBzdXBwbGllZC5cbiAgXy5kZWxheSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQpIHtcbiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcbiAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkobnVsbCwgYXJncyk7XG4gICAgfSwgd2FpdCk7XG4gIH07XG5cbiAgLy8gRGVmZXJzIGEgZnVuY3Rpb24sIHNjaGVkdWxpbmcgaXQgdG8gcnVuIGFmdGVyIHRoZSBjdXJyZW50IGNhbGwgc3RhY2sgaGFzXG4gIC8vIGNsZWFyZWQuXG4gIF8uZGVmZXIgPSBfLnBhcnRpYWwoXy5kZWxheSwgXywgMSk7XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCB3aGVuIGludm9rZWQsIHdpbGwgb25seSBiZSB0cmlnZ2VyZWQgYXQgbW9zdCBvbmNlXG4gIC8vIGR1cmluZyBhIGdpdmVuIHdpbmRvdyBvZiB0aW1lLiBOb3JtYWxseSwgdGhlIHRocm90dGxlZCBmdW5jdGlvbiB3aWxsIHJ1blxuICAvLyBhcyBtdWNoIGFzIGl0IGNhbiwgd2l0aG91dCBldmVyIGdvaW5nIG1vcmUgdGhhbiBvbmNlIHBlciBgd2FpdGAgZHVyYXRpb247XG4gIC8vIGJ1dCBpZiB5b3UnZCBsaWtlIHRvIGRpc2FibGUgdGhlIGV4ZWN1dGlvbiBvbiB0aGUgbGVhZGluZyBlZGdlLCBwYXNzXG4gIC8vIGB7bGVhZGluZzogZmFsc2V9YC4gVG8gZGlzYWJsZSBleGVjdXRpb24gb24gdGhlIHRyYWlsaW5nIGVkZ2UsIGRpdHRvLlxuICBfLnRocm90dGxlID0gZnVuY3Rpb24oZnVuYywgd2FpdCwgb3B0aW9ucykge1xuICAgIHZhciBjb250ZXh0LCBhcmdzLCByZXN1bHQ7XG4gICAgdmFyIHRpbWVvdXQgPSBudWxsO1xuICAgIHZhciBwcmV2aW91cyA9IDA7XG4gICAgaWYgKCFvcHRpb25zKSBvcHRpb25zID0ge307XG4gICAgdmFyIGxhdGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICBwcmV2aW91cyA9IG9wdGlvbnMubGVhZGluZyA9PT0gZmFsc2UgPyAwIDogXy5ub3coKTtcbiAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgIGlmICghdGltZW91dCkgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG5vdyA9IF8ubm93KCk7XG4gICAgICBpZiAoIXByZXZpb3VzICYmIG9wdGlvbnMubGVhZGluZyA9PT0gZmFsc2UpIHByZXZpb3VzID0gbm93O1xuICAgICAgdmFyIHJlbWFpbmluZyA9IHdhaXQgLSAobm93IC0gcHJldmlvdXMpO1xuICAgICAgY29udGV4dCA9IHRoaXM7XG4gICAgICBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgaWYgKHJlbWFpbmluZyA8PSAwIHx8IHJlbWFpbmluZyA+IHdhaXQpIHtcbiAgICAgICAgaWYgKHRpbWVvdXQpIHtcbiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcHJldmlvdXMgPSBub3c7XG4gICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgIGlmICghdGltZW91dCkgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgICAgfSBlbHNlIGlmICghdGltZW91dCAmJiBvcHRpb25zLnRyYWlsaW5nICE9PSBmYWxzZSkge1xuICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgcmVtYWluaW5nKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24sIHRoYXQsIGFzIGxvbmcgYXMgaXQgY29udGludWVzIHRvIGJlIGludm9rZWQsIHdpbGwgbm90XG4gIC8vIGJlIHRyaWdnZXJlZC4gVGhlIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGFmdGVyIGl0IHN0b3BzIGJlaW5nIGNhbGxlZCBmb3JcbiAgLy8gTiBtaWxsaXNlY29uZHMuIElmIGBpbW1lZGlhdGVgIGlzIHBhc3NlZCwgdHJpZ2dlciB0aGUgZnVuY3Rpb24gb24gdGhlXG4gIC8vIGxlYWRpbmcgZWRnZSwgaW5zdGVhZCBvZiB0aGUgdHJhaWxpbmcuXG4gIF8uZGVib3VuY2UgPSBmdW5jdGlvbihmdW5jLCB3YWl0LCBpbW1lZGlhdGUpIHtcbiAgICB2YXIgdGltZW91dCwgYXJncywgY29udGV4dCwgdGltZXN0YW1wLCByZXN1bHQ7XG5cbiAgICB2YXIgbGF0ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBsYXN0ID0gXy5ub3coKSAtIHRpbWVzdGFtcDtcblxuICAgICAgaWYgKGxhc3QgPCB3YWl0ICYmIGxhc3QgPj0gMCkge1xuICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCAtIGxhc3QpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgIGlmICghaW1tZWRpYXRlKSB7XG4gICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICBpZiAoIXRpbWVvdXQpIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBjb250ZXh0ID0gdGhpcztcbiAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICB0aW1lc3RhbXAgPSBfLm5vdygpO1xuICAgICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgICBpZiAoIXRpbWVvdXQpIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTtcbiAgICAgIGlmIChjYWxsTm93KSB7XG4gICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgdGhlIGZpcnN0IGZ1bmN0aW9uIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB0byB0aGUgc2Vjb25kLFxuICAvLyBhbGxvd2luZyB5b3UgdG8gYWRqdXN0IGFyZ3VtZW50cywgcnVuIGNvZGUgYmVmb3JlIGFuZCBhZnRlciwgYW5kXG4gIC8vIGNvbmRpdGlvbmFsbHkgZXhlY3V0ZSB0aGUgb3JpZ2luYWwgZnVuY3Rpb24uXG4gIF8ud3JhcCA9IGZ1bmN0aW9uKGZ1bmMsIHdyYXBwZXIpIHtcbiAgICByZXR1cm4gXy5wYXJ0aWFsKHdyYXBwZXIsIGZ1bmMpO1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBuZWdhdGVkIHZlcnNpb24gb2YgdGhlIHBhc3NlZC1pbiBwcmVkaWNhdGUuXG4gIF8ubmVnYXRlID0gZnVuY3Rpb24ocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICFwcmVkaWNhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGlzIHRoZSBjb21wb3NpdGlvbiBvZiBhIGxpc3Qgb2YgZnVuY3Rpb25zLCBlYWNoXG4gIC8vIGNvbnN1bWluZyB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBmdW5jdGlvbiB0aGF0IGZvbGxvd3MuXG4gIF8uY29tcG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgIHZhciBzdGFydCA9IGFyZ3MubGVuZ3RoIC0gMTtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgaSA9IHN0YXJ0O1xuICAgICAgdmFyIHJlc3VsdCA9IGFyZ3Nbc3RhcnRdLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB3aGlsZSAoaS0tKSByZXN1bHQgPSBhcmdzW2ldLmNhbGwodGhpcywgcmVzdWx0KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aWxsIG9ubHkgYmUgZXhlY3V0ZWQgb24gYW5kIGFmdGVyIHRoZSBOdGggY2FsbC5cbiAgXy5hZnRlciA9IGZ1bmN0aW9uKHRpbWVzLCBmdW5jKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKC0tdGltZXMgPCAxKSB7XG4gICAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aWxsIG9ubHkgYmUgZXhlY3V0ZWQgdXAgdG8gKGJ1dCBub3QgaW5jbHVkaW5nKSB0aGUgTnRoIGNhbGwuXG4gIF8uYmVmb3JlID0gZnVuY3Rpb24odGltZXMsIGZ1bmMpIHtcbiAgICB2YXIgbWVtbztcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoLS10aW1lcyA+IDApIHtcbiAgICAgICAgbWVtbyA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aW1lcyA8PSAxKSBmdW5jID0gbnVsbDtcbiAgICAgIHJldHVybiBtZW1vO1xuICAgIH07XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBleGVjdXRlZCBhdCBtb3N0IG9uZSB0aW1lLCBubyBtYXR0ZXIgaG93XG4gIC8vIG9mdGVuIHlvdSBjYWxsIGl0LiBVc2VmdWwgZm9yIGxhenkgaW5pdGlhbGl6YXRpb24uXG4gIF8ub25jZSA9IF8ucGFydGlhbChfLmJlZm9yZSwgMik7XG5cbiAgLy8gT2JqZWN0IEZ1bmN0aW9uc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gS2V5cyBpbiBJRSA8IDkgdGhhdCB3b24ndCBiZSBpdGVyYXRlZCBieSBgZm9yIGtleSBpbiAuLi5gIGFuZCB0aHVzIG1pc3NlZC5cbiAgdmFyIGhhc0VudW1CdWcgPSAhe3RvU3RyaW5nOiBudWxsfS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgndG9TdHJpbmcnKTtcbiAgdmFyIG5vbkVudW1lcmFibGVQcm9wcyA9IFsndmFsdWVPZicsICdpc1Byb3RvdHlwZU9mJywgJ3RvU3RyaW5nJyxcbiAgICAgICAgICAgICAgICAgICAgICAncHJvcGVydHlJc0VudW1lcmFibGUnLCAnaGFzT3duUHJvcGVydHknLCAndG9Mb2NhbGVTdHJpbmcnXTtcblxuICBmdW5jdGlvbiBjb2xsZWN0Tm9uRW51bVByb3BzKG9iaiwga2V5cykge1xuICAgIHZhciBub25FbnVtSWR4ID0gbm9uRW51bWVyYWJsZVByb3BzLmxlbmd0aDtcbiAgICB2YXIgY29uc3RydWN0b3IgPSBvYmouY29uc3RydWN0b3I7XG4gICAgdmFyIHByb3RvID0gKF8uaXNGdW5jdGlvbihjb25zdHJ1Y3RvcikgJiYgY29uc3RydWN0b3IucHJvdG90eXBlKSB8fCBPYmpQcm90bztcblxuICAgIC8vIENvbnN0cnVjdG9yIGlzIGEgc3BlY2lhbCBjYXNlLlxuICAgIHZhciBwcm9wID0gJ2NvbnN0cnVjdG9yJztcbiAgICBpZiAoXy5oYXMob2JqLCBwcm9wKSAmJiAhXy5jb250YWlucyhrZXlzLCBwcm9wKSkga2V5cy5wdXNoKHByb3ApO1xuXG4gICAgd2hpbGUgKG5vbkVudW1JZHgtLSkge1xuICAgICAgcHJvcCA9IG5vbkVudW1lcmFibGVQcm9wc1tub25FbnVtSWR4XTtcbiAgICAgIGlmIChwcm9wIGluIG9iaiAmJiBvYmpbcHJvcF0gIT09IHByb3RvW3Byb3BdICYmICFfLmNvbnRhaW5zKGtleXMsIHByb3ApKSB7XG4gICAgICAgIGtleXMucHVzaChwcm9wKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBSZXRyaWV2ZSB0aGUgbmFtZXMgb2YgYW4gb2JqZWN0J3Mgb3duIHByb3BlcnRpZXMuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBPYmplY3Qua2V5c2BcbiAgXy5rZXlzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKCFfLmlzT2JqZWN0KG9iaikpIHJldHVybiBbXTtcbiAgICBpZiAobmF0aXZlS2V5cykgcmV0dXJuIG5hdGl2ZUtleXMob2JqKTtcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIGlmIChfLmhhcyhvYmosIGtleSkpIGtleXMucHVzaChrZXkpO1xuICAgIC8vIEFoZW0sIElFIDwgOS5cbiAgICBpZiAoaGFzRW51bUJ1ZykgY29sbGVjdE5vbkVudW1Qcm9wcyhvYmosIGtleXMpO1xuICAgIHJldHVybiBrZXlzO1xuICB9O1xuXG4gIC8vIFJldHJpZXZlIGFsbCB0aGUgcHJvcGVydHkgbmFtZXMgb2YgYW4gb2JqZWN0LlxuICBfLmFsbEtleXMgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIFtdO1xuICAgIHZhciBrZXlzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikga2V5cy5wdXNoKGtleSk7XG4gICAgLy8gQWhlbSwgSUUgPCA5LlxuICAgIGlmIChoYXNFbnVtQnVnKSBjb2xsZWN0Tm9uRW51bVByb3BzKG9iaiwga2V5cyk7XG4gICAgcmV0dXJuIGtleXM7XG4gIH07XG5cbiAgLy8gUmV0cmlldmUgdGhlIHZhbHVlcyBvZiBhbiBvYmplY3QncyBwcm9wZXJ0aWVzLlxuICBfLnZhbHVlcyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7XG4gICAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIHZhciB2YWx1ZXMgPSBBcnJheShsZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhbHVlc1tpXSA9IG9ialtrZXlzW2ldXTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlcztcbiAgfTtcblxuICAvLyBSZXR1cm5zIHRoZSByZXN1bHRzIG9mIGFwcGx5aW5nIHRoZSBpdGVyYXRlZSB0byBlYWNoIGVsZW1lbnQgb2YgdGhlIG9iamVjdFxuICAvLyBJbiBjb250cmFzdCB0byBfLm1hcCBpdCByZXR1cm5zIGFuIG9iamVjdFxuICBfLm1hcE9iamVjdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHtcbiAgICBpdGVyYXRlZSA9IGNiKGl0ZXJhdGVlLCBjb250ZXh0KTtcbiAgICB2YXIga2V5cyA9ICBfLmtleXMob2JqKSxcbiAgICAgICAgICBsZW5ndGggPSBrZXlzLmxlbmd0aCxcbiAgICAgICAgICByZXN1bHRzID0ge30sXG4gICAgICAgICAgY3VycmVudEtleTtcbiAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgY3VycmVudEtleSA9IGtleXNbaW5kZXhdO1xuICAgICAgICByZXN1bHRzW2N1cnJlbnRLZXldID0gaXRlcmF0ZWUob2JqW2N1cnJlbnRLZXldLCBjdXJyZW50S2V5LCBvYmopO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gIH07XG5cbiAgLy8gQ29udmVydCBhbiBvYmplY3QgaW50byBhIGxpc3Qgb2YgYFtrZXksIHZhbHVlXWAgcGFpcnMuXG4gIF8ucGFpcnMgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgIHZhciBsZW5ndGggPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgcGFpcnMgPSBBcnJheShsZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHBhaXJzW2ldID0gW2tleXNbaV0sIG9ialtrZXlzW2ldXV07XG4gICAgfVxuICAgIHJldHVybiBwYWlycztcbiAgfTtcblxuICAvLyBJbnZlcnQgdGhlIGtleXMgYW5kIHZhbHVlcyBvZiBhbiBvYmplY3QuIFRoZSB2YWx1ZXMgbXVzdCBiZSBzZXJpYWxpemFibGUuXG4gIF8uaW52ZXJ0ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGtleXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlc3VsdFtvYmpba2V5c1tpXV1dID0ga2V5c1tpXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBSZXR1cm4gYSBzb3J0ZWQgbGlzdCBvZiB0aGUgZnVuY3Rpb24gbmFtZXMgYXZhaWxhYmxlIG9uIHRoZSBvYmplY3QuXG4gIC8vIEFsaWFzZWQgYXMgYG1ldGhvZHNgXG4gIF8uZnVuY3Rpb25zID0gXy5tZXRob2RzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIG5hbWVzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgaWYgKF8uaXNGdW5jdGlvbihvYmpba2V5XSkpIG5hbWVzLnB1c2goa2V5KTtcbiAgICB9XG4gICAgcmV0dXJuIG5hbWVzLnNvcnQoKTtcbiAgfTtcblxuICAvLyBFeHRlbmQgYSBnaXZlbiBvYmplY3Qgd2l0aCBhbGwgdGhlIHByb3BlcnRpZXMgaW4gcGFzc2VkLWluIG9iamVjdChzKS5cbiAgXy5leHRlbmQgPSBjcmVhdGVBc3NpZ25lcihfLmFsbEtleXMpO1xuXG4gIC8vIEFzc2lnbnMgYSBnaXZlbiBvYmplY3Qgd2l0aCBhbGwgdGhlIG93biBwcm9wZXJ0aWVzIGluIHRoZSBwYXNzZWQtaW4gb2JqZWN0KHMpXG4gIC8vIChodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3QvYXNzaWduKVxuICBfLmV4dGVuZE93biA9IF8uYXNzaWduID0gY3JlYXRlQXNzaWduZXIoXy5rZXlzKTtcblxuICAvLyBSZXR1cm5zIHRoZSBmaXJzdCBrZXkgb24gYW4gb2JqZWN0IHRoYXQgcGFzc2VzIGEgcHJlZGljYXRlIHRlc3RcbiAgXy5maW5kS2V5ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaiksIGtleTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAga2V5ID0ga2V5c1tpXTtcbiAgICAgIGlmIChwcmVkaWNhdGUob2JqW2tleV0sIGtleSwgb2JqKSkgcmV0dXJuIGtleTtcbiAgICB9XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgY29weSBvZiB0aGUgb2JqZWN0IG9ubHkgY29udGFpbmluZyB0aGUgd2hpdGVsaXN0ZWQgcHJvcGVydGllcy5cbiAgXy5waWNrID0gZnVuY3Rpb24ob2JqZWN0LCBvaXRlcmF0ZWUsIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0ID0ge30sIG9iaiA9IG9iamVjdCwgaXRlcmF0ZWUsIGtleXM7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0O1xuICAgIGlmIChfLmlzRnVuY3Rpb24ob2l0ZXJhdGVlKSkge1xuICAgICAga2V5cyA9IF8uYWxsS2V5cyhvYmopO1xuICAgICAgaXRlcmF0ZWUgPSBvcHRpbWl6ZUNiKG9pdGVyYXRlZSwgY29udGV4dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGtleXMgPSBmbGF0dGVuKGFyZ3VtZW50cywgZmFsc2UsIGZhbHNlLCAxKTtcbiAgICAgIGl0ZXJhdGVlID0gZnVuY3Rpb24odmFsdWUsIGtleSwgb2JqKSB7IHJldHVybiBrZXkgaW4gb2JqOyB9O1xuICAgICAgb2JqID0gT2JqZWN0KG9iaik7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICAgIHZhciB2YWx1ZSA9IG9ialtrZXldO1xuICAgICAgaWYgKGl0ZXJhdGVlKHZhbHVlLCBrZXksIG9iaikpIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgIC8vIFJldHVybiBhIGNvcHkgb2YgdGhlIG9iamVjdCB3aXRob3V0IHRoZSBibGFja2xpc3RlZCBwcm9wZXJ0aWVzLlxuICBfLm9taXQgPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgaWYgKF8uaXNGdW5jdGlvbihpdGVyYXRlZSkpIHtcbiAgICAgIGl0ZXJhdGVlID0gXy5uZWdhdGUoaXRlcmF0ZWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIga2V5cyA9IF8ubWFwKGZsYXR0ZW4oYXJndW1lbnRzLCBmYWxzZSwgZmFsc2UsIDEpLCBTdHJpbmcpO1xuICAgICAgaXRlcmF0ZWUgPSBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgIHJldHVybiAhXy5jb250YWlucyhrZXlzLCBrZXkpO1xuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIF8ucGljayhvYmosIGl0ZXJhdGVlLCBjb250ZXh0KTtcbiAgfTtcblxuICAvLyBGaWxsIGluIGEgZ2l2ZW4gb2JqZWN0IHdpdGggZGVmYXVsdCBwcm9wZXJ0aWVzLlxuICBfLmRlZmF1bHRzID0gY3JlYXRlQXNzaWduZXIoXy5hbGxLZXlzLCB0cnVlKTtcblxuICAvLyBDcmVhdGVzIGFuIG9iamVjdCB0aGF0IGluaGVyaXRzIGZyb20gdGhlIGdpdmVuIHByb3RvdHlwZSBvYmplY3QuXG4gIC8vIElmIGFkZGl0aW9uYWwgcHJvcGVydGllcyBhcmUgcHJvdmlkZWQgdGhlbiB0aGV5IHdpbGwgYmUgYWRkZWQgdG8gdGhlXG4gIC8vIGNyZWF0ZWQgb2JqZWN0LlxuICBfLmNyZWF0ZSA9IGZ1bmN0aW9uKHByb3RvdHlwZSwgcHJvcHMpIHtcbiAgICB2YXIgcmVzdWx0ID0gYmFzZUNyZWF0ZShwcm90b3R5cGUpO1xuICAgIGlmIChwcm9wcykgXy5leHRlbmRPd24ocmVzdWx0LCBwcm9wcyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBDcmVhdGUgYSAoc2hhbGxvdy1jbG9uZWQpIGR1cGxpY2F0ZSBvZiBhbiBvYmplY3QuXG4gIF8uY2xvbmUgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIG9iajtcbiAgICByZXR1cm4gXy5pc0FycmF5KG9iaikgPyBvYmouc2xpY2UoKSA6IF8uZXh0ZW5kKHt9LCBvYmopO1xuICB9O1xuXG4gIC8vIEludm9rZXMgaW50ZXJjZXB0b3Igd2l0aCB0aGUgb2JqLCBhbmQgdGhlbiByZXR1cm5zIG9iai5cbiAgLy8gVGhlIHByaW1hcnkgcHVycG9zZSBvZiB0aGlzIG1ldGhvZCBpcyB0byBcInRhcCBpbnRvXCIgYSBtZXRob2QgY2hhaW4sIGluXG4gIC8vIG9yZGVyIHRvIHBlcmZvcm0gb3BlcmF0aW9ucyBvbiBpbnRlcm1lZGlhdGUgcmVzdWx0cyB3aXRoaW4gdGhlIGNoYWluLlxuICBfLnRhcCA9IGZ1bmN0aW9uKG9iaiwgaW50ZXJjZXB0b3IpIHtcbiAgICBpbnRlcmNlcHRvcihvYmopO1xuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gUmV0dXJucyB3aGV0aGVyIGFuIG9iamVjdCBoYXMgYSBnaXZlbiBzZXQgb2YgYGtleTp2YWx1ZWAgcGFpcnMuXG4gIF8uaXNNYXRjaCA9IGZ1bmN0aW9uKG9iamVjdCwgYXR0cnMpIHtcbiAgICB2YXIga2V5cyA9IF8ua2V5cyhhdHRycyksIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIGlmIChvYmplY3QgPT0gbnVsbCkgcmV0dXJuICFsZW5ndGg7XG4gICAgdmFyIG9iaiA9IE9iamVjdChvYmplY3QpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBrZXkgPSBrZXlzW2ldO1xuICAgICAgaWYgKGF0dHJzW2tleV0gIT09IG9ialtrZXldIHx8ICEoa2V5IGluIG9iaikpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cblxuICAvLyBJbnRlcm5hbCByZWN1cnNpdmUgY29tcGFyaXNvbiBmdW5jdGlvbiBmb3IgYGlzRXF1YWxgLlxuICB2YXIgZXEgPSBmdW5jdGlvbihhLCBiLCBhU3RhY2ssIGJTdGFjaykge1xuICAgIC8vIElkZW50aWNhbCBvYmplY3RzIGFyZSBlcXVhbC4gYDAgPT09IC0wYCwgYnV0IHRoZXkgYXJlbid0IGlkZW50aWNhbC5cbiAgICAvLyBTZWUgdGhlIFtIYXJtb255IGBlZ2FsYCBwcm9wb3NhbF0oaHR0cDovL3dpa2kuZWNtYXNjcmlwdC5vcmcvZG9rdS5waHA/aWQ9aGFybW9ueTplZ2FsKS5cbiAgICBpZiAoYSA9PT0gYikgcmV0dXJuIGEgIT09IDAgfHwgMSAvIGEgPT09IDEgLyBiO1xuICAgIC8vIEEgc3RyaWN0IGNvbXBhcmlzb24gaXMgbmVjZXNzYXJ5IGJlY2F1c2UgYG51bGwgPT0gdW5kZWZpbmVkYC5cbiAgICBpZiAoYSA9PSBudWxsIHx8IGIgPT0gbnVsbCkgcmV0dXJuIGEgPT09IGI7XG4gICAgLy8gVW53cmFwIGFueSB3cmFwcGVkIG9iamVjdHMuXG4gICAgaWYgKGEgaW5zdGFuY2VvZiBfKSBhID0gYS5fd3JhcHBlZDtcbiAgICBpZiAoYiBpbnN0YW5jZW9mIF8pIGIgPSBiLl93cmFwcGVkO1xuICAgIC8vIENvbXBhcmUgYFtbQ2xhc3NdXWAgbmFtZXMuXG4gICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwoYSk7XG4gICAgaWYgKGNsYXNzTmFtZSAhPT0gdG9TdHJpbmcuY2FsbChiKSkgcmV0dXJuIGZhbHNlO1xuICAgIHN3aXRjaCAoY2xhc3NOYW1lKSB7XG4gICAgICAvLyBTdHJpbmdzLCBudW1iZXJzLCByZWd1bGFyIGV4cHJlc3Npb25zLCBkYXRlcywgYW5kIGJvb2xlYW5zIGFyZSBjb21wYXJlZCBieSB2YWx1ZS5cbiAgICAgIGNhc2UgJ1tvYmplY3QgUmVnRXhwXSc6XG4gICAgICAvLyBSZWdFeHBzIGFyZSBjb2VyY2VkIHRvIHN0cmluZ3MgZm9yIGNvbXBhcmlzb24gKE5vdGU6ICcnICsgL2EvaSA9PT0gJy9hL2knKVxuICAgICAgY2FzZSAnW29iamVjdCBTdHJpbmddJzpcbiAgICAgICAgLy8gUHJpbWl0aXZlcyBhbmQgdGhlaXIgY29ycmVzcG9uZGluZyBvYmplY3Qgd3JhcHBlcnMgYXJlIGVxdWl2YWxlbnQ7IHRodXMsIGBcIjVcImAgaXNcbiAgICAgICAgLy8gZXF1aXZhbGVudCB0byBgbmV3IFN0cmluZyhcIjVcIilgLlxuICAgICAgICByZXR1cm4gJycgKyBhID09PSAnJyArIGI7XG4gICAgICBjYXNlICdbb2JqZWN0IE51bWJlcl0nOlxuICAgICAgICAvLyBgTmFOYHMgYXJlIGVxdWl2YWxlbnQsIGJ1dCBub24tcmVmbGV4aXZlLlxuICAgICAgICAvLyBPYmplY3QoTmFOKSBpcyBlcXVpdmFsZW50IHRvIE5hTlxuICAgICAgICBpZiAoK2EgIT09ICthKSByZXR1cm4gK2IgIT09ICtiO1xuICAgICAgICAvLyBBbiBgZWdhbGAgY29tcGFyaXNvbiBpcyBwZXJmb3JtZWQgZm9yIG90aGVyIG51bWVyaWMgdmFsdWVzLlxuICAgICAgICByZXR1cm4gK2EgPT09IDAgPyAxIC8gK2EgPT09IDEgLyBiIDogK2EgPT09ICtiO1xuICAgICAgY2FzZSAnW29iamVjdCBEYXRlXSc6XG4gICAgICBjYXNlICdbb2JqZWN0IEJvb2xlYW5dJzpcbiAgICAgICAgLy8gQ29lcmNlIGRhdGVzIGFuZCBib29sZWFucyB0byBudW1lcmljIHByaW1pdGl2ZSB2YWx1ZXMuIERhdGVzIGFyZSBjb21wYXJlZCBieSB0aGVpclxuICAgICAgICAvLyBtaWxsaXNlY29uZCByZXByZXNlbnRhdGlvbnMuIE5vdGUgdGhhdCBpbnZhbGlkIGRhdGVzIHdpdGggbWlsbGlzZWNvbmQgcmVwcmVzZW50YXRpb25zXG4gICAgICAgIC8vIG9mIGBOYU5gIGFyZSBub3QgZXF1aXZhbGVudC5cbiAgICAgICAgcmV0dXJuICthID09PSArYjtcbiAgICB9XG5cbiAgICB2YXIgYXJlQXJyYXlzID0gY2xhc3NOYW1lID09PSAnW29iamVjdCBBcnJheV0nO1xuICAgIGlmICghYXJlQXJyYXlzKSB7XG4gICAgICBpZiAodHlwZW9mIGEgIT0gJ29iamVjdCcgfHwgdHlwZW9mIGIgIT0gJ29iamVjdCcpIHJldHVybiBmYWxzZTtcblxuICAgICAgLy8gT2JqZWN0cyB3aXRoIGRpZmZlcmVudCBjb25zdHJ1Y3RvcnMgYXJlIG5vdCBlcXVpdmFsZW50LCBidXQgYE9iamVjdGBzIG9yIGBBcnJheWBzXG4gICAgICAvLyBmcm9tIGRpZmZlcmVudCBmcmFtZXMgYXJlLlxuICAgICAgdmFyIGFDdG9yID0gYS5jb25zdHJ1Y3RvciwgYkN0b3IgPSBiLmNvbnN0cnVjdG9yO1xuICAgICAgaWYgKGFDdG9yICE9PSBiQ3RvciAmJiAhKF8uaXNGdW5jdGlvbihhQ3RvcikgJiYgYUN0b3IgaW5zdGFuY2VvZiBhQ3RvciAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uaXNGdW5jdGlvbihiQ3RvcikgJiYgYkN0b3IgaW5zdGFuY2VvZiBiQ3RvcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgKCdjb25zdHJ1Y3RvcicgaW4gYSAmJiAnY29uc3RydWN0b3InIGluIGIpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gQXNzdW1lIGVxdWFsaXR5IGZvciBjeWNsaWMgc3RydWN0dXJlcy4gVGhlIGFsZ29yaXRobSBmb3IgZGV0ZWN0aW5nIGN5Y2xpY1xuICAgIC8vIHN0cnVjdHVyZXMgaXMgYWRhcHRlZCBmcm9tIEVTIDUuMSBzZWN0aW9uIDE1LjEyLjMsIGFic3RyYWN0IG9wZXJhdGlvbiBgSk9gLlxuXG4gICAgLy8gSW5pdGlhbGl6aW5nIHN0YWNrIG9mIHRyYXZlcnNlZCBvYmplY3RzLlxuICAgIC8vIEl0J3MgZG9uZSBoZXJlIHNpbmNlIHdlIG9ubHkgbmVlZCB0aGVtIGZvciBvYmplY3RzIGFuZCBhcnJheXMgY29tcGFyaXNvbi5cbiAgICBhU3RhY2sgPSBhU3RhY2sgfHwgW107XG4gICAgYlN0YWNrID0gYlN0YWNrIHx8IFtdO1xuICAgIHZhciBsZW5ndGggPSBhU3RhY2subGVuZ3RoO1xuICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgLy8gTGluZWFyIHNlYXJjaC4gUGVyZm9ybWFuY2UgaXMgaW52ZXJzZWx5IHByb3BvcnRpb25hbCB0byB0aGUgbnVtYmVyIG9mXG4gICAgICAvLyB1bmlxdWUgbmVzdGVkIHN0cnVjdHVyZXMuXG4gICAgICBpZiAoYVN0YWNrW2xlbmd0aF0gPT09IGEpIHJldHVybiBiU3RhY2tbbGVuZ3RoXSA9PT0gYjtcbiAgICB9XG5cbiAgICAvLyBBZGQgdGhlIGZpcnN0IG9iamVjdCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuXG4gICAgYVN0YWNrLnB1c2goYSk7XG4gICAgYlN0YWNrLnB1c2goYik7XG5cbiAgICAvLyBSZWN1cnNpdmVseSBjb21wYXJlIG9iamVjdHMgYW5kIGFycmF5cy5cbiAgICBpZiAoYXJlQXJyYXlzKSB7XG4gICAgICAvLyBDb21wYXJlIGFycmF5IGxlbmd0aHMgdG8gZGV0ZXJtaW5lIGlmIGEgZGVlcCBjb21wYXJpc29uIGlzIG5lY2Vzc2FyeS5cbiAgICAgIGxlbmd0aCA9IGEubGVuZ3RoO1xuICAgICAgaWYgKGxlbmd0aCAhPT0gYi5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgICAgIC8vIERlZXAgY29tcGFyZSB0aGUgY29udGVudHMsIGlnbm9yaW5nIG5vbi1udW1lcmljIHByb3BlcnRpZXMuXG4gICAgICB3aGlsZSAobGVuZ3RoLS0pIHtcbiAgICAgICAgaWYgKCFlcShhW2xlbmd0aF0sIGJbbGVuZ3RoXSwgYVN0YWNrLCBiU3RhY2spKSByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIERlZXAgY29tcGFyZSBvYmplY3RzLlxuICAgICAgdmFyIGtleXMgPSBfLmtleXMoYSksIGtleTtcbiAgICAgIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgICAgLy8gRW5zdXJlIHRoYXQgYm90aCBvYmplY3RzIGNvbnRhaW4gdGhlIHNhbWUgbnVtYmVyIG9mIHByb3BlcnRpZXMgYmVmb3JlIGNvbXBhcmluZyBkZWVwIGVxdWFsaXR5LlxuICAgICAgaWYgKF8ua2V5cyhiKS5sZW5ndGggIT09IGxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgIC8vIERlZXAgY29tcGFyZSBlYWNoIG1lbWJlclxuICAgICAgICBrZXkgPSBrZXlzW2xlbmd0aF07XG4gICAgICAgIGlmICghKF8uaGFzKGIsIGtleSkgJiYgZXEoYVtrZXldLCBiW2tleV0sIGFTdGFjaywgYlN0YWNrKSkpIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gUmVtb3ZlIHRoZSBmaXJzdCBvYmplY3QgZnJvbSB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuXG4gICAgYVN0YWNrLnBvcCgpO1xuICAgIGJTdGFjay5wb3AoKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICAvLyBQZXJmb3JtIGEgZGVlcCBjb21wYXJpc29uIHRvIGNoZWNrIGlmIHR3byBvYmplY3RzIGFyZSBlcXVhbC5cbiAgXy5pc0VxdWFsID0gZnVuY3Rpb24oYSwgYikge1xuICAgIHJldHVybiBlcShhLCBiKTtcbiAgfTtcblxuICAvLyBJcyBhIGdpdmVuIGFycmF5LCBzdHJpbmcsIG9yIG9iamVjdCBlbXB0eT9cbiAgLy8gQW4gXCJlbXB0eVwiIG9iamVjdCBoYXMgbm8gZW51bWVyYWJsZSBvd24tcHJvcGVydGllcy5cbiAgXy5pc0VtcHR5ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gdHJ1ZTtcbiAgICBpZiAoaXNBcnJheUxpa2Uob2JqKSAmJiAoXy5pc0FycmF5KG9iaikgfHwgXy5pc1N0cmluZyhvYmopIHx8IF8uaXNBcmd1bWVudHMob2JqKSkpIHJldHVybiBvYmoubGVuZ3RoID09PSAwO1xuICAgIHJldHVybiBfLmtleXMob2JqKS5sZW5ndGggPT09IDA7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIERPTSBlbGVtZW50P1xuICBfLmlzRWxlbWVudCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiAhIShvYmogJiYgb2JqLm5vZGVUeXBlID09PSAxKTtcbiAgfTtcblxuICAvLyBJcyBhIGdpdmVuIHZhbHVlIGFuIGFycmF5P1xuICAvLyBEZWxlZ2F0ZXMgdG8gRUNNQTUncyBuYXRpdmUgQXJyYXkuaXNBcnJheVxuICBfLmlzQXJyYXkgPSBuYXRpdmVJc0FycmF5IHx8IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XSc7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YXJpYWJsZSBhbiBvYmplY3Q/XG4gIF8uaXNPYmplY3QgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIgdHlwZSA9IHR5cGVvZiBvYmo7XG4gICAgcmV0dXJuIHR5cGUgPT09ICdmdW5jdGlvbicgfHwgdHlwZSA9PT0gJ29iamVjdCcgJiYgISFvYmo7XG4gIH07XG5cbiAgLy8gQWRkIHNvbWUgaXNUeXBlIG1ldGhvZHM6IGlzQXJndW1lbnRzLCBpc0Z1bmN0aW9uLCBpc1N0cmluZywgaXNOdW1iZXIsIGlzRGF0ZSwgaXNSZWdFeHAsIGlzRXJyb3IuXG4gIF8uZWFjaChbJ0FyZ3VtZW50cycsICdGdW5jdGlvbicsICdTdHJpbmcnLCAnTnVtYmVyJywgJ0RhdGUnLCAnUmVnRXhwJywgJ0Vycm9yJ10sIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBfWydpcycgKyBuYW1lXSA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgJyArIG5hbWUgKyAnXSc7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gRGVmaW5lIGEgZmFsbGJhY2sgdmVyc2lvbiBvZiB0aGUgbWV0aG9kIGluIGJyb3dzZXJzIChhaGVtLCBJRSA8IDkpLCB3aGVyZVxuICAvLyB0aGVyZSBpc24ndCBhbnkgaW5zcGVjdGFibGUgXCJBcmd1bWVudHNcIiB0eXBlLlxuICBpZiAoIV8uaXNBcmd1bWVudHMoYXJndW1lbnRzKSkge1xuICAgIF8uaXNBcmd1bWVudHMgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgIHJldHVybiBfLmhhcyhvYmosICdjYWxsZWUnKTtcbiAgICB9O1xuICB9XG5cbiAgLy8gT3B0aW1pemUgYGlzRnVuY3Rpb25gIGlmIGFwcHJvcHJpYXRlLiBXb3JrIGFyb3VuZCBzb21lIHR5cGVvZiBidWdzIGluIG9sZCB2OCxcbiAgLy8gSUUgMTEgKCMxNjIxKSwgYW5kIGluIFNhZmFyaSA4ICgjMTkyOSkuXG4gIGlmICh0eXBlb2YgLy4vICE9ICdmdW5jdGlvbicgJiYgdHlwZW9mIEludDhBcnJheSAhPSAnb2JqZWN0Jykge1xuICAgIF8uaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIHR5cGVvZiBvYmogPT0gJ2Z1bmN0aW9uJyB8fCBmYWxzZTtcbiAgICB9O1xuICB9XG5cbiAgLy8gSXMgYSBnaXZlbiBvYmplY3QgYSBmaW5pdGUgbnVtYmVyP1xuICBfLmlzRmluaXRlID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIGlzRmluaXRlKG9iaikgJiYgIWlzTmFOKHBhcnNlRmxvYXQob2JqKSk7XG4gIH07XG5cbiAgLy8gSXMgdGhlIGdpdmVuIHZhbHVlIGBOYU5gPyAoTmFOIGlzIHRoZSBvbmx5IG51bWJlciB3aGljaCBkb2VzIG5vdCBlcXVhbCBpdHNlbGYpLlxuICBfLmlzTmFOID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIF8uaXNOdW1iZXIob2JqKSAmJiBvYmogIT09ICtvYmo7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIGJvb2xlYW4/XG4gIF8uaXNCb29sZWFuID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gdHJ1ZSB8fCBvYmogPT09IGZhbHNlIHx8IHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgQm9vbGVhbl0nO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFsdWUgZXF1YWwgdG8gbnVsbD9cbiAgXy5pc051bGwgPSBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSBudWxsO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFyaWFibGUgdW5kZWZpbmVkP1xuICBfLmlzVW5kZWZpbmVkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gdm9pZCAwO1xuICB9O1xuXG4gIC8vIFNob3J0Y3V0IGZ1bmN0aW9uIGZvciBjaGVja2luZyBpZiBhbiBvYmplY3QgaGFzIGEgZ2l2ZW4gcHJvcGVydHkgZGlyZWN0bHlcbiAgLy8gb24gaXRzZWxmIChpbiBvdGhlciB3b3Jkcywgbm90IG9uIGEgcHJvdG90eXBlKS5cbiAgXy5oYXMgPSBmdW5jdGlvbihvYmosIGtleSkge1xuICAgIHJldHVybiBvYmogIT0gbnVsbCAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcbiAgfTtcblxuICAvLyBVdGlsaXR5IEZ1bmN0aW9uc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIFJ1biBVbmRlcnNjb3JlLmpzIGluICpub0NvbmZsaWN0KiBtb2RlLCByZXR1cm5pbmcgdGhlIGBfYCB2YXJpYWJsZSB0byBpdHNcbiAgLy8gcHJldmlvdXMgb3duZXIuIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIFVuZGVyc2NvcmUgb2JqZWN0LlxuICBfLm5vQ29uZmxpY3QgPSBmdW5jdGlvbigpIHtcbiAgICByb290Ll8gPSBwcmV2aW91c1VuZGVyc2NvcmU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLy8gS2VlcCB0aGUgaWRlbnRpdHkgZnVuY3Rpb24gYXJvdW5kIGZvciBkZWZhdWx0IGl0ZXJhdGVlcy5cbiAgXy5pZGVudGl0eSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9O1xuXG4gIC8vIFByZWRpY2F0ZS1nZW5lcmF0aW5nIGZ1bmN0aW9ucy4gT2Z0ZW4gdXNlZnVsIG91dHNpZGUgb2YgVW5kZXJzY29yZS5cbiAgXy5jb25zdGFudCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH07XG4gIH07XG5cbiAgXy5ub29wID0gZnVuY3Rpb24oKXt9O1xuXG4gIF8ucHJvcGVydHkgPSBwcm9wZXJ0eTtcblxuICAvLyBHZW5lcmF0ZXMgYSBmdW5jdGlvbiBmb3IgYSBnaXZlbiBvYmplY3QgdGhhdCByZXR1cm5zIGEgZ2l2ZW4gcHJvcGVydHkuXG4gIF8ucHJvcGVydHlPZiA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiBvYmogPT0gbnVsbCA/IGZ1bmN0aW9uKCl7fSA6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIG9ialtrZXldO1xuICAgIH07XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIHByZWRpY2F0ZSBmb3IgY2hlY2tpbmcgd2hldGhlciBhbiBvYmplY3QgaGFzIGEgZ2l2ZW4gc2V0IG9mXG4gIC8vIGBrZXk6dmFsdWVgIHBhaXJzLlxuICBfLm1hdGNoZXIgPSBfLm1hdGNoZXMgPSBmdW5jdGlvbihhdHRycykge1xuICAgIGF0dHJzID0gXy5leHRlbmRPd24oe30sIGF0dHJzKTtcbiAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gXy5pc01hdGNoKG9iaiwgYXR0cnMpO1xuICAgIH07XG4gIH07XG5cbiAgLy8gUnVuIGEgZnVuY3Rpb24gKipuKiogdGltZXMuXG4gIF8udGltZXMgPSBmdW5jdGlvbihuLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgIHZhciBhY2N1bSA9IEFycmF5KE1hdGgubWF4KDAsIG4pKTtcbiAgICBpdGVyYXRlZSA9IG9wdGltaXplQ2IoaXRlcmF0ZWUsIGNvbnRleHQsIDEpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSBhY2N1bVtpXSA9IGl0ZXJhdGVlKGkpO1xuICAgIHJldHVybiBhY2N1bTtcbiAgfTtcblxuICAvLyBSZXR1cm4gYSByYW5kb20gaW50ZWdlciBiZXR3ZWVuIG1pbiBhbmQgbWF4IChpbmNsdXNpdmUpLlxuICBfLnJhbmRvbSA9IGZ1bmN0aW9uKG1pbiwgbWF4KSB7XG4gICAgaWYgKG1heCA9PSBudWxsKSB7XG4gICAgICBtYXggPSBtaW47XG4gICAgICBtaW4gPSAwO1xuICAgIH1cbiAgICByZXR1cm4gbWluICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKTtcbiAgfTtcblxuICAvLyBBIChwb3NzaWJseSBmYXN0ZXIpIHdheSB0byBnZXQgdGhlIGN1cnJlbnQgdGltZXN0YW1wIGFzIGFuIGludGVnZXIuXG4gIF8ubm93ID0gRGF0ZS5ub3cgfHwgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICB9O1xuXG4gICAvLyBMaXN0IG9mIEhUTUwgZW50aXRpZXMgZm9yIGVzY2FwaW5nLlxuICB2YXIgZXNjYXBlTWFwID0ge1xuICAgICcmJzogJyZhbXA7JyxcbiAgICAnPCc6ICcmbHQ7JyxcbiAgICAnPic6ICcmZ3Q7JyxcbiAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICBcIidcIjogJyYjeDI3OycsXG4gICAgJ2AnOiAnJiN4NjA7J1xuICB9O1xuICB2YXIgdW5lc2NhcGVNYXAgPSBfLmludmVydChlc2NhcGVNYXApO1xuXG4gIC8vIEZ1bmN0aW9ucyBmb3IgZXNjYXBpbmcgYW5kIHVuZXNjYXBpbmcgc3RyaW5ncyB0by9mcm9tIEhUTUwgaW50ZXJwb2xhdGlvbi5cbiAgdmFyIGNyZWF0ZUVzY2FwZXIgPSBmdW5jdGlvbihtYXApIHtcbiAgICB2YXIgZXNjYXBlciA9IGZ1bmN0aW9uKG1hdGNoKSB7XG4gICAgICByZXR1cm4gbWFwW21hdGNoXTtcbiAgICB9O1xuICAgIC8vIFJlZ2V4ZXMgZm9yIGlkZW50aWZ5aW5nIGEga2V5IHRoYXQgbmVlZHMgdG8gYmUgZXNjYXBlZFxuICAgIHZhciBzb3VyY2UgPSAnKD86JyArIF8ua2V5cyhtYXApLmpvaW4oJ3wnKSArICcpJztcbiAgICB2YXIgdGVzdFJlZ2V4cCA9IFJlZ0V4cChzb3VyY2UpO1xuICAgIHZhciByZXBsYWNlUmVnZXhwID0gUmVnRXhwKHNvdXJjZSwgJ2cnKTtcbiAgICByZXR1cm4gZnVuY3Rpb24oc3RyaW5nKSB7XG4gICAgICBzdHJpbmcgPSBzdHJpbmcgPT0gbnVsbCA/ICcnIDogJycgKyBzdHJpbmc7XG4gICAgICByZXR1cm4gdGVzdFJlZ2V4cC50ZXN0KHN0cmluZykgPyBzdHJpbmcucmVwbGFjZShyZXBsYWNlUmVnZXhwLCBlc2NhcGVyKSA6IHN0cmluZztcbiAgICB9O1xuICB9O1xuICBfLmVzY2FwZSA9IGNyZWF0ZUVzY2FwZXIoZXNjYXBlTWFwKTtcbiAgXy51bmVzY2FwZSA9IGNyZWF0ZUVzY2FwZXIodW5lc2NhcGVNYXApO1xuXG4gIC8vIElmIHRoZSB2YWx1ZSBvZiB0aGUgbmFtZWQgYHByb3BlcnR5YCBpcyBhIGZ1bmN0aW9uIHRoZW4gaW52b2tlIGl0IHdpdGggdGhlXG4gIC8vIGBvYmplY3RgIGFzIGNvbnRleHQ7IG90aGVyd2lzZSwgcmV0dXJuIGl0LlxuICBfLnJlc3VsdCA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHksIGZhbGxiYWNrKSB7XG4gICAgdmFyIHZhbHVlID0gb2JqZWN0ID09IG51bGwgPyB2b2lkIDAgOiBvYmplY3RbcHJvcGVydHldO1xuICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwKSB7XG4gICAgICB2YWx1ZSA9IGZhbGxiYWNrO1xuICAgIH1cbiAgICByZXR1cm4gXy5pc0Z1bmN0aW9uKHZhbHVlKSA/IHZhbHVlLmNhbGwob2JqZWN0KSA6IHZhbHVlO1xuICB9O1xuXG4gIC8vIEdlbmVyYXRlIGEgdW5pcXVlIGludGVnZXIgaWQgKHVuaXF1ZSB3aXRoaW4gdGhlIGVudGlyZSBjbGllbnQgc2Vzc2lvbikuXG4gIC8vIFVzZWZ1bCBmb3IgdGVtcG9yYXJ5IERPTSBpZHMuXG4gIHZhciBpZENvdW50ZXIgPSAwO1xuICBfLnVuaXF1ZUlkID0gZnVuY3Rpb24ocHJlZml4KSB7XG4gICAgdmFyIGlkID0gKytpZENvdW50ZXIgKyAnJztcbiAgICByZXR1cm4gcHJlZml4ID8gcHJlZml4ICsgaWQgOiBpZDtcbiAgfTtcblxuICAvLyBCeSBkZWZhdWx0LCBVbmRlcnNjb3JlIHVzZXMgRVJCLXN0eWxlIHRlbXBsYXRlIGRlbGltaXRlcnMsIGNoYW5nZSB0aGVcbiAgLy8gZm9sbG93aW5nIHRlbXBsYXRlIHNldHRpbmdzIHRvIHVzZSBhbHRlcm5hdGl2ZSBkZWxpbWl0ZXJzLlxuICBfLnRlbXBsYXRlU2V0dGluZ3MgPSB7XG4gICAgZXZhbHVhdGUgICAgOiAvPCUoW1xcc1xcU10rPyklPi9nLFxuICAgIGludGVycG9sYXRlIDogLzwlPShbXFxzXFxTXSs/KSU+L2csXG4gICAgZXNjYXBlICAgICAgOiAvPCUtKFtcXHNcXFNdKz8pJT4vZ1xuICB9O1xuXG4gIC8vIFdoZW4gY3VzdG9taXppbmcgYHRlbXBsYXRlU2V0dGluZ3NgLCBpZiB5b3UgZG9uJ3Qgd2FudCB0byBkZWZpbmUgYW5cbiAgLy8gaW50ZXJwb2xhdGlvbiwgZXZhbHVhdGlvbiBvciBlc2NhcGluZyByZWdleCwgd2UgbmVlZCBvbmUgdGhhdCBpc1xuICAvLyBndWFyYW50ZWVkIG5vdCB0byBtYXRjaC5cbiAgdmFyIG5vTWF0Y2ggPSAvKC4pXi87XG5cbiAgLy8gQ2VydGFpbiBjaGFyYWN0ZXJzIG5lZWQgdG8gYmUgZXNjYXBlZCBzbyB0aGF0IHRoZXkgY2FuIGJlIHB1dCBpbnRvIGFcbiAgLy8gc3RyaW5nIGxpdGVyYWwuXG4gIHZhciBlc2NhcGVzID0ge1xuICAgIFwiJ1wiOiAgICAgIFwiJ1wiLFxuICAgICdcXFxcJzogICAgICdcXFxcJyxcbiAgICAnXFxyJzogICAgICdyJyxcbiAgICAnXFxuJzogICAgICduJyxcbiAgICAnXFx1MjAyOCc6ICd1MjAyOCcsXG4gICAgJ1xcdTIwMjknOiAndTIwMjknXG4gIH07XG5cbiAgdmFyIGVzY2FwZXIgPSAvXFxcXHwnfFxccnxcXG58XFx1MjAyOHxcXHUyMDI5L2c7XG5cbiAgdmFyIGVzY2FwZUNoYXIgPSBmdW5jdGlvbihtYXRjaCkge1xuICAgIHJldHVybiAnXFxcXCcgKyBlc2NhcGVzW21hdGNoXTtcbiAgfTtcblxuICAvLyBKYXZhU2NyaXB0IG1pY3JvLXRlbXBsYXRpbmcsIHNpbWlsYXIgdG8gSm9obiBSZXNpZydzIGltcGxlbWVudGF0aW9uLlxuICAvLyBVbmRlcnNjb3JlIHRlbXBsYXRpbmcgaGFuZGxlcyBhcmJpdHJhcnkgZGVsaW1pdGVycywgcHJlc2VydmVzIHdoaXRlc3BhY2UsXG4gIC8vIGFuZCBjb3JyZWN0bHkgZXNjYXBlcyBxdW90ZXMgd2l0aGluIGludGVycG9sYXRlZCBjb2RlLlxuICAvLyBOQjogYG9sZFNldHRpbmdzYCBvbmx5IGV4aXN0cyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkuXG4gIF8udGVtcGxhdGUgPSBmdW5jdGlvbih0ZXh0LCBzZXR0aW5ncywgb2xkU2V0dGluZ3MpIHtcbiAgICBpZiAoIXNldHRpbmdzICYmIG9sZFNldHRpbmdzKSBzZXR0aW5ncyA9IG9sZFNldHRpbmdzO1xuICAgIHNldHRpbmdzID0gXy5kZWZhdWx0cyh7fSwgc2V0dGluZ3MsIF8udGVtcGxhdGVTZXR0aW5ncyk7XG5cbiAgICAvLyBDb21iaW5lIGRlbGltaXRlcnMgaW50byBvbmUgcmVndWxhciBleHByZXNzaW9uIHZpYSBhbHRlcm5hdGlvbi5cbiAgICB2YXIgbWF0Y2hlciA9IFJlZ0V4cChbXG4gICAgICAoc2V0dGluZ3MuZXNjYXBlIHx8IG5vTWF0Y2gpLnNvdXJjZSxcbiAgICAgIChzZXR0aW5ncy5pbnRlcnBvbGF0ZSB8fCBub01hdGNoKS5zb3VyY2UsXG4gICAgICAoc2V0dGluZ3MuZXZhbHVhdGUgfHwgbm9NYXRjaCkuc291cmNlXG4gICAgXS5qb2luKCd8JykgKyAnfCQnLCAnZycpO1xuXG4gICAgLy8gQ29tcGlsZSB0aGUgdGVtcGxhdGUgc291cmNlLCBlc2NhcGluZyBzdHJpbmcgbGl0ZXJhbHMgYXBwcm9wcmlhdGVseS5cbiAgICB2YXIgaW5kZXggPSAwO1xuICAgIHZhciBzb3VyY2UgPSBcIl9fcCs9J1wiO1xuICAgIHRleHQucmVwbGFjZShtYXRjaGVyLCBmdW5jdGlvbihtYXRjaCwgZXNjYXBlLCBpbnRlcnBvbGF0ZSwgZXZhbHVhdGUsIG9mZnNldCkge1xuICAgICAgc291cmNlICs9IHRleHQuc2xpY2UoaW5kZXgsIG9mZnNldCkucmVwbGFjZShlc2NhcGVyLCBlc2NhcGVDaGFyKTtcbiAgICAgIGluZGV4ID0gb2Zmc2V0ICsgbWF0Y2gubGVuZ3RoO1xuXG4gICAgICBpZiAoZXNjYXBlKSB7XG4gICAgICAgIHNvdXJjZSArPSBcIicrXFxuKChfX3Q9KFwiICsgZXNjYXBlICsgXCIpKT09bnVsbD8nJzpfLmVzY2FwZShfX3QpKStcXG4nXCI7XG4gICAgICB9IGVsc2UgaWYgKGludGVycG9sYXRlKSB7XG4gICAgICAgIHNvdXJjZSArPSBcIicrXFxuKChfX3Q9KFwiICsgaW50ZXJwb2xhdGUgKyBcIikpPT1udWxsPycnOl9fdCkrXFxuJ1wiO1xuICAgICAgfSBlbHNlIGlmIChldmFsdWF0ZSkge1xuICAgICAgICBzb3VyY2UgKz0gXCInO1xcblwiICsgZXZhbHVhdGUgKyBcIlxcbl9fcCs9J1wiO1xuICAgICAgfVxuXG4gICAgICAvLyBBZG9iZSBWTXMgbmVlZCB0aGUgbWF0Y2ggcmV0dXJuZWQgdG8gcHJvZHVjZSB0aGUgY29ycmVjdCBvZmZlc3QuXG4gICAgICByZXR1cm4gbWF0Y2g7XG4gICAgfSk7XG4gICAgc291cmNlICs9IFwiJztcXG5cIjtcblxuICAgIC8vIElmIGEgdmFyaWFibGUgaXMgbm90IHNwZWNpZmllZCwgcGxhY2UgZGF0YSB2YWx1ZXMgaW4gbG9jYWwgc2NvcGUuXG4gICAgaWYgKCFzZXR0aW5ncy52YXJpYWJsZSkgc291cmNlID0gJ3dpdGgob2JqfHx7fSl7XFxuJyArIHNvdXJjZSArICd9XFxuJztcblxuICAgIHNvdXJjZSA9IFwidmFyIF9fdCxfX3A9JycsX19qPUFycmF5LnByb3RvdHlwZS5qb2luLFwiICtcbiAgICAgIFwicHJpbnQ9ZnVuY3Rpb24oKXtfX3ArPV9fai5jYWxsKGFyZ3VtZW50cywnJyk7fTtcXG5cIiArXG4gICAgICBzb3VyY2UgKyAncmV0dXJuIF9fcDtcXG4nO1xuXG4gICAgdHJ5IHtcbiAgICAgIHZhciByZW5kZXIgPSBuZXcgRnVuY3Rpb24oc2V0dGluZ3MudmFyaWFibGUgfHwgJ29iaicsICdfJywgc291cmNlKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBlLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuXG4gICAgdmFyIHRlbXBsYXRlID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgcmV0dXJuIHJlbmRlci5jYWxsKHRoaXMsIGRhdGEsIF8pO1xuICAgIH07XG5cbiAgICAvLyBQcm92aWRlIHRoZSBjb21waWxlZCBzb3VyY2UgYXMgYSBjb252ZW5pZW5jZSBmb3IgcHJlY29tcGlsYXRpb24uXG4gICAgdmFyIGFyZ3VtZW50ID0gc2V0dGluZ3MudmFyaWFibGUgfHwgJ29iaic7XG4gICAgdGVtcGxhdGUuc291cmNlID0gJ2Z1bmN0aW9uKCcgKyBhcmd1bWVudCArICcpe1xcbicgKyBzb3VyY2UgKyAnfSc7XG5cbiAgICByZXR1cm4gdGVtcGxhdGU7XG4gIH07XG5cbiAgLy8gQWRkIGEgXCJjaGFpblwiIGZ1bmN0aW9uLiBTdGFydCBjaGFpbmluZyBhIHdyYXBwZWQgVW5kZXJzY29yZSBvYmplY3QuXG4gIF8uY2hhaW4gPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIgaW5zdGFuY2UgPSBfKG9iaik7XG4gICAgaW5zdGFuY2UuX2NoYWluID0gdHJ1ZTtcbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH07XG5cbiAgLy8gT09QXG4gIC8vIC0tLS0tLS0tLS0tLS0tLVxuICAvLyBJZiBVbmRlcnNjb3JlIGlzIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLCBpdCByZXR1cm5zIGEgd3JhcHBlZCBvYmplY3QgdGhhdFxuICAvLyBjYW4gYmUgdXNlZCBPTy1zdHlsZS4gVGhpcyB3cmFwcGVyIGhvbGRzIGFsdGVyZWQgdmVyc2lvbnMgb2YgYWxsIHRoZVxuICAvLyB1bmRlcnNjb3JlIGZ1bmN0aW9ucy4gV3JhcHBlZCBvYmplY3RzIG1heSBiZSBjaGFpbmVkLlxuXG4gIC8vIEhlbHBlciBmdW5jdGlvbiB0byBjb250aW51ZSBjaGFpbmluZyBpbnRlcm1lZGlhdGUgcmVzdWx0cy5cbiAgdmFyIHJlc3VsdCA9IGZ1bmN0aW9uKGluc3RhbmNlLCBvYmopIHtcbiAgICByZXR1cm4gaW5zdGFuY2UuX2NoYWluID8gXyhvYmopLmNoYWluKCkgOiBvYmo7XG4gIH07XG5cbiAgLy8gQWRkIHlvdXIgb3duIGN1c3RvbSBmdW5jdGlvbnMgdG8gdGhlIFVuZGVyc2NvcmUgb2JqZWN0LlxuICBfLm1peGluID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgXy5lYWNoKF8uZnVuY3Rpb25zKG9iaiksIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHZhciBmdW5jID0gX1tuYW1lXSA9IG9ialtuYW1lXTtcbiAgICAgIF8ucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gW3RoaXMuX3dyYXBwZWRdO1xuICAgICAgICBwdXNoLmFwcGx5KGFyZ3MsIGFyZ3VtZW50cyk7XG4gICAgICAgIHJldHVybiByZXN1bHQodGhpcywgZnVuYy5hcHBseShfLCBhcmdzKSk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIEFkZCBhbGwgb2YgdGhlIFVuZGVyc2NvcmUgZnVuY3Rpb25zIHRvIHRoZSB3cmFwcGVyIG9iamVjdC5cbiAgXy5taXhpbihfKTtcblxuICAvLyBBZGQgYWxsIG11dGF0b3IgQXJyYXkgZnVuY3Rpb25zIHRvIHRoZSB3cmFwcGVyLlxuICBfLmVhY2goWydwb3AnLCAncHVzaCcsICdyZXZlcnNlJywgJ3NoaWZ0JywgJ3NvcnQnLCAnc3BsaWNlJywgJ3Vuc2hpZnQnXSwgZnVuY3Rpb24obmFtZSkge1xuICAgIHZhciBtZXRob2QgPSBBcnJheVByb3RvW25hbWVdO1xuICAgIF8ucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgb2JqID0gdGhpcy5fd3JhcHBlZDtcbiAgICAgIG1ldGhvZC5hcHBseShvYmosIGFyZ3VtZW50cyk7XG4gICAgICBpZiAoKG5hbWUgPT09ICdzaGlmdCcgfHwgbmFtZSA9PT0gJ3NwbGljZScpICYmIG9iai5sZW5ndGggPT09IDApIGRlbGV0ZSBvYmpbMF07XG4gICAgICByZXR1cm4gcmVzdWx0KHRoaXMsIG9iaik7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gQWRkIGFsbCBhY2Nlc3NvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuXG4gIF8uZWFjaChbJ2NvbmNhdCcsICdqb2luJywgJ3NsaWNlJ10sIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICB2YXIgbWV0aG9kID0gQXJyYXlQcm90b1tuYW1lXTtcbiAgICBfLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJlc3VsdCh0aGlzLCBtZXRob2QuYXBwbHkodGhpcy5fd3JhcHBlZCwgYXJndW1lbnRzKSk7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gRXh0cmFjdHMgdGhlIHJlc3VsdCBmcm9tIGEgd3JhcHBlZCBhbmQgY2hhaW5lZCBvYmplY3QuXG4gIF8ucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuX3dyYXBwZWQ7XG4gIH07XG5cbiAgLy8gUHJvdmlkZSB1bndyYXBwaW5nIHByb3h5IGZvciBzb21lIG1ldGhvZHMgdXNlZCBpbiBlbmdpbmUgb3BlcmF0aW9uc1xuICAvLyBzdWNoIGFzIGFyaXRobWV0aWMgYW5kIEpTT04gc3RyaW5naWZpY2F0aW9uLlxuICBfLnByb3RvdHlwZS52YWx1ZU9mID0gXy5wcm90b3R5cGUudG9KU09OID0gXy5wcm90b3R5cGUudmFsdWU7XG5cbiAgXy5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJycgKyB0aGlzLl93cmFwcGVkO1xuICB9O1xuXG4gIC8vIEFNRCByZWdpc3RyYXRpb24gaGFwcGVucyBhdCB0aGUgZW5kIGZvciBjb21wYXRpYmlsaXR5IHdpdGggQU1EIGxvYWRlcnNcbiAgLy8gdGhhdCBtYXkgbm90IGVuZm9yY2UgbmV4dC10dXJuIHNlbWFudGljcyBvbiBtb2R1bGVzLiBFdmVuIHRob3VnaCBnZW5lcmFsXG4gIC8vIHByYWN0aWNlIGZvciBBTUQgcmVnaXN0cmF0aW9uIGlzIHRvIGJlIGFub255bW91cywgdW5kZXJzY29yZSByZWdpc3RlcnNcbiAgLy8gYXMgYSBuYW1lZCBtb2R1bGUgYmVjYXVzZSwgbGlrZSBqUXVlcnksIGl0IGlzIGEgYmFzZSBsaWJyYXJ5IHRoYXQgaXNcbiAgLy8gcG9wdWxhciBlbm91Z2ggdG8gYmUgYnVuZGxlZCBpbiBhIHRoaXJkIHBhcnR5IGxpYiwgYnV0IG5vdCBiZSBwYXJ0IG9mXG4gIC8vIGFuIEFNRCBsb2FkIHJlcXVlc3QuIFRob3NlIGNhc2VzIGNvdWxkIGdlbmVyYXRlIGFuIGVycm9yIHdoZW4gYW5cbiAgLy8gYW5vbnltb3VzIGRlZmluZSgpIGlzIGNhbGxlZCBvdXRzaWRlIG9mIGEgbG9hZGVyIHJlcXVlc3QuXG4gIGlmICh0cnVlKSB7XG4gICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW10sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gXztcbiAgICB9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLFxuXHRcdFx0XHRfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG4gIH1cbn0uY2FsbCh0aGlzKSk7XG5cblxuLyoqKi8gfSksXG4vKiAyNCAqLyxcbi8qIDI1ICovLFxuLyogMjYgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIF9pbmRleCA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7XG5cbl9fd2VicGFja19yZXF1aXJlX18oMTApO1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDExKTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblxuZnVuY3Rpb24gYWN0aW9uKGVsZW1lbnQsIG5vdykge1xuICBlbGVtZW50LnRleHRDb250ZW50ID0gJ0hlbGxvLCAnICsgbm93KCkgKyAnLic7XG59XG5cbmZ1bmN0aW9uIGluaXQoZXYpIHtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldi50eXBlLCBpbml0KTtcbiAgKDAsIF9pbmRleC5sYXp5YWN0aW9uKSgnLmxhenlhY3Rpb24nLCBhY3Rpb24sIERhdGUubm93KTtcbiAgKDAsIF9pbmRleC5sYXp5aW1hZ2UpKCcuaG9yaXpvbnRhbC1zY3JvbGwtYm94IC5sYXp5aW1hZ2UnLCAnc3JjJywgeyBwYXJlbnQ6ICcuaG9yaXpvbnRhbC1zY3JvbGwtYm94JyB9KTtcbiAgKDAsIF9pbmRleC5sYXp5aW1hZ2UpKCcudmVydGljYWwtc2Nyb2xsLWFyZWEgLmxhenlpbWFnZScsICdzcmMnKTtcbiAgKDAsIF9pbmRleC5sYXp5aW1hZ2UpKCcudmVydGljYWwtc2Nyb2xsLWJveCAubGF6eWltYWdlJywgJ3NyYycsIHsgcGFyZW50OiAnLnZlcnRpY2FsLXNjcm9sbC1ib3gnIH0pO1xuICAoMCwgX2luZGV4LnN0aWNreWhlYWRlcikoJy5zdGlja3loZWFkZXInKTtcbn1cblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXQsIGZhbHNlKTtcblxuLyoqKi8gfSlcbl0sWzI2XSk7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNjcm9sbGV2ZW50cy5qcyIsImltcG9ydCB7IENvbnRhaW5lciB9IGZyb20gJy4vY29udGFpbmVyJ1xuXG5jb25zdCB3aW4gPSBkb2N1bWVudC5kZWZhdWx0Vmlld1xuXG4vKipcbiAqIERldGVjdCBzY3JvbGwgZXZlbnRzIGZvciBlbGVtZW50c1xuICovXG5leHBvcnQgZnVuY3Rpb24gb25TY3JvbGwgKHByZXByb2Nlc3MsIHByb2Nlc3MsIHBvc3Rwcm9jZXNzKSB7XG4gIHJldHVybiBmdW5jdGlvbiAocGFyZW50U2VsZWN0b3IsIHRhcmdldFNlbGVjdG9yLCAuLi5hcmdzKSB7XG4gICAgY29uc3QgY29udGFpbmVyID0gbmV3IENvbnRhaW5lcihwYXJlbnRTZWxlY3RvciwgdGFyZ2V0U2VsZWN0b3IpXG4gICAgY29uc3QgdGFyZ2V0cyA9IGNvbnRhaW5lci5jaGlsZHJlblxuXG4gICAgaWYgKGNvbnRhaW5lci5wYXJlbnRzLmxlbmd0aCA8PSAwIHx8IHRhcmdldHMubGVuZ3RoIDw9IDApIHJldHVyblxuXG4gICAgZnVuY3Rpb24gc2Nyb2xsICgpIHtcbiAgICAgIHRhcmdldHMuZm9yRWFjaCgodGFyZ2V0LCBpbmRleCkgPT4ge1xuICAgICAgICBjb25zdCBkaWZmZXJlbmNlWCA9IE1hdGguYWJzKGNvbnRhaW5lci53aW5kb3cuc2Nyb2xsT3JpZ2luLnggLSB0YXJnZXQucG9zaXRpb25PcmlnaW4ueClcbiAgICAgICAgY29uc3QgZGlmZmVyZW5jZVkgPSBNYXRoLmFicyhjb250YWluZXIud2luZG93LnNjcm9sbE9yaWdpbi55IC0gdGFyZ2V0LnBvc2l0aW9uT3JpZ2luLnkpXG5cbiAgICAgICAgaWYgKGNvbnRhaW5lci53aW5kb3cucmVjdC53aWR0aCAqIDEuMSA+IGRpZmZlcmVuY2VYICYmXG4gICAgICAgICAgICBjb250YWluZXIud2luZG93LnJlY3QuaGVpZ2h0ICogMS4xID4gZGlmZmVyZW5jZVkpIHtcbiAgICAgICAgICBwcmVwcm9jZXNzKHRhcmdldC5lbGVtZW50LCAuLi5hcmdzKVxuICAgICAgICAgIHByb2Nlc3ModGFyZ2V0LmVsZW1lbnQsIC4uLmFyZ3MpXG4gICAgICAgICAgcG9zdHByb2Nlc3ModGFyZ2V0LmVsZW1lbnQsIC4uLmFyZ3MpXG4gICAgICAgICAgdGFyZ2V0cy5zcGxpY2UoaW5kZXgsIDEpICAvLyBSZW1vdmUgYW4gaXRlbSBmcm9tIHRhcmdldHMgYnkgc2lkZSBlZmZlY3RcbiAgICAgICAgICBpZiAodGFyZ2V0cy5sZW5ndGggPD0gMCkgY29udGFpbmVyLm9mZignc2Nyb2xsJywgc2Nyb2xsKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG92ZXJmbG93WCAoKSB7XG4gICAgICB0YXJnZXRzLmZvckVhY2goKHRhcmdldCwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgZGlmZmVyZW5jZVggPSBNYXRoLmFicyh0YXJnZXQucGFyZW50LnNjcm9sbE9yaWdpbi54IC0gdGFyZ2V0LnBvc2l0aW9uT3JpZ2luLngpXG4gICAgICAgIGNvbnN0IGRpZmZlcmVuY2VZID1cbiAgICAgICAgICBNYXRoLmFicyhjb250YWluZXIud2luZG93LnNjcm9sbE9yaWdpbi55IC0gdGFyZ2V0LnBhcmVudC5wb3NpdGlvbk9yaWdpbi55KVxuXG4gICAgICAgIGlmICh0YXJnZXQucGFyZW50LnJlY3Qud2lkdGggKiAxLjEgPiBkaWZmZXJlbmNlWCAmJlxuICAgICAgICAgICAgY29udGFpbmVyLndpbmRvdy5yZWN0LmhlaWdodCAqIDEuMSA+IGRpZmZlcmVuY2VZKSB7XG4gICAgICAgICAgcHJlcHJvY2Vzcyh0YXJnZXQuZWxlbWVudCwgLi4uYXJncylcbiAgICAgICAgICBwcm9jZXNzKHRhcmdldC5lbGVtZW50LCAuLi5hcmdzKVxuICAgICAgICAgIHBvc3Rwcm9jZXNzKHRhcmdldC5lbGVtZW50LCAuLi5hcmdzKVxuICAgICAgICAgIHRhcmdldHMuc3BsaWNlKGluZGV4LCAxKSAgLy8gUmVtb3ZlIGFuIGl0ZW0gZnJvbSB0YXJnZXRzIGJ5IHNpZGUgZWZmZWN0XG4gICAgICAgICAgaWYgKHRhcmdldHMubGVuZ3RoIDw9IDApIGNvbnRhaW5lci5vZmYoJ3Njcm9sbCcsIG92ZXJmbG93WClcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvdmVyZmxvd1kgKCkge1xuICAgICAgdGFyZ2V0cy5mb3JFYWNoKCh0YXJnZXQsIGluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IGRpZmZlcmVuY2VYID1cbiAgICAgICAgICBNYXRoLmFicyhjb250YWluZXIud2luZG93LnNjcm9sbE9yaWdpbi54IC0gdGFyZ2V0LnBhcmVudC5wb3NpdGlvbk9yaWdpbi54KVxuICAgICAgICBjb25zdCBkaWZmZXJlbmNlWSA9IE1hdGguYWJzKHRhcmdldC5wYXJlbnQuc2Nyb2xsT3JpZ2luLnkgLSB0YXJnZXQucG9zaXRpb25PcmlnaW4ueSlcblxuICAgICAgICBpZiAoY29udGFpbmVyLndpbmRvdy5yZWN0LndpZHRoICogMS4xID4gZGlmZmVyZW5jZVggJiZcbiAgICAgICAgICAgIHRhcmdldC5wYXJlbnQucmVjdC5oZWlnaHQgKiAxLjEgPiBkaWZmZXJlbmNlWSkge1xuICAgICAgICAgIHByZXByb2Nlc3ModGFyZ2V0LmVsZW1lbnQsIC4uLmFyZ3MpXG4gICAgICAgICAgcHJvY2Vzcyh0YXJnZXQuZWxlbWVudCwgLi4uYXJncylcbiAgICAgICAgICBwb3N0cHJvY2Vzcyh0YXJnZXQuZWxlbWVudCwgLi4uYXJncylcbiAgICAgICAgICB0YXJnZXRzLnNwbGljZShpbmRleCwgMSkgIC8vIFJlbW92ZSBhbiBpdGVtIGZyb20gdGFyZ2V0cyBieSBzaWRlIGVmZmVjdFxuICAgICAgICAgIGlmICh0YXJnZXRzLmxlbmd0aCA8PSAwKSBjb250YWluZXIub2ZmKCdzY3JvbGwnLCBvdmVyZmxvd1kpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgaWYgKHRvU3RyaW5nLmFwcGx5KGNvbnRhaW5lci5wYXJlbnRzWzBdLmVsZW1lbnQpID09PSAnW29iamVjdCBXaW5kb3ddJykge1xuICAgICAgY29udGFpbmVyLm9uKCdzY3JvbGwnLCBzY3JvbGwpXG4gICAgICBzY3JvbGwoKVxuICAgIH0gZWxzZSBpZiAoY29udGFpbmVyLnBhcmVudHNbMF0ucmVjdC53aWR0aCA8IGNvbnRhaW5lci5wYXJlbnRzWzBdLnJlY3Quc2Nyb2xsV2lkdGgpIHtcbiAgICAgIGNvbnRhaW5lci5vbignc2Nyb2xsJywgb3ZlcmZsb3dYKVxuICAgICAgb3ZlcmZsb3dYKClcbiAgICB9IGVsc2UgaWYgKGNvbnRhaW5lci5wYXJlbnRzWzBdLnJlY3QuaGVpZ2h0IDwgY29udGFpbmVyLnBhcmVudHNbMF0ucmVjdC5zY3JvbGxIZWlnaHQpIHtcbiAgICAgIGNvbnRhaW5lci5vbignc2Nyb2xsJywgb3ZlcmZsb3dZKVxuICAgICAgb3ZlcmZsb3dZKClcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBEZXRlY3QgZWxlbWVudHMgb24gdG9wIG9mIHdpbmRvd1xuICovXG5leHBvcnQgZnVuY3Rpb24gb25Ub3AgKHByZXByb2Nlc3MsIHByb2Nlc3MsIHBvc3Rwcm9jZXNzKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoc2VsZWN0b3IsIC4uLmFyZ3MpIHtcbiAgICBjb25zdCBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpXG5cbiAgICBlbGVtZW50cy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICBjb25zdCBlbGVtZW50UmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgIGNvbnN0IGVsZW1lbnRQb3NpdGlvblkgPSBNYXRoLmZsb29yKGVsZW1lbnRSZWN0LnRvcCkgKyAod2luLnNjcm9sbFkgfHwgd2luLnBhZ2VZT2Zmc2V0KVxuICAgICAgY29uc3QgZWxlbWVudE9yaWdpblkgPSBlbGVtZW50UmVjdC5oZWlnaHQgKyBlbGVtZW50UG9zaXRpb25ZXG5cbiAgICAgIGZ1bmN0aW9uIHNjcm9sbCAoKSB7XG4gICAgICAgIGNvbnN0IHdpbmRvd1Njcm9sbFkgPSB3aW4uc2Nyb2xsWSB8fCB3aW4ucGFnZVlPZmZzZXRcblxuICAgICAgICBpZiAoZWxlbWVudE9yaWdpblkgPD0gd2luZG93U2Nyb2xsWSkge1xuICAgICAgICAgIGNvbnN0IHByb2Nlc3NBcmdzID0gW2VsZW1lbnQsIGZhbHNlXS5jb25jYXQoYXJncylcbiAgICAgICAgICBwcm9jZXNzKC4uLnByb2Nlc3NBcmdzKVxuICAgICAgICAgIHBvc3Rwcm9jZXNzKC4uLnByb2Nlc3NBcmdzKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IHByb2Nlc3NBcmdzID0gW2VsZW1lbnQsIHRydWVdLmNvbmNhdChhcmdzKVxuICAgICAgICAgIHByb2Nlc3MoLi4ucHJvY2Vzc0FyZ3MpXG4gICAgICAgICAgcG9zdHByb2Nlc3MoLi4ucHJvY2Vzc0FyZ3MpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcHJlcHJvY2VzcyguLi5bZWxlbWVudF0uY29uY2F0KGFyZ3MpKVxuICAgICAgd2luLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHNjcm9sbCwgZmFsc2UpXG4gICAgICBzY3JvbGwoKVxuXG4gICAgICByZXR1cm4gZWxlbWVudFxuICAgIH0pXG4gIH1cbn1cblxuLyoqXG4gKlxuICovXG5leHBvcnQgZnVuY3Rpb24gb25Cb3R0b20gKHByZXByb2Nlc3MsIHByb2Nlc3MsIHBvc3Rwcm9jZXNzKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoc2VsZWN0b3IsIC4uLmFyZ3MpIHtcbiAgICBjb25zdCBwcm9jZXNzQXJncyA9IFtzZWxlY3Rvcl0uY29uY2F0KGFyZ3MpXG4gICAgcHJlcHJvY2VzcyguLi5wcm9jZXNzQXJncylcbiAgICBwcm9jZXNzKC4uLnByb2Nlc3NBcmdzKVxuICAgIHBvc3Rwcm9jZXNzKC4uLnByb2Nlc3NBcmdzKVxuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvU2Nyb2xsQWN0aW9uL3Njcm9sbGFjdGlvbi5qcyIsImltcG9ydCBsYXp5YWN0aW9uIGZyb20gJy4vbGF6eWFjdGlvbidcbmltcG9ydCBsYXp5aW1hZ2UgZnJvbSAnLi9sYXp5aW1hZ2UnXG5pbXBvcnQgc3RpY2t5aGVhZGVyIGZyb20gJy4vc3RpY2t5aGVhZGVyJ1xuXG5leHBvcnQge1xuICBsYXp5YWN0aW9uLFxuICBsYXp5aW1hZ2UsXG4gIHN0aWNreWhlYWRlclxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL1Njcm9sbEFjdGlvbi9pbmRleC5qcyIsIi8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cbi8vIGxvYWQgdGhlIHN0eWxlc1xudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzP2ltcG9ydExvYWRlcnM9MSEuLy4uLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9pbmRleC5qcz9zb3VyY2VNYXA9aW5saW5lIS4vbGF6eWltYWdlLmNzc1wiKTtcbmlmKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuLy8gYWRkIHRoZSBzdHlsZXMgdG8gdGhlIERPTVxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2FkZFN0eWxlcy5qc1wiKShjb250ZW50LCB7fSk7XG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2Fscztcbi8vIEhvdCBNb2R1bGUgUmVwbGFjZW1lbnRcbmlmKG1vZHVsZS5ob3QpIHtcblx0Ly8gV2hlbiB0aGUgc3R5bGVzIGNoYW5nZSwgdXBkYXRlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0aWYoIWNvbnRlbnQubG9jYWxzKSB7XG5cdFx0bW9kdWxlLmhvdC5hY2NlcHQoXCIhIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanM/aW1wb3J0TG9hZGVycz0xIS4vLi4vLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL2luZGV4LmpzP3NvdXJjZU1hcD1pbmxpbmUhLi9sYXp5aW1hZ2UuY3NzXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzP2ltcG9ydExvYWRlcnM9MSEuLy4uLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9pbmRleC5qcz9zb3VyY2VNYXA9aW5saW5lIS4vbGF6eWltYWdlLmNzc1wiKTtcblx0XHRcdGlmKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykgbmV3Q29udGVudCA9IFtbbW9kdWxlLmlkLCBuZXdDb250ZW50LCAnJ11dO1xuXHRcdFx0dXBkYXRlKG5ld0NvbnRlbnQpO1xuXHRcdH0pO1xuXHR9XG5cdC8vIFdoZW4gdGhlIG1vZHVsZSBpcyBkaXNwb3NlZCwgcmVtb3ZlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0bW9kdWxlLmhvdC5kaXNwb3NlKGZ1bmN0aW9uKCkgeyB1cGRhdGUoKTsgfSk7XG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvU2Nyb2xsQWN0aW9uL2xhenlpbWFnZS5jc3Ncbi8vIG1vZHVsZSBpZCA9IDEwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cbi8vIGxvYWQgdGhlIHN0eWxlc1xudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzP2ltcG9ydExvYWRlcnM9MSEuLy4uLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9pbmRleC5qcz9zb3VyY2VNYXA9aW5saW5lIS4vc3RpY2t5aGVhZGVyLmNzc1wiKTtcbmlmKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuLy8gYWRkIHRoZSBzdHlsZXMgdG8gdGhlIERPTVxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2FkZFN0eWxlcy5qc1wiKShjb250ZW50LCB7fSk7XG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2Fscztcbi8vIEhvdCBNb2R1bGUgUmVwbGFjZW1lbnRcbmlmKG1vZHVsZS5ob3QpIHtcblx0Ly8gV2hlbiB0aGUgc3R5bGVzIGNoYW5nZSwgdXBkYXRlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0aWYoIWNvbnRlbnQubG9jYWxzKSB7XG5cdFx0bW9kdWxlLmhvdC5hY2NlcHQoXCIhIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanM/aW1wb3J0TG9hZGVycz0xIS4vLi4vLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtbG9hZGVyL2luZGV4LmpzP3NvdXJjZU1hcD1pbmxpbmUhLi9zdGlja3loZWFkZXIuY3NzXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzP2ltcG9ydExvYWRlcnM9MSEuLy4uLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLWxvYWRlci9pbmRleC5qcz9zb3VyY2VNYXA9aW5saW5lIS4vc3RpY2t5aGVhZGVyLmNzc1wiKTtcblx0XHRcdGlmKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykgbmV3Q29udGVudCA9IFtbbW9kdWxlLmlkLCBuZXdDb250ZW50LCAnJ11dO1xuXHRcdFx0dXBkYXRlKG5ld0NvbnRlbnQpO1xuXHRcdH0pO1xuXHR9XG5cdC8vIFdoZW4gdGhlIG1vZHVsZSBpcyBkaXNwb3NlZCwgcmVtb3ZlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0bW9kdWxlLmhvdC5kaXNwb3NlKGZ1bmN0aW9uKCkgeyB1cGRhdGUoKTsgfSk7XG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvU2Nyb2xsQWN0aW9uL3N0aWNreWhlYWRlci5jc3Ncbi8vIG1vZHVsZSBpZCA9IDExXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBfIGZyb20gJ3VuZGVyc2NvcmUnXG5cbmNvbnN0IHdpbiA9IGRvY3VtZW50LmRlZmF1bHRWaWV3XG5cbmNsYXNzIFRhcmdldENvbnRhaW5lciB7XG5cbiAgY29uc3RydWN0b3IgKHRhcmdldEVsZW1lbnQsIHBhcmVudENvbnRhaW5lcikge1xuICAgIHRoaXMuZWxlbWVudCA9IHRhcmdldEVsZW1lbnQgIC8vIGVsZW1lbnRcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudENvbnRhaW5lclxuICB9XG5cbiAgZ2V0IHBvc2l0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgeDogTWF0aC5mbG9vcih0aGlzLnJlY3QubGVmdCkgKyB0aGlzLnBhcmVudC5zY3JvbGwueCxcbiAgICAgIHk6IE1hdGguZmxvb3IodGhpcy5yZWN0LnRvcCkgKyB0aGlzLnBhcmVudC5zY3JvbGwueVxuICAgIH1cbiAgfVxuXG4gIGdldCBwb3NpdGlvbk9yaWdpbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHg6IE1hdGguZmxvb3IodGhpcy5yZWN0LndpZHRoIC8gMikgKyB0aGlzLnBvc2l0aW9uLngsXG4gICAgICB5OiBNYXRoLmZsb29yKHRoaXMucmVjdC5oZWlnaHQgLyAyKSArIHRoaXMucG9zaXRpb24ueVxuICAgIH1cbiAgfVxuXG4gIGdldCByZWN0ICgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gIH1cblxufVxuXG5jbGFzcyBXaW5kb3dDb250YWluZXIge1xuXG4gIGNvbnN0cnVjdG9yIChjaGlsZHJlblNlbGVjdG9yKSB7XG4gICAgdGhpcy53aW5kb3cgPSB0aGlzXG4gICAgdGhpcy5lbGVtZW50ID0gd2luXG4gICAgaWYgKGNoaWxkcmVuU2VsZWN0b3IpIHtcbiAgICAgIGNvbnN0IGNoaWxkcmVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjaGlsZHJlblNlbGVjdG9yKVxuICAgICAgdGhpcy5jaGlsZHJlbiA9IEFycmF5LmZyb20oY2hpbGRyZW4sIGNoaWxkID0+IG5ldyBUYXJnZXRDb250YWluZXIoY2hpbGQsIHRoaXMpKVxuICAgIH1cbiAgfVxuXG4gIGdldCBwb3NpdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHg6IE1hdGguZmxvb3IodGhpcy5yZWN0LndpZHRoIC8gMiksXG4gICAgICB5OiBNYXRoLmZsb29yKHRoaXMucmVjdC5oZWlnaHQgLyAyKVxuICAgIH1cbiAgfVxuXG4gIGdldCByZWN0ICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdG9wOiAwLFxuICAgICAgbGVmdDogMCxcbiAgICAgIHdpZHRoOiB0aGlzLmVsZW1lbnQuaW5uZXJXaWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5lbGVtZW50LmlubmVySGVpZ2h0LFxuICAgICAgc2Nyb2xsV2lkdGg6IGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGgsXG4gICAgICBzY3JvbGxIZWlnaHQ6IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0XG4gICAgfVxuICB9XG5cbiAgZ2V0IHNjcm9sbCAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHg6IHRoaXMuZWxlbWVudC5zY3JvbGxYIHx8IHRoaXMuZWxlbWVudC5wYWdlWE9mZnNldCxcbiAgICAgIHk6IHRoaXMuZWxlbWVudC5zY3JvbGxZIHx8IHRoaXMuZWxlbWVudC5wYWdlWU9mZnNldFxuICAgIH1cbiAgfVxuXG4gIGdldCBzY3JvbGxPcmlnaW4gKCkge1xuICAgIHJldHVybiB7XG4gICAgICB4OiBNYXRoLmZsb29yKHRoaXMucmVjdC53aWR0aCAvIDIpICsgdGhpcy5zY3JvbGwueCxcbiAgICAgIHk6IE1hdGguZmxvb3IodGhpcy5yZWN0LmhlaWdodCAvIDIpICsgdGhpcy5zY3JvbGwueVxuICAgIH1cbiAgfVxuXG4gIG9uIChldmVudG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRuYW1lLCBjYWxsYmFjaywgZmFsc2UpXG4gIH1cblxuICBvZmYgKGV2ZW50bmFtZSwgY2FsbGJhY2spIHtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudG5hbWUsIGNhbGxiYWNrKVxuICB9XG5cbn1cblxuY2xhc3MgUGFyZW50Q29udGFpbmVyIHtcblxuICBjb25zdHJ1Y3RvciAocGFyZW50RWxlbWVudCwgY2hpbGRyZW5TZWxlY3Rvcikge1xuICAgIHRoaXMud2luZG93ID0gbmV3IFdpbmRvd0NvbnRhaW5lcigpXG4gICAgdGhpcy5lbGVtZW50ID0gcGFyZW50RWxlbWVudFxuICAgIGNvbnN0IGNoaWxkcmVuID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY2hpbGRyZW5TZWxlY3RvcilcbiAgICB0aGlzLmNoaWxkcmVuID0gQXJyYXkuZnJvbShjaGlsZHJlbiwgY2hpbGQgPT4gbmV3IFRhcmdldENvbnRhaW5lcihjaGlsZCwgdGhpcykpXG4gIH1cblxuICBnZXQgcG9zaXRpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICB4OiBNYXRoLmZsb29yKHRoaXMucmVjdC5sZWZ0KSArIHRoaXMud2luZG93LnNjcm9sbC54LFxuICAgICAgeTogTWF0aC5mbG9vcih0aGlzLnJlY3QudG9wKSArIHRoaXMud2luZG93LnNjcm9sbC55XG4gICAgfVxuICB9XG5cbiAgZ2V0IHBvc2l0aW9uT3JpZ2luICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgeDogTWF0aC5mbG9vcih0aGlzLnJlY3Qud2lkdGggLyAyKSArIHRoaXMucG9zaXRpb24ueCxcbiAgICAgIHk6IE1hdGguZmxvb3IodGhpcy5yZWN0LmhlaWdodCAvIDIpICsgdGhpcy5wb3NpdGlvbi55XG4gICAgfVxuICB9XG5cbiAgZ2V0IHJlY3QgKCkge1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwge1xuICAgICAgc2Nyb2xsV2lkdGg6IHRoaXMuZWxlbWVudC5zY3JvbGxXaWR0aCxcbiAgICAgIHNjcm9sbEhlaWdodDogdGhpcy5lbGVtZW50LnNjcm9sbEhlaWdodFxuICAgIH0pXG4gIH1cblxuICBnZXQgc2Nyb2xsICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgeDogdGhpcy5lbGVtZW50LnNjcm9sbExlZnQsXG4gICAgICB5OiB0aGlzLmVsZW1lbnQuc2Nyb2xsVG9wXG4gICAgfVxuICB9XG5cbiAgZ2V0IHNjcm9sbE9yaWdpbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHg6IE1hdGguZmxvb3IodGhpcy5yZWN0LndpZHRoIC8gMikgKyB0aGlzLmVsZW1lbnQuc2Nyb2xsTGVmdCxcbiAgICAgIHk6IE1hdGguZmxvb3IodGhpcy5yZWN0LmhlaWdodCAvIDIpICsgdGhpcy5lbGVtZW50LnNjcm9sbFRvcFxuICAgIH1cbiAgfVxuXG4gIGdldCBzdHlsZSAoKSB7XG4gICAgcmV0dXJuIGdsb2JhbC5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudClcbiAgfVxuXG4gIG9uIChldmVudG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRuYW1lLCBjYWxsYmFjaywgZmFsc2UpXG4gIH1cblxuICBvZmYgKGV2ZW50bmFtZSwgY2FsbGJhY2spIHtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudG5hbWUsIGNhbGxiYWNrKVxuICB9XG5cbn1cblxuY2xhc3MgQ29udGFpbmVyIHtcblxuICBjb25zdHJ1Y3RvciAocGFyZW50U2VsZWN0b3IsIHRhcmdldFNlbGVjdG9yKSB7XG4gICAgdGhpcy53aW5kb3cgPSBuZXcgV2luZG93Q29udGFpbmVyKClcblxuICAgIHRoaXMucGFyZW50cyA9IFtdXG5cbiAgICBpZiAodG9TdHJpbmcuYXBwbHkocGFyZW50U2VsZWN0b3IpID09PSAnW29iamVjdCBXaW5kb3ddJykge1xuICAgICAgdGhpcy5wYXJlbnRzLnB1c2gobmV3IFdpbmRvd0NvbnRhaW5lcih0YXJnZXRTZWxlY3RvcikpXG4gICAgfSBlbHNlIGlmICh0b1N0cmluZy5hcHBseShwYXJlbnRTZWxlY3RvcikgPT09ICdbb2JqZWN0IFN0cmluZ10nKSB7XG4gICAgICBjb25zdCBwYXJlbnRFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwocGFyZW50U2VsZWN0b3IpXG4gICAgICB0aGlzLnBhcmVudHMgPSBBcnJheS5mcm9tKHBhcmVudEVsZW1lbnRzLFxuICAgICAgICAgIHBhcmVudEVsZW1lbnQgPT4gbmV3IFBhcmVudENvbnRhaW5lcihwYXJlbnRFbGVtZW50LCB0YXJnZXRTZWxlY3RvcikpXG4gICAgfVxuXG4gICAgdGhpcy5jaGlsZHJlbiA9IF8uZmxhdHRlbih0aGlzLnBhcmVudHMubWFwKHBhcmVudCA9PiBwYXJlbnQuY2hpbGRyZW4pKVxuICB9XG5cbiAgb24gKGV2ZW50bmFtZSwgY2FsbGJhY2spIHtcbiAgICB0aGlzLnBhcmVudHMuZm9yRWFjaChwYXJlbnQgPT4gcGFyZW50Lm9uKGV2ZW50bmFtZSwgY2FsbGJhY2spKVxuICAgIHRoaXMud2luZG93Lm9uKGV2ZW50bmFtZSwgY2FsbGJhY2spXG4gIH1cblxuICBvZmYgKGV2ZW50bmFtZSwgY2FsbGJhY2spIHtcbiAgICB0aGlzLnBhcmVudHMuZm9yRWFjaChwYXJlbnQgPT4gcGFyZW50Lm9mZihldmVudG5hbWUsIGNhbGxiYWNrKSlcbiAgICB0aGlzLndpbmRvdy5vZmYoZXZlbnRuYW1lLCBjYWxsYmFjaylcbiAgfVxuXG59XG5cbmV4cG9ydCB7XG4gIFRhcmdldENvbnRhaW5lcixcbiAgV2luZG93Q29udGFpbmVyLFxuICBQYXJlbnRDb250YWluZXIsXG4gIENvbnRhaW5lclxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL1Njcm9sbEFjdGlvbi9jb250YWluZXIuanMiLCJpbXBvcnQgeyBvblNjcm9sbCB9IGZyb20gJy4vc2Nyb2xsYWN0aW9uJ1xuXG5mdW5jdGlvbiBwcmVwcm9jZXNzICgpIHt9XG5cbmZ1bmN0aW9uIHByb2Nlc3MgKGVsZW1lbnQsIGNhbGxiYWNrLCAuLi5hcmdzKSB7XG4gIGNhbGxiYWNrKC4uLltlbGVtZW50XS5jb25jYXQoYXJncykpXG59XG5cbmZ1bmN0aW9uIHBvc3Rwcm9jZXNzICgpIHt9XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxhenlhY3Rpb24gKHRhcmdldCwgY2FsbGJhY2ssIC4uLmFyZ3MpIHtcbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuICAgIHBhcmVudDogd2luZG93XG4gIH0sIGFyZ3NbYXJncy5sZW5ndGggLSAxXSlcblxuICByZXR1cm4gb25TY3JvbGwocHJlcHJvY2VzcywgcHJvY2VzcywgcG9zdHByb2Nlc3MpKG9wdGlvbnMucGFyZW50LCB0YXJnZXQsIGNhbGxiYWNrLCAuLi5hcmdzKVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL1Njcm9sbEFjdGlvbi9sYXp5YWN0aW9uLmpzIiwiaW1wb3J0IHsgb25TY3JvbGwgfSBmcm9tICcuL3Njcm9sbGFjdGlvbidcblxuZnVuY3Rpb24gcHJlcHJvY2VzcyAoZWxlbWVudCkge1xuICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpXG59XG5cbmZ1bmN0aW9uIHByb2Nlc3MgKGVsZW1lbnQsIGRhdGFuYW1lKSB7XG4gIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uIGxvYWQgKGV2KSB7XG4gICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2LnR5cGUsIGxvYWQpXG4gICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtYnVzeScsICdmYWxzZScpXG4gICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ2ZhbHNlJylcbiAgfSwgZmFsc2UpXG4gIGNvbnN0IGRhdGFhdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoYGRhdGEtJHtkYXRhbmFtZX1gKVxuICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnc3JjJywgZGF0YWF0dHIpXG4gIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWJ1c3knLCAndHJ1ZScpXG59XG5cbmZ1bmN0aW9uIHBvc3Rwcm9jZXNzIChlbGVtZW50LCBkYXRhbmFtZSkge1xuICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShgZGF0YS0ke2RhdGFuYW1lfWApXG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxhenlpbWFnZSAodGFyZ2V0LCBkYXRhbmFtZSwgb3B0aW9ucyA9IHsgcGFyZW50OiB3aW5kb3cgfSkge1xuICByZXR1cm4gb25TY3JvbGwocHJlcHJvY2VzcywgcHJvY2VzcywgcG9zdHByb2Nlc3MpKG9wdGlvbnMucGFyZW50LCB0YXJnZXQsIGRhdGFuYW1lKVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL1Njcm9sbEFjdGlvbi9sYXp5aW1hZ2UuanMiLCJpbXBvcnQgeyBvblRvcCB9IGZyb20gJy4vc2Nyb2xsYWN0aW9uJ1xuXG5mdW5jdGlvbiBwcmVwcm9jZXNzICgpIHt9XG5cbmZ1bmN0aW9uIHByb2Nlc3MgKGVsZW1lbnQsIG9udG9wKSB7XG4gIC8qIGVzbGludC1kaXNhYmxlIG5vLXBhcmFtLXJlYXNzaWduICovXG4gIGlmIChvbnRvcCkge1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ3Njcm9sbCcpXG4gICAgZWxlbWVudC5zdHlsZS50b3AgPSAnJ1xuICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJydcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBlbGVtZW50UmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdmaXhlZCcpXG4gICAgZWxlbWVudC5zdHlsZS50b3AgPSBgLSR7ZWxlbWVudFJlY3QuaGVpZ2h0fXB4YFxuICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZTNkKDAsICR7ZWxlbWVudFJlY3QuaGVpZ2h0fXB4LCAwKWBcbiAgfVxufVxuXG5mdW5jdGlvbiBwb3N0cHJvY2VzcyAoKSB7fVxuXG5jb25zdCBzdGlja3loZWFkZXIgPSBvblRvcChwcmVwcm9jZXNzLCBwcm9jZXNzLCBwb3N0cHJvY2VzcylcblxuZXhwb3J0IGRlZmF1bHQgc3RpY2t5aGVhZGVyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvU2Nyb2xsQWN0aW9uL3N0aWNreWhlYWRlci5qcyIsImV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qc1wiKSgpO1xuLy8gaW1wb3J0c1xuXG5cbi8vIG1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwiLmxhenlpbWFnZXt0cmFuc2l0aW9uLXByb3BlcnR5Om9wYWNpdHksdmlzaWJpbGl0eTt0cmFuc2l0aW9uLWR1cmF0aW9uOi4zc30ubGF6eWltYWdlW2FyaWEtaGlkZGVuPXRydWVde29wYWNpdHk6MDt2aXNpYmlsaXR5OmhpZGRlbn0ubGF6eWltYWdlW2FyaWEtaGlkZGVuPWZhbHNlXXtvcGFjaXR5OjE7dmlzaWJpbGl0eTp2aXNpYmxlfVxcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSnpiM1Z5WTJWeklqcGJJbXhoZW5scGJXRm5aUzVqYzNNaVhTd2libUZ0WlhNaU9sdGRMQ0p0WVhCd2FXNW5jeUk2SWtGQlFVRXNWMEZEUlN4MVEwRkJlVU1zUVVGRGVrTXNkVUpCUVRCQ0xFTkJWek5DTEVGQlZFTXNOa0pCUTBVc1ZVRkJWeXhCUVVOWUxHbENRVUZ0UWl4RFFVTndRaXhCUVVWRUxEaENRVU5GTEZWQlFWY3NRVUZEV0N4clFrRkJiMElzUTBGRGNrSWlMQ0ptYVd4bElqb2liR0Y2ZVdsdFlXZGxMbU56Y3lJc0luTnZkWEpqWlhORGIyNTBaVzUwSWpwYklpNXNZWHA1YVcxaFoyVWdlMXh1SUNCMGNtRnVjMmwwYVc5dUxYQnliM0JsY25SNU9pQnZjR0ZqYVhSNUxDQjJhWE5wWW1sc2FYUjVPMXh1SUNCMGNtRnVjMmwwYVc5dUxXUjFjbUYwYVc5dU9pQXdMak56TzF4dVhHNGdJRUJ1WlhOMElDWmJZWEpwWVMxb2FXUmtaVzQ5WENKMGNuVmxYQ0pkSUh0Y2JpQWdJQ0J2Y0dGamFYUjVPaUF3TzF4dUlDQWdJSFpwYzJsaWFXeHBkSGs2SUdocFpHUmxianRjYmlBZ2ZWeHVYRzRnSUVCdVpYTjBJQ1piWVhKcFlTMW9hV1JrWlc0OVhDSm1ZV3h6WlZ3aVhTQjdYRzRnSUNBZ2IzQmhZMmwwZVRvZ01UdGNiaUFnSUNCMmFYTnBZbWxzYVhSNU9pQjJhWE5wWW14bE8xeHVJQ0I5WEc1OVhHNGlYWDA9ICovXCIsIFwiXCJdKTtcblxuLy8gZXhwb3J0c1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2Nzcy1sb2FkZXI/aW1wb3J0TG9hZGVycz0xIS4vfi9wb3N0Y3NzLWxvYWRlcj9zb3VyY2VNYXA9aW5saW5lIS4vc3JjL1Njcm9sbEFjdGlvbi9sYXp5aW1hZ2UuY3NzXG4vLyBtb2R1bGUgaWQgPSAyMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcIikoKTtcbi8vIGltcG9ydHNcblxuXG4vLyBtb2R1bGVcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcIi5zdGlja3loZWFkZXJ7dHJhbnNpdGlvbi1wcm9wZXJ0eTp0cmFuc2Zvcm07dHJhbnNpdGlvbi1kdXJhdGlvbjouM3N9LnN0aWNreWhlYWRlclthcmlhLWxhYmVsPXNjcm9sbF17cG9zaXRpb246cmVsYXRpdmV9LnN0aWNreWhlYWRlclthcmlhLWxhYmVsPWZpeGVkXXtsZWZ0OjA7cG9zaXRpb246Zml4ZWQ7ei1pbmRleDoxfVxcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSnpiM1Z5WTJWeklqcGJJbk4wYVdOcmVXaGxZV1JsY2k1amMzTWlYU3dpYm1GdFpYTWlPbHRkTENKdFlYQndhVzVuY3lJNklrRkJRVUVzWTBGRFJTdzRRa0ZCSzBJc1FVRkRMMElzZFVKQlFUQkNMRU5CVnpOQ0xFRkJWRU1zYVVOQlEwVXNhVUpCUVcxQ0xFTkJRM0JDTEVGQlJVUXNaME5CUTBVc1QwRkJVU3hCUVVOU0xHVkJRV2RDTEVGQlEyaENMRk5CUVZjc1EwRkRXaUlzSW1acGJHVWlPaUp6ZEdsamEzbG9aV0ZrWlhJdVkzTnpJaXdpYzI5MWNtTmxjME52Ym5SbGJuUWlPbHNpTG5OMGFXTnJlV2hsWVdSbGNpQjdYRzRnSUhSeVlXNXphWFJwYjI0dGNISnZjR1Z5ZEhrNklIUnlZVzV6Wm05eWJUdGNiaUFnZEhKaGJuTnBkR2x2Ymkxa2RYSmhkR2x2YmpvZ01DNHpjenRjYmx4dUlDQkFibVZ6ZENBbVcyRnlhV0V0YkdGaVpXdzlYQ0p6WTNKdmJHeGNJbDBnZTF4dUlDQWdJSEJ2YzJsMGFXOXVPaUJ5Wld4aGRHbDJaVHRjYmlBZ2ZWeHVYRzRnSUVCdVpYTjBJQ1piWVhKcFlTMXNZV0psYkQxY0ltWnBlR1ZrWENKZElIdGNiaUFnSUNCc1pXWjBPaUF3TzF4dUlDQWdJSEJ2YzJsMGFXOXVPaUJtYVhobFpEdGNiaUFnSUNCNkxXbHVaR1Y0T2lBeE8xeHVJQ0I5WEc1OVhHNGlYWDA9ICovXCIsIFwiXCJdKTtcblxuLy8gZXhwb3J0c1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2Nzcy1sb2FkZXI/aW1wb3J0TG9hZGVycz0xIS4vfi9wb3N0Y3NzLWxvYWRlcj9zb3VyY2VNYXA9aW5saW5lIS4vc3JjL1Njcm9sbEFjdGlvbi9zdGlja3loZWFkZXIuY3NzXG4vLyBtb2R1bGUgaWQgPSAyMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyAgICAgVW5kZXJzY29yZS5qcyAxLjguM1xuLy8gICAgIGh0dHA6Ly91bmRlcnNjb3JlanMub3JnXG4vLyAgICAgKGMpIDIwMDktMjAxNSBKZXJlbXkgQXNoa2VuYXMsIERvY3VtZW50Q2xvdWQgYW5kIEludmVzdGlnYXRpdmUgUmVwb3J0ZXJzICYgRWRpdG9yc1xuLy8gICAgIFVuZGVyc2NvcmUgbWF5IGJlIGZyZWVseSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5cbihmdW5jdGlvbigpIHtcblxuICAvLyBCYXNlbGluZSBzZXR1cFxuICAvLyAtLS0tLS0tLS0tLS0tLVxuXG4gIC8vIEVzdGFibGlzaCB0aGUgcm9vdCBvYmplY3QsIGB3aW5kb3dgIGluIHRoZSBicm93c2VyLCBvciBgZXhwb3J0c2Agb24gdGhlIHNlcnZlci5cbiAgdmFyIHJvb3QgPSB0aGlzO1xuXG4gIC8vIFNhdmUgdGhlIHByZXZpb3VzIHZhbHVlIG9mIHRoZSBgX2AgdmFyaWFibGUuXG4gIHZhciBwcmV2aW91c1VuZGVyc2NvcmUgPSByb290Ll87XG5cbiAgLy8gU2F2ZSBieXRlcyBpbiB0aGUgbWluaWZpZWQgKGJ1dCBub3QgZ3ppcHBlZCkgdmVyc2lvbjpcbiAgdmFyIEFycmF5UHJvdG8gPSBBcnJheS5wcm90b3R5cGUsIE9ialByb3RvID0gT2JqZWN0LnByb3RvdHlwZSwgRnVuY1Byb3RvID0gRnVuY3Rpb24ucHJvdG90eXBlO1xuXG4gIC8vIENyZWF0ZSBxdWljayByZWZlcmVuY2UgdmFyaWFibGVzIGZvciBzcGVlZCBhY2Nlc3MgdG8gY29yZSBwcm90b3R5cGVzLlxuICB2YXJcbiAgICBwdXNoICAgICAgICAgICAgID0gQXJyYXlQcm90by5wdXNoLFxuICAgIHNsaWNlICAgICAgICAgICAgPSBBcnJheVByb3RvLnNsaWNlLFxuICAgIHRvU3RyaW5nICAgICAgICAgPSBPYmpQcm90by50b1N0cmluZyxcbiAgICBoYXNPd25Qcm9wZXJ0eSAgID0gT2JqUHJvdG8uaGFzT3duUHJvcGVydHk7XG5cbiAgLy8gQWxsICoqRUNNQVNjcmlwdCA1KiogbmF0aXZlIGZ1bmN0aW9uIGltcGxlbWVudGF0aW9ucyB0aGF0IHdlIGhvcGUgdG8gdXNlXG4gIC8vIGFyZSBkZWNsYXJlZCBoZXJlLlxuICB2YXJcbiAgICBuYXRpdmVJc0FycmF5ICAgICAgPSBBcnJheS5pc0FycmF5LFxuICAgIG5hdGl2ZUtleXMgICAgICAgICA9IE9iamVjdC5rZXlzLFxuICAgIG5hdGl2ZUJpbmQgICAgICAgICA9IEZ1bmNQcm90by5iaW5kLFxuICAgIG5hdGl2ZUNyZWF0ZSAgICAgICA9IE9iamVjdC5jcmVhdGU7XG5cbiAgLy8gTmFrZWQgZnVuY3Rpb24gcmVmZXJlbmNlIGZvciBzdXJyb2dhdGUtcHJvdG90eXBlLXN3YXBwaW5nLlxuICB2YXIgQ3RvciA9IGZ1bmN0aW9uKCl7fTtcblxuICAvLyBDcmVhdGUgYSBzYWZlIHJlZmVyZW5jZSB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QgZm9yIHVzZSBiZWxvdy5cbiAgdmFyIF8gPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAob2JqIGluc3RhbmNlb2YgXykgcmV0dXJuIG9iajtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgXykpIHJldHVybiBuZXcgXyhvYmopO1xuICAgIHRoaXMuX3dyYXBwZWQgPSBvYmo7XG4gIH07XG5cbiAgLy8gRXhwb3J0IHRoZSBVbmRlcnNjb3JlIG9iamVjdCBmb3IgKipOb2RlLmpzKiosIHdpdGhcbiAgLy8gYmFja3dhcmRzLWNvbXBhdGliaWxpdHkgZm9yIHRoZSBvbGQgYHJlcXVpcmUoKWAgQVBJLiBJZiB3ZSdyZSBpblxuICAvLyB0aGUgYnJvd3NlciwgYWRkIGBfYCBhcyBhIGdsb2JhbCBvYmplY3QuXG4gIGlmICh0eXBlb2YgZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICAgIGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IF87XG4gICAgfVxuICAgIGV4cG9ydHMuXyA9IF87XG4gIH0gZWxzZSB7XG4gICAgcm9vdC5fID0gXztcbiAgfVxuXG4gIC8vIEN1cnJlbnQgdmVyc2lvbi5cbiAgXy5WRVJTSU9OID0gJzEuOC4zJztcblxuICAvLyBJbnRlcm5hbCBmdW5jdGlvbiB0aGF0IHJldHVybnMgYW4gZWZmaWNpZW50IChmb3IgY3VycmVudCBlbmdpbmVzKSB2ZXJzaW9uXG4gIC8vIG9mIHRoZSBwYXNzZWQtaW4gY2FsbGJhY2ssIHRvIGJlIHJlcGVhdGVkbHkgYXBwbGllZCBpbiBvdGhlciBVbmRlcnNjb3JlXG4gIC8vIGZ1bmN0aW9ucy5cbiAgdmFyIG9wdGltaXplQ2IgPSBmdW5jdGlvbihmdW5jLCBjb250ZXh0LCBhcmdDb3VudCkge1xuICAgIGlmIChjb250ZXh0ID09PSB2b2lkIDApIHJldHVybiBmdW5jO1xuICAgIHN3aXRjaCAoYXJnQ291bnQgPT0gbnVsbCA/IDMgOiBhcmdDb3VudCkge1xuICAgICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbChjb250ZXh0LCB2YWx1ZSk7XG4gICAgICB9O1xuICAgICAgY2FzZSAyOiByZXR1cm4gZnVuY3Rpb24odmFsdWUsIG90aGVyKSB7XG4gICAgICAgIHJldHVybiBmdW5jLmNhbGwoY29udGV4dCwgdmFsdWUsIG90aGVyKTtcbiAgICAgIH07XG4gICAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgICAgfTtcbiAgICAgIGNhc2UgNDogcmV0dXJuIGZ1bmN0aW9uKGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbChjb250ZXh0LCBhY2N1bXVsYXRvciwgdmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKTtcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfTtcblxuICAvLyBBIG1vc3RseS1pbnRlcm5hbCBmdW5jdGlvbiB0byBnZW5lcmF0ZSBjYWxsYmFja3MgdGhhdCBjYW4gYmUgYXBwbGllZFxuICAvLyB0byBlYWNoIGVsZW1lbnQgaW4gYSBjb2xsZWN0aW9uLCByZXR1cm5pbmcgdGhlIGRlc2lyZWQgcmVzdWx0IOKAlCBlaXRoZXJcbiAgLy8gaWRlbnRpdHksIGFuIGFyYml0cmFyeSBjYWxsYmFjaywgYSBwcm9wZXJ0eSBtYXRjaGVyLCBvciBhIHByb3BlcnR5IGFjY2Vzc29yLlxuICB2YXIgY2IgPSBmdW5jdGlvbih2YWx1ZSwgY29udGV4dCwgYXJnQ291bnQpIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIF8uaWRlbnRpdHk7XG4gICAgaWYgKF8uaXNGdW5jdGlvbih2YWx1ZSkpIHJldHVybiBvcHRpbWl6ZUNiKHZhbHVlLCBjb250ZXh0LCBhcmdDb3VudCk7XG4gICAgaWYgKF8uaXNPYmplY3QodmFsdWUpKSByZXR1cm4gXy5tYXRjaGVyKHZhbHVlKTtcbiAgICByZXR1cm4gXy5wcm9wZXJ0eSh2YWx1ZSk7XG4gIH07XG4gIF8uaXRlcmF0ZWUgPSBmdW5jdGlvbih2YWx1ZSwgY29udGV4dCkge1xuICAgIHJldHVybiBjYih2YWx1ZSwgY29udGV4dCwgSW5maW5pdHkpO1xuICB9O1xuXG4gIC8vIEFuIGludGVybmFsIGZ1bmN0aW9uIGZvciBjcmVhdGluZyBhc3NpZ25lciBmdW5jdGlvbnMuXG4gIHZhciBjcmVhdGVBc3NpZ25lciA9IGZ1bmN0aW9uKGtleXNGdW5jLCB1bmRlZmluZWRPbmx5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikge1xuICAgICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICBpZiAobGVuZ3RoIDwgMiB8fCBvYmogPT0gbnVsbCkgcmV0dXJuIG9iajtcbiAgICAgIGZvciAodmFyIGluZGV4ID0gMTsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpbmRleF0sXG4gICAgICAgICAgICBrZXlzID0ga2V5c0Z1bmMoc291cmNlKSxcbiAgICAgICAgICAgIGwgPSBrZXlzLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICAgICAgICBpZiAoIXVuZGVmaW5lZE9ubHkgfHwgb2JqW2tleV0gPT09IHZvaWQgMCkgb2JqW2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG9iajtcbiAgICB9O1xuICB9O1xuXG4gIC8vIEFuIGludGVybmFsIGZ1bmN0aW9uIGZvciBjcmVhdGluZyBhIG5ldyBvYmplY3QgdGhhdCBpbmhlcml0cyBmcm9tIGFub3RoZXIuXG4gIHZhciBiYXNlQ3JlYXRlID0gZnVuY3Rpb24ocHJvdG90eXBlKSB7XG4gICAgaWYgKCFfLmlzT2JqZWN0KHByb3RvdHlwZSkpIHJldHVybiB7fTtcbiAgICBpZiAobmF0aXZlQ3JlYXRlKSByZXR1cm4gbmF0aXZlQ3JlYXRlKHByb3RvdHlwZSk7XG4gICAgQ3Rvci5wcm90b3R5cGUgPSBwcm90b3R5cGU7XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBDdG9yO1xuICAgIEN0b3IucHJvdG90eXBlID0gbnVsbDtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIHZhciBwcm9wZXJ0eSA9IGZ1bmN0aW9uKGtleSkge1xuICAgIHJldHVybiBmdW5jdGlvbihvYmopIHtcbiAgICAgIHJldHVybiBvYmogPT0gbnVsbCA/IHZvaWQgMCA6IG9ialtrZXldO1xuICAgIH07XG4gIH07XG5cbiAgLy8gSGVscGVyIGZvciBjb2xsZWN0aW9uIG1ldGhvZHMgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgYSBjb2xsZWN0aW9uXG4gIC8vIHNob3VsZCBiZSBpdGVyYXRlZCBhcyBhbiBhcnJheSBvciBhcyBhbiBvYmplY3RcbiAgLy8gUmVsYXRlZDogaHR0cDovL3Blb3BsZS5tb3ppbGxhLm9yZy9+am9yZW5kb3JmZi9lczYtZHJhZnQuaHRtbCNzZWMtdG9sZW5ndGhcbiAgLy8gQXZvaWRzIGEgdmVyeSBuYXN0eSBpT1MgOCBKSVQgYnVnIG9uIEFSTS02NC4gIzIwOTRcbiAgdmFyIE1BWF9BUlJBWV9JTkRFWCA9IE1hdGgucG93KDIsIDUzKSAtIDE7XG4gIHZhciBnZXRMZW5ndGggPSBwcm9wZXJ0eSgnbGVuZ3RoJyk7XG4gIHZhciBpc0FycmF5TGlrZSA9IGZ1bmN0aW9uKGNvbGxlY3Rpb24pIHtcbiAgICB2YXIgbGVuZ3RoID0gZ2V0TGVuZ3RoKGNvbGxlY3Rpb24pO1xuICAgIHJldHVybiB0eXBlb2YgbGVuZ3RoID09ICdudW1iZXInICYmIGxlbmd0aCA+PSAwICYmIGxlbmd0aCA8PSBNQVhfQVJSQVlfSU5ERVg7XG4gIH07XG5cbiAgLy8gQ29sbGVjdGlvbiBGdW5jdGlvbnNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBUaGUgY29ybmVyc3RvbmUsIGFuIGBlYWNoYCBpbXBsZW1lbnRhdGlvbiwgYWthIGBmb3JFYWNoYC5cbiAgLy8gSGFuZGxlcyByYXcgb2JqZWN0cyBpbiBhZGRpdGlvbiB0byBhcnJheS1saWtlcy4gVHJlYXRzIGFsbFxuICAvLyBzcGFyc2UgYXJyYXktbGlrZXMgYXMgaWYgdGhleSB3ZXJlIGRlbnNlLlxuICBfLmVhY2ggPSBfLmZvckVhY2ggPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgaXRlcmF0ZWUgPSBvcHRpbWl6ZUNiKGl0ZXJhdGVlLCBjb250ZXh0KTtcbiAgICB2YXIgaSwgbGVuZ3RoO1xuICAgIGlmIChpc0FycmF5TGlrZShvYmopKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBvYmoubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaXRlcmF0ZWUob2JqW2ldLCBpLCBvYmopO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgICAgZm9yIChpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBpdGVyYXRlZShvYmpba2V5c1tpXV0sIGtleXNbaV0sIG9iaik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSByZXN1bHRzIG9mIGFwcGx5aW5nIHRoZSBpdGVyYXRlZSB0byBlYWNoIGVsZW1lbnQuXG4gIF8ubWFwID0gXy5jb2xsZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpO1xuICAgIHZhciBrZXlzID0gIWlzQXJyYXlMaWtlKG9iaikgJiYgXy5rZXlzKG9iaiksXG4gICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoLFxuICAgICAgICByZXN1bHRzID0gQXJyYXkobGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICB2YXIgY3VycmVudEtleSA9IGtleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4O1xuICAgICAgcmVzdWx0c1tpbmRleF0gPSBpdGVyYXRlZShvYmpbY3VycmVudEtleV0sIGN1cnJlbnRLZXksIG9iaik7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHRzO1xuICB9O1xuXG4gIC8vIENyZWF0ZSBhIHJlZHVjaW5nIGZ1bmN0aW9uIGl0ZXJhdGluZyBsZWZ0IG9yIHJpZ2h0LlxuICBmdW5jdGlvbiBjcmVhdGVSZWR1Y2UoZGlyKSB7XG4gICAgLy8gT3B0aW1pemVkIGl0ZXJhdG9yIGZ1bmN0aW9uIGFzIHVzaW5nIGFyZ3VtZW50cy5sZW5ndGhcbiAgICAvLyBpbiB0aGUgbWFpbiBmdW5jdGlvbiB3aWxsIGRlb3B0aW1pemUgdGhlLCBzZWUgIzE5OTEuXG4gICAgZnVuY3Rpb24gaXRlcmF0b3Iob2JqLCBpdGVyYXRlZSwgbWVtbywga2V5cywgaW5kZXgsIGxlbmd0aCkge1xuICAgICAgZm9yICg7IGluZGV4ID49IDAgJiYgaW5kZXggPCBsZW5ndGg7IGluZGV4ICs9IGRpcikge1xuICAgICAgICB2YXIgY3VycmVudEtleSA9IGtleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4O1xuICAgICAgICBtZW1vID0gaXRlcmF0ZWUobWVtbywgb2JqW2N1cnJlbnRLZXldLCBjdXJyZW50S2V5LCBvYmopO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1lbW87XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIG1lbW8sIGNvbnRleHQpIHtcbiAgICAgIGl0ZXJhdGVlID0gb3B0aW1pemVDYihpdGVyYXRlZSwgY29udGV4dCwgNCk7XG4gICAgICB2YXIga2V5cyA9ICFpc0FycmF5TGlrZShvYmopICYmIF8ua2V5cyhvYmopLFxuICAgICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoLFxuICAgICAgICAgIGluZGV4ID0gZGlyID4gMCA/IDAgOiBsZW5ndGggLSAxO1xuICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBpbml0aWFsIHZhbHVlIGlmIG5vbmUgaXMgcHJvdmlkZWQuXG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgbWVtbyA9IG9ialtrZXlzID8ga2V5c1tpbmRleF0gOiBpbmRleF07XG4gICAgICAgIGluZGV4ICs9IGRpcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBpdGVyYXRvcihvYmosIGl0ZXJhdGVlLCBtZW1vLCBrZXlzLCBpbmRleCwgbGVuZ3RoKTtcbiAgICB9O1xuICB9XG5cbiAgLy8gKipSZWR1Y2UqKiBidWlsZHMgdXAgYSBzaW5nbGUgcmVzdWx0IGZyb20gYSBsaXN0IG9mIHZhbHVlcywgYWthIGBpbmplY3RgLFxuICAvLyBvciBgZm9sZGxgLlxuICBfLnJlZHVjZSA9IF8uZm9sZGwgPSBfLmluamVjdCA9IGNyZWF0ZVJlZHVjZSgxKTtcblxuICAvLyBUaGUgcmlnaHQtYXNzb2NpYXRpdmUgdmVyc2lvbiBvZiByZWR1Y2UsIGFsc28ga25vd24gYXMgYGZvbGRyYC5cbiAgXy5yZWR1Y2VSaWdodCA9IF8uZm9sZHIgPSBjcmVhdGVSZWR1Y2UoLTEpO1xuXG4gIC8vIFJldHVybiB0aGUgZmlyc3QgdmFsdWUgd2hpY2ggcGFzc2VzIGEgdHJ1dGggdGVzdC4gQWxpYXNlZCBhcyBgZGV0ZWN0YC5cbiAgXy5maW5kID0gXy5kZXRlY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHZhciBrZXk7XG4gICAgaWYgKGlzQXJyYXlMaWtlKG9iaikpIHtcbiAgICAgIGtleSA9IF8uZmluZEluZGV4KG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KTtcbiAgICB9IGVsc2Uge1xuICAgICAga2V5ID0gXy5maW5kS2V5KG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KTtcbiAgICB9XG4gICAgaWYgKGtleSAhPT0gdm9pZCAwICYmIGtleSAhPT0gLTEpIHJldHVybiBvYmpba2V5XTtcbiAgfTtcblxuICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyB0aGF0IHBhc3MgYSB0cnV0aCB0ZXN0LlxuICAvLyBBbGlhc2VkIGFzIGBzZWxlY3RgLlxuICBfLmZpbHRlciA9IF8uc2VsZWN0ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7XG4gICAgXy5lYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpZiAocHJlZGljYXRlKHZhbHVlLCBpbmRleCwgbGlzdCkpIHJlc3VsdHMucHVzaCh2YWx1ZSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGFsbCB0aGUgZWxlbWVudHMgZm9yIHdoaWNoIGEgdHJ1dGggdGVzdCBmYWlscy5cbiAgXy5yZWplY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHJldHVybiBfLmZpbHRlcihvYmosIF8ubmVnYXRlKGNiKHByZWRpY2F0ZSkpLCBjb250ZXh0KTtcbiAgfTtcblxuICAvLyBEZXRlcm1pbmUgd2hldGhlciBhbGwgb2YgdGhlIGVsZW1lbnRzIG1hdGNoIGEgdHJ1dGggdGVzdC5cbiAgLy8gQWxpYXNlZCBhcyBgYWxsYC5cbiAgXy5ldmVyeSA9IF8uYWxsID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIHZhciBrZXlzID0gIWlzQXJyYXlMaWtlKG9iaikgJiYgXy5rZXlzKG9iaiksXG4gICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoO1xuICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIHZhciBjdXJyZW50S2V5ID0ga2V5cyA/IGtleXNbaW5kZXhdIDogaW5kZXg7XG4gICAgICBpZiAoIXByZWRpY2F0ZShvYmpbY3VycmVudEtleV0sIGN1cnJlbnRLZXksIG9iaikpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cbiAgLy8gRGV0ZXJtaW5lIGlmIGF0IGxlYXN0IG9uZSBlbGVtZW50IGluIHRoZSBvYmplY3QgbWF0Y2hlcyBhIHRydXRoIHRlc3QuXG4gIC8vIEFsaWFzZWQgYXMgYGFueWAuXG4gIF8uc29tZSA9IF8uYW55ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIHZhciBrZXlzID0gIWlzQXJyYXlMaWtlKG9iaikgJiYgXy5rZXlzKG9iaiksXG4gICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoO1xuICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIHZhciBjdXJyZW50S2V5ID0ga2V5cyA/IGtleXNbaW5kZXhdIDogaW5kZXg7XG4gICAgICBpZiAocHJlZGljYXRlKG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKSkgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICAvLyBEZXRlcm1pbmUgaWYgdGhlIGFycmF5IG9yIG9iamVjdCBjb250YWlucyBhIGdpdmVuIGl0ZW0gKHVzaW5nIGA9PT1gKS5cbiAgLy8gQWxpYXNlZCBhcyBgaW5jbHVkZXNgIGFuZCBgaW5jbHVkZWAuXG4gIF8uY29udGFpbnMgPSBfLmluY2x1ZGVzID0gXy5pbmNsdWRlID0gZnVuY3Rpb24ob2JqLCBpdGVtLCBmcm9tSW5kZXgsIGd1YXJkKSB7XG4gICAgaWYgKCFpc0FycmF5TGlrZShvYmopKSBvYmogPSBfLnZhbHVlcyhvYmopO1xuICAgIGlmICh0eXBlb2YgZnJvbUluZGV4ICE9ICdudW1iZXInIHx8IGd1YXJkKSBmcm9tSW5kZXggPSAwO1xuICAgIHJldHVybiBfLmluZGV4T2Yob2JqLCBpdGVtLCBmcm9tSW5kZXgpID49IDA7XG4gIH07XG5cbiAgLy8gSW52b2tlIGEgbWV0aG9kICh3aXRoIGFyZ3VtZW50cykgb24gZXZlcnkgaXRlbSBpbiBhIGNvbGxlY3Rpb24uXG4gIF8uaW52b2tlID0gZnVuY3Rpb24ob2JqLCBtZXRob2QpIHtcbiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcbiAgICB2YXIgaXNGdW5jID0gXy5pc0Z1bmN0aW9uKG1ldGhvZCk7XG4gICAgcmV0dXJuIF8ubWFwKG9iaiwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBmdW5jID0gaXNGdW5jID8gbWV0aG9kIDogdmFsdWVbbWV0aG9kXTtcbiAgICAgIHJldHVybiBmdW5jID09IG51bGwgPyBmdW5jIDogZnVuYy5hcHBseSh2YWx1ZSwgYXJncyk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNvbW1vbiB1c2UgY2FzZSBvZiBgbWFwYDogZmV0Y2hpbmcgYSBwcm9wZXJ0eS5cbiAgXy5wbHVjayA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7XG4gICAgcmV0dXJuIF8ubWFwKG9iaiwgXy5wcm9wZXJ0eShrZXkpKTtcbiAgfTtcblxuICAvLyBDb252ZW5pZW5jZSB2ZXJzaW9uIG9mIGEgY29tbW9uIHVzZSBjYXNlIG9mIGBmaWx0ZXJgOiBzZWxlY3Rpbmcgb25seSBvYmplY3RzXG4gIC8vIGNvbnRhaW5pbmcgc3BlY2lmaWMgYGtleTp2YWx1ZWAgcGFpcnMuXG4gIF8ud2hlcmUgPSBmdW5jdGlvbihvYmosIGF0dHJzKSB7XG4gICAgcmV0dXJuIF8uZmlsdGVyKG9iaiwgXy5tYXRjaGVyKGF0dHJzKSk7XG4gIH07XG5cbiAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNvbW1vbiB1c2UgY2FzZSBvZiBgZmluZGA6IGdldHRpbmcgdGhlIGZpcnN0IG9iamVjdFxuICAvLyBjb250YWluaW5nIHNwZWNpZmljIGBrZXk6dmFsdWVgIHBhaXJzLlxuICBfLmZpbmRXaGVyZSA9IGZ1bmN0aW9uKG9iaiwgYXR0cnMpIHtcbiAgICByZXR1cm4gXy5maW5kKG9iaiwgXy5tYXRjaGVyKGF0dHJzKSk7XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSBtYXhpbXVtIGVsZW1lbnQgKG9yIGVsZW1lbnQtYmFzZWQgY29tcHV0YXRpb24pLlxuICBfLm1heCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0ID0gLUluZmluaXR5LCBsYXN0Q29tcHV0ZWQgPSAtSW5maW5pdHksXG4gICAgICAgIHZhbHVlLCBjb21wdXRlZDtcbiAgICBpZiAoaXRlcmF0ZWUgPT0gbnVsbCAmJiBvYmogIT0gbnVsbCkge1xuICAgICAgb2JqID0gaXNBcnJheUxpa2Uob2JqKSA/IG9iaiA6IF8udmFsdWVzKG9iaik7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gb2JqLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhbHVlID0gb2JqW2ldO1xuICAgICAgICBpZiAodmFsdWUgPiByZXN1bHQpIHtcbiAgICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpdGVyYXRlZSA9IGNiKGl0ZXJhdGVlLCBjb250ZXh0KTtcbiAgICAgIF8uZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgICBjb21wdXRlZCA9IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgbGlzdCk7XG4gICAgICAgIGlmIChjb21wdXRlZCA+IGxhc3RDb21wdXRlZCB8fCBjb21wdXRlZCA9PT0gLUluZmluaXR5ICYmIHJlc3VsdCA9PT0gLUluZmluaXR5KSB7XG4gICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgbGFzdENvbXB1dGVkID0gY29tcHV0ZWQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgbWluaW11bSBlbGVtZW50IChvciBlbGVtZW50LWJhc2VkIGNvbXB1dGF0aW9uKS5cbiAgXy5taW4gPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdCA9IEluZmluaXR5LCBsYXN0Q29tcHV0ZWQgPSBJbmZpbml0eSxcbiAgICAgICAgdmFsdWUsIGNvbXB1dGVkO1xuICAgIGlmIChpdGVyYXRlZSA9PSBudWxsICYmIG9iaiAhPSBudWxsKSB7XG4gICAgICBvYmogPSBpc0FycmF5TGlrZShvYmopID8gb2JqIDogXy52YWx1ZXMob2JqKTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBvYmoubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFsdWUgPSBvYmpbaV07XG4gICAgICAgIGlmICh2YWx1ZSA8IHJlc3VsdCkge1xuICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpO1xuICAgICAgXy5lYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICAgIGNvbXB1dGVkID0gaXRlcmF0ZWUodmFsdWUsIGluZGV4LCBsaXN0KTtcbiAgICAgICAgaWYgKGNvbXB1dGVkIDwgbGFzdENvbXB1dGVkIHx8IGNvbXB1dGVkID09PSBJbmZpbml0eSAmJiByZXN1bHQgPT09IEluZmluaXR5KSB7XG4gICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgbGFzdENvbXB1dGVkID0gY29tcHV0ZWQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFNodWZmbGUgYSBjb2xsZWN0aW9uLCB1c2luZyB0aGUgbW9kZXJuIHZlcnNpb24gb2YgdGhlXG4gIC8vIFtGaXNoZXItWWF0ZXMgc2h1ZmZsZV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GaXNoZXLigJNZYXRlc19zaHVmZmxlKS5cbiAgXy5zaHVmZmxlID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIHNldCA9IGlzQXJyYXlMaWtlKG9iaikgPyBvYmogOiBfLnZhbHVlcyhvYmopO1xuICAgIHZhciBsZW5ndGggPSBzZXQubGVuZ3RoO1xuICAgIHZhciBzaHVmZmxlZCA9IEFycmF5KGxlbmd0aCk7XG4gICAgZm9yICh2YXIgaW5kZXggPSAwLCByYW5kOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgcmFuZCA9IF8ucmFuZG9tKDAsIGluZGV4KTtcbiAgICAgIGlmIChyYW5kICE9PSBpbmRleCkgc2h1ZmZsZWRbaW5kZXhdID0gc2h1ZmZsZWRbcmFuZF07XG4gICAgICBzaHVmZmxlZFtyYW5kXSA9IHNldFtpbmRleF07XG4gICAgfVxuICAgIHJldHVybiBzaHVmZmxlZDtcbiAgfTtcblxuICAvLyBTYW1wbGUgKipuKiogcmFuZG9tIHZhbHVlcyBmcm9tIGEgY29sbGVjdGlvbi5cbiAgLy8gSWYgKipuKiogaXMgbm90IHNwZWNpZmllZCwgcmV0dXJucyBhIHNpbmdsZSByYW5kb20gZWxlbWVudC5cbiAgLy8gVGhlIGludGVybmFsIGBndWFyZGAgYXJndW1lbnQgYWxsb3dzIGl0IHRvIHdvcmsgd2l0aCBgbWFwYC5cbiAgXy5zYW1wbGUgPSBmdW5jdGlvbihvYmosIG4sIGd1YXJkKSB7XG4gICAgaWYgKG4gPT0gbnVsbCB8fCBndWFyZCkge1xuICAgICAgaWYgKCFpc0FycmF5TGlrZShvYmopKSBvYmogPSBfLnZhbHVlcyhvYmopO1xuICAgICAgcmV0dXJuIG9ialtfLnJhbmRvbShvYmoubGVuZ3RoIC0gMSldO1xuICAgIH1cbiAgICByZXR1cm4gXy5zaHVmZmxlKG9iaikuc2xpY2UoMCwgTWF0aC5tYXgoMCwgbikpO1xuICB9O1xuXG4gIC8vIFNvcnQgdGhlIG9iamVjdCdzIHZhbHVlcyBieSBhIGNyaXRlcmlvbiBwcm9kdWNlZCBieSBhbiBpdGVyYXRlZS5cbiAgXy5zb3J0QnkgPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7XG4gICAgcmV0dXJuIF8ucGx1Y2soXy5tYXAob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICBjcml0ZXJpYTogaXRlcmF0ZWUodmFsdWUsIGluZGV4LCBsaXN0KVxuICAgICAgfTtcbiAgICB9KS5zb3J0KGZ1bmN0aW9uKGxlZnQsIHJpZ2h0KSB7XG4gICAgICB2YXIgYSA9IGxlZnQuY3JpdGVyaWE7XG4gICAgICB2YXIgYiA9IHJpZ2h0LmNyaXRlcmlhO1xuICAgICAgaWYgKGEgIT09IGIpIHtcbiAgICAgICAgaWYgKGEgPiBiIHx8IGEgPT09IHZvaWQgMCkgcmV0dXJuIDE7XG4gICAgICAgIGlmIChhIDwgYiB8fCBiID09PSB2b2lkIDApIHJldHVybiAtMTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBsZWZ0LmluZGV4IC0gcmlnaHQuaW5kZXg7XG4gICAgfSksICd2YWx1ZScpO1xuICB9O1xuXG4gIC8vIEFuIGludGVybmFsIGZ1bmN0aW9uIHVzZWQgZm9yIGFnZ3JlZ2F0ZSBcImdyb3VwIGJ5XCIgb3BlcmF0aW9ucy5cbiAgdmFyIGdyb3VwID0gZnVuY3Rpb24oYmVoYXZpb3IpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7XG4gICAgICBfLmVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIGtleSA9IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgb2JqKTtcbiAgICAgICAgYmVoYXZpb3IocmVzdWx0LCB2YWx1ZSwga2V5KTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9O1xuXG4gIC8vIEdyb3VwcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLiBQYXNzIGVpdGhlciBhIHN0cmluZyBhdHRyaWJ1dGVcbiAgLy8gdG8gZ3JvdXAgYnksIG9yIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBjcml0ZXJpb24uXG4gIF8uZ3JvdXBCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkge1xuICAgIGlmIChfLmhhcyhyZXN1bHQsIGtleSkpIHJlc3VsdFtrZXldLnB1c2godmFsdWUpOyBlbHNlIHJlc3VsdFtrZXldID0gW3ZhbHVlXTtcbiAgfSk7XG5cbiAgLy8gSW5kZXhlcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLCBzaW1pbGFyIHRvIGBncm91cEJ5YCwgYnV0IGZvclxuICAvLyB3aGVuIHlvdSBrbm93IHRoYXQgeW91ciBpbmRleCB2YWx1ZXMgd2lsbCBiZSB1bmlxdWUuXG4gIF8uaW5kZXhCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gIH0pO1xuXG4gIC8vIENvdW50cyBpbnN0YW5jZXMgb2YgYW4gb2JqZWN0IHRoYXQgZ3JvdXAgYnkgYSBjZXJ0YWluIGNyaXRlcmlvbi4gUGFzc1xuICAvLyBlaXRoZXIgYSBzdHJpbmcgYXR0cmlidXRlIHRvIGNvdW50IGJ5LCBvciBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGVcbiAgLy8gY3JpdGVyaW9uLlxuICBfLmNvdW50QnkgPSBncm91cChmdW5jdGlvbihyZXN1bHQsIHZhbHVlLCBrZXkpIHtcbiAgICBpZiAoXy5oYXMocmVzdWx0LCBrZXkpKSByZXN1bHRba2V5XSsrOyBlbHNlIHJlc3VsdFtrZXldID0gMTtcbiAgfSk7XG5cbiAgLy8gU2FmZWx5IGNyZWF0ZSBhIHJlYWwsIGxpdmUgYXJyYXkgZnJvbSBhbnl0aGluZyBpdGVyYWJsZS5cbiAgXy50b0FycmF5ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKCFvYmopIHJldHVybiBbXTtcbiAgICBpZiAoXy5pc0FycmF5KG9iaikpIHJldHVybiBzbGljZS5jYWxsKG9iaik7XG4gICAgaWYgKGlzQXJyYXlMaWtlKG9iaikpIHJldHVybiBfLm1hcChvYmosIF8uaWRlbnRpdHkpO1xuICAgIHJldHVybiBfLnZhbHVlcyhvYmopO1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGFuIG9iamVjdC5cbiAgXy5zaXplID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gMDtcbiAgICByZXR1cm4gaXNBcnJheUxpa2Uob2JqKSA/IG9iai5sZW5ndGggOiBfLmtleXMob2JqKS5sZW5ndGg7XG4gIH07XG5cbiAgLy8gU3BsaXQgYSBjb2xsZWN0aW9uIGludG8gdHdvIGFycmF5czogb25lIHdob3NlIGVsZW1lbnRzIGFsbCBzYXRpc2Z5IHRoZSBnaXZlblxuICAvLyBwcmVkaWNhdGUsIGFuZCBvbmUgd2hvc2UgZWxlbWVudHMgYWxsIGRvIG5vdCBzYXRpc2Z5IHRoZSBwcmVkaWNhdGUuXG4gIF8ucGFydGl0aW9uID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIHZhciBwYXNzID0gW10sIGZhaWwgPSBbXTtcbiAgICBfLmVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBvYmopIHtcbiAgICAgIChwcmVkaWNhdGUodmFsdWUsIGtleSwgb2JqKSA/IHBhc3MgOiBmYWlsKS5wdXNoKHZhbHVlKTtcbiAgICB9KTtcbiAgICByZXR1cm4gW3Bhc3MsIGZhaWxdO1xuICB9O1xuXG4gIC8vIEFycmF5IEZ1bmN0aW9uc1xuICAvLyAtLS0tLS0tLS0tLS0tLS1cblxuICAvLyBHZXQgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYW4gYXJyYXkuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gdGhlIGZpcnN0IE5cbiAgLy8gdmFsdWVzIGluIHRoZSBhcnJheS4gQWxpYXNlZCBhcyBgaGVhZGAgYW5kIGB0YWtlYC4gVGhlICoqZ3VhcmQqKiBjaGVja1xuICAvLyBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBfLm1hcGAuXG4gIF8uZmlyc3QgPSBfLmhlYWQgPSBfLnRha2UgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHtcbiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIHZvaWQgMDtcbiAgICBpZiAobiA9PSBudWxsIHx8IGd1YXJkKSByZXR1cm4gYXJyYXlbMF07XG4gICAgcmV0dXJuIF8uaW5pdGlhbChhcnJheSwgYXJyYXkubGVuZ3RoIC0gbik7XG4gIH07XG5cbiAgLy8gUmV0dXJucyBldmVyeXRoaW5nIGJ1dCB0aGUgbGFzdCBlbnRyeSBvZiB0aGUgYXJyYXkuIEVzcGVjaWFsbHkgdXNlZnVsIG9uXG4gIC8vIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIGFsbCB0aGUgdmFsdWVzIGluXG4gIC8vIHRoZSBhcnJheSwgZXhjbHVkaW5nIHRoZSBsYXN0IE4uXG4gIF8uaW5pdGlhbCA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkge1xuICAgIHJldHVybiBzbGljZS5jYWxsKGFycmF5LCAwLCBNYXRoLm1heCgwLCBhcnJheS5sZW5ndGggLSAobiA9PSBudWxsIHx8IGd1YXJkID8gMSA6IG4pKSk7XG4gIH07XG5cbiAgLy8gR2V0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXkuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gdGhlIGxhc3QgTlxuICAvLyB2YWx1ZXMgaW4gdGhlIGFycmF5LlxuICBfLmxhc3QgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHtcbiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIHZvaWQgMDtcbiAgICBpZiAobiA9PSBudWxsIHx8IGd1YXJkKSByZXR1cm4gYXJyYXlbYXJyYXkubGVuZ3RoIC0gMV07XG4gICAgcmV0dXJuIF8ucmVzdChhcnJheSwgTWF0aC5tYXgoMCwgYXJyYXkubGVuZ3RoIC0gbikpO1xuICB9O1xuXG4gIC8vIFJldHVybnMgZXZlcnl0aGluZyBidXQgdGhlIGZpcnN0IGVudHJ5IG9mIHRoZSBhcnJheS4gQWxpYXNlZCBhcyBgdGFpbGAgYW5kIGBkcm9wYC5cbiAgLy8gRXNwZWNpYWxseSB1c2VmdWwgb24gdGhlIGFyZ3VtZW50cyBvYmplY3QuIFBhc3NpbmcgYW4gKipuKiogd2lsbCByZXR1cm5cbiAgLy8gdGhlIHJlc3QgTiB2YWx1ZXMgaW4gdGhlIGFycmF5LlxuICBfLnJlc3QgPSBfLnRhaWwgPSBfLmRyb3AgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHtcbiAgICByZXR1cm4gc2xpY2UuY2FsbChhcnJheSwgbiA9PSBudWxsIHx8IGd1YXJkID8gMSA6IG4pO1xuICB9O1xuXG4gIC8vIFRyaW0gb3V0IGFsbCBmYWxzeSB2YWx1ZXMgZnJvbSBhbiBhcnJheS5cbiAgXy5jb21wYWN0ID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICByZXR1cm4gXy5maWx0ZXIoYXJyYXksIF8uaWRlbnRpdHkpO1xuICB9O1xuXG4gIC8vIEludGVybmFsIGltcGxlbWVudGF0aW9uIG9mIGEgcmVjdXJzaXZlIGBmbGF0dGVuYCBmdW5jdGlvbi5cbiAgdmFyIGZsYXR0ZW4gPSBmdW5jdGlvbihpbnB1dCwgc2hhbGxvdywgc3RyaWN0LCBzdGFydEluZGV4KSB7XG4gICAgdmFyIG91dHB1dCA9IFtdLCBpZHggPSAwO1xuICAgIGZvciAodmFyIGkgPSBzdGFydEluZGV4IHx8IDAsIGxlbmd0aCA9IGdldExlbmd0aChpbnB1dCk7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHZhbHVlID0gaW5wdXRbaV07XG4gICAgICBpZiAoaXNBcnJheUxpa2UodmFsdWUpICYmIChfLmlzQXJyYXkodmFsdWUpIHx8IF8uaXNBcmd1bWVudHModmFsdWUpKSkge1xuICAgICAgICAvL2ZsYXR0ZW4gY3VycmVudCBsZXZlbCBvZiBhcnJheSBvciBhcmd1bWVudHMgb2JqZWN0XG4gICAgICAgIGlmICghc2hhbGxvdykgdmFsdWUgPSBmbGF0dGVuKHZhbHVlLCBzaGFsbG93LCBzdHJpY3QpO1xuICAgICAgICB2YXIgaiA9IDAsIGxlbiA9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgb3V0cHV0Lmxlbmd0aCArPSBsZW47XG4gICAgICAgIHdoaWxlIChqIDwgbGVuKSB7XG4gICAgICAgICAgb3V0cHV0W2lkeCsrXSA9IHZhbHVlW2orK107XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoIXN0cmljdCkge1xuICAgICAgICBvdXRwdXRbaWR4KytdID0gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQ7XG4gIH07XG5cbiAgLy8gRmxhdHRlbiBvdXQgYW4gYXJyYXksIGVpdGhlciByZWN1cnNpdmVseSAoYnkgZGVmYXVsdCksIG9yIGp1c3Qgb25lIGxldmVsLlxuICBfLmZsYXR0ZW4gPSBmdW5jdGlvbihhcnJheSwgc2hhbGxvdykge1xuICAgIHJldHVybiBmbGF0dGVuKGFycmF5LCBzaGFsbG93LCBmYWxzZSk7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgdmVyc2lvbiBvZiB0aGUgYXJyYXkgdGhhdCBkb2VzIG5vdCBjb250YWluIHRoZSBzcGVjaWZpZWQgdmFsdWUocykuXG4gIF8ud2l0aG91dCA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgcmV0dXJuIF8uZGlmZmVyZW5jZShhcnJheSwgc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgfTtcblxuICAvLyBQcm9kdWNlIGEgZHVwbGljYXRlLWZyZWUgdmVyc2lvbiBvZiB0aGUgYXJyYXkuIElmIHRoZSBhcnJheSBoYXMgYWxyZWFkeVxuICAvLyBiZWVuIHNvcnRlZCwgeW91IGhhdmUgdGhlIG9wdGlvbiBvZiB1c2luZyBhIGZhc3RlciBhbGdvcml0aG0uXG4gIC8vIEFsaWFzZWQgYXMgYHVuaXF1ZWAuXG4gIF8udW5pcSA9IF8udW5pcXVlID0gZnVuY3Rpb24oYXJyYXksIGlzU29ydGVkLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgIGlmICghXy5pc0Jvb2xlYW4oaXNTb3J0ZWQpKSB7XG4gICAgICBjb250ZXh0ID0gaXRlcmF0ZWU7XG4gICAgICBpdGVyYXRlZSA9IGlzU29ydGVkO1xuICAgICAgaXNTb3J0ZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGl0ZXJhdGVlICE9IG51bGwpIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpO1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB2YXIgc2VlbiA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBnZXRMZW5ndGgoYXJyYXkpOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2ldLFxuICAgICAgICAgIGNvbXB1dGVkID0gaXRlcmF0ZWUgPyBpdGVyYXRlZSh2YWx1ZSwgaSwgYXJyYXkpIDogdmFsdWU7XG4gICAgICBpZiAoaXNTb3J0ZWQpIHtcbiAgICAgICAgaWYgKCFpIHx8IHNlZW4gIT09IGNvbXB1dGVkKSByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICAgIHNlZW4gPSBjb21wdXRlZDtcbiAgICAgIH0gZWxzZSBpZiAoaXRlcmF0ZWUpIHtcbiAgICAgICAgaWYgKCFfLmNvbnRhaW5zKHNlZW4sIGNvbXB1dGVkKSkge1xuICAgICAgICAgIHNlZW4ucHVzaChjb21wdXRlZCk7XG4gICAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKCFfLmNvbnRhaW5zKHJlc3VsdCwgdmFsdWUpKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBQcm9kdWNlIGFuIGFycmF5IHRoYXQgY29udGFpbnMgdGhlIHVuaW9uOiBlYWNoIGRpc3RpbmN0IGVsZW1lbnQgZnJvbSBhbGwgb2ZcbiAgLy8gdGhlIHBhc3NlZC1pbiBhcnJheXMuXG4gIF8udW5pb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gXy51bmlxKGZsYXR0ZW4oYXJndW1lbnRzLCB0cnVlLCB0cnVlKSk7XG4gIH07XG5cbiAgLy8gUHJvZHVjZSBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIGV2ZXJ5IGl0ZW0gc2hhcmVkIGJldHdlZW4gYWxsIHRoZVxuICAvLyBwYXNzZWQtaW4gYXJyYXlzLlxuICBfLmludGVyc2VjdGlvbiA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIHZhciBhcmdzTGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gZ2V0TGVuZ3RoKGFycmF5KTsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgaXRlbSA9IGFycmF5W2ldO1xuICAgICAgaWYgKF8uY29udGFpbnMocmVzdWx0LCBpdGVtKSkgY29udGludWU7XG4gICAgICBmb3IgKHZhciBqID0gMTsgaiA8IGFyZ3NMZW5ndGg7IGorKykge1xuICAgICAgICBpZiAoIV8uY29udGFpbnMoYXJndW1lbnRzW2pdLCBpdGVtKSkgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAoaiA9PT0gYXJnc0xlbmd0aCkgcmVzdWx0LnB1c2goaXRlbSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgLy8gVGFrZSB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIG9uZSBhcnJheSBhbmQgYSBudW1iZXIgb2Ygb3RoZXIgYXJyYXlzLlxuICAvLyBPbmx5IHRoZSBlbGVtZW50cyBwcmVzZW50IGluIGp1c3QgdGhlIGZpcnN0IGFycmF5IHdpbGwgcmVtYWluLlxuICBfLmRpZmZlcmVuY2UgPSBmdW5jdGlvbihhcnJheSkge1xuICAgIHZhciByZXN0ID0gZmxhdHRlbihhcmd1bWVudHMsIHRydWUsIHRydWUsIDEpO1xuICAgIHJldHVybiBfLmZpbHRlcihhcnJheSwgZnVuY3Rpb24odmFsdWUpe1xuICAgICAgcmV0dXJuICFfLmNvbnRhaW5zKHJlc3QsIHZhbHVlKTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBaaXAgdG9nZXRoZXIgbXVsdGlwbGUgbGlzdHMgaW50byBhIHNpbmdsZSBhcnJheSAtLSBlbGVtZW50cyB0aGF0IHNoYXJlXG4gIC8vIGFuIGluZGV4IGdvIHRvZ2V0aGVyLlxuICBfLnppcCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfLnVuemlwKGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgLy8gQ29tcGxlbWVudCBvZiBfLnppcC4gVW56aXAgYWNjZXB0cyBhbiBhcnJheSBvZiBhcnJheXMgYW5kIGdyb3Vwc1xuICAvLyBlYWNoIGFycmF5J3MgZWxlbWVudHMgb24gc2hhcmVkIGluZGljZXNcbiAgXy51bnppcCA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgdmFyIGxlbmd0aCA9IGFycmF5ICYmIF8ubWF4KGFycmF5LCBnZXRMZW5ndGgpLmxlbmd0aCB8fCAwO1xuICAgIHZhciByZXN1bHQgPSBBcnJheShsZW5ndGgpO1xuXG4gICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgcmVzdWx0W2luZGV4XSA9IF8ucGx1Y2soYXJyYXksIGluZGV4KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBDb252ZXJ0cyBsaXN0cyBpbnRvIG9iamVjdHMuIFBhc3MgZWl0aGVyIGEgc2luZ2xlIGFycmF5IG9mIGBba2V5LCB2YWx1ZV1gXG4gIC8vIHBhaXJzLCBvciB0d28gcGFyYWxsZWwgYXJyYXlzIG9mIHRoZSBzYW1lIGxlbmd0aCAtLSBvbmUgb2Yga2V5cywgYW5kIG9uZSBvZlxuICAvLyB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZXMuXG4gIF8ub2JqZWN0ID0gZnVuY3Rpb24obGlzdCwgdmFsdWVzKSB7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBnZXRMZW5ndGgobGlzdCk7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHZhbHVlcykge1xuICAgICAgICByZXN1bHRbbGlzdFtpXV0gPSB2YWx1ZXNbaV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRbbGlzdFtpXVswXV0gPSBsaXN0W2ldWzFdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIEdlbmVyYXRvciBmdW5jdGlvbiB0byBjcmVhdGUgdGhlIGZpbmRJbmRleCBhbmQgZmluZExhc3RJbmRleCBmdW5jdGlvbnNcbiAgZnVuY3Rpb24gY3JlYXRlUHJlZGljYXRlSW5kZXhGaW5kZXIoZGlyKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGFycmF5LCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7XG4gICAgICB2YXIgbGVuZ3RoID0gZ2V0TGVuZ3RoKGFycmF5KTtcbiAgICAgIHZhciBpbmRleCA9IGRpciA+IDAgPyAwIDogbGVuZ3RoIC0gMTtcbiAgICAgIGZvciAoOyBpbmRleCA+PSAwICYmIGluZGV4IDwgbGVuZ3RoOyBpbmRleCArPSBkaXIpIHtcbiAgICAgICAgaWYgKHByZWRpY2F0ZShhcnJheVtpbmRleF0sIGluZGV4LCBhcnJheSkpIHJldHVybiBpbmRleDtcbiAgICAgIH1cbiAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICB9XG5cbiAgLy8gUmV0dXJucyB0aGUgZmlyc3QgaW5kZXggb24gYW4gYXJyYXktbGlrZSB0aGF0IHBhc3NlcyBhIHByZWRpY2F0ZSB0ZXN0XG4gIF8uZmluZEluZGV4ID0gY3JlYXRlUHJlZGljYXRlSW5kZXhGaW5kZXIoMSk7XG4gIF8uZmluZExhc3RJbmRleCA9IGNyZWF0ZVByZWRpY2F0ZUluZGV4RmluZGVyKC0xKTtcblxuICAvLyBVc2UgYSBjb21wYXJhdG9yIGZ1bmN0aW9uIHRvIGZpZ3VyZSBvdXQgdGhlIHNtYWxsZXN0IGluZGV4IGF0IHdoaWNoXG4gIC8vIGFuIG9iamVjdCBzaG91bGQgYmUgaW5zZXJ0ZWQgc28gYXMgdG8gbWFpbnRhaW4gb3JkZXIuIFVzZXMgYmluYXJ5IHNlYXJjaC5cbiAgXy5zb3J0ZWRJbmRleCA9IGZ1bmN0aW9uKGFycmF5LCBvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCwgMSk7XG4gICAgdmFyIHZhbHVlID0gaXRlcmF0ZWUob2JqKTtcbiAgICB2YXIgbG93ID0gMCwgaGlnaCA9IGdldExlbmd0aChhcnJheSk7XG4gICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHtcbiAgICAgIHZhciBtaWQgPSBNYXRoLmZsb29yKChsb3cgKyBoaWdoKSAvIDIpO1xuICAgICAgaWYgKGl0ZXJhdGVlKGFycmF5W21pZF0pIDwgdmFsdWUpIGxvdyA9IG1pZCArIDE7IGVsc2UgaGlnaCA9IG1pZDtcbiAgICB9XG4gICAgcmV0dXJuIGxvdztcbiAgfTtcblxuICAvLyBHZW5lcmF0b3IgZnVuY3Rpb24gdG8gY3JlYXRlIHRoZSBpbmRleE9mIGFuZCBsYXN0SW5kZXhPZiBmdW5jdGlvbnNcbiAgZnVuY3Rpb24gY3JlYXRlSW5kZXhGaW5kZXIoZGlyLCBwcmVkaWNhdGVGaW5kLCBzb3J0ZWRJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbihhcnJheSwgaXRlbSwgaWR4KSB7XG4gICAgICB2YXIgaSA9IDAsIGxlbmd0aCA9IGdldExlbmd0aChhcnJheSk7XG4gICAgICBpZiAodHlwZW9mIGlkeCA9PSAnbnVtYmVyJykge1xuICAgICAgICBpZiAoZGlyID4gMCkge1xuICAgICAgICAgICAgaSA9IGlkeCA+PSAwID8gaWR4IDogTWF0aC5tYXgoaWR4ICsgbGVuZ3RoLCBpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxlbmd0aCA9IGlkeCA+PSAwID8gTWF0aC5taW4oaWR4ICsgMSwgbGVuZ3RoKSA6IGlkeCArIGxlbmd0aCArIDE7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoc29ydGVkSW5kZXggJiYgaWR4ICYmIGxlbmd0aCkge1xuICAgICAgICBpZHggPSBzb3J0ZWRJbmRleChhcnJheSwgaXRlbSk7XG4gICAgICAgIHJldHVybiBhcnJheVtpZHhdID09PSBpdGVtID8gaWR4IDogLTE7XG4gICAgICB9XG4gICAgICBpZiAoaXRlbSAhPT0gaXRlbSkge1xuICAgICAgICBpZHggPSBwcmVkaWNhdGVGaW5kKHNsaWNlLmNhbGwoYXJyYXksIGksIGxlbmd0aCksIF8uaXNOYU4pO1xuICAgICAgICByZXR1cm4gaWR4ID49IDAgPyBpZHggKyBpIDogLTE7XG4gICAgICB9XG4gICAgICBmb3IgKGlkeCA9IGRpciA+IDAgPyBpIDogbGVuZ3RoIC0gMTsgaWR4ID49IDAgJiYgaWR4IDwgbGVuZ3RoOyBpZHggKz0gZGlyKSB7XG4gICAgICAgIGlmIChhcnJheVtpZHhdID09PSBpdGVtKSByZXR1cm4gaWR4O1xuICAgICAgfVxuICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gIH1cblxuICAvLyBSZXR1cm4gdGhlIHBvc2l0aW9uIG9mIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGl0ZW0gaW4gYW4gYXJyYXksXG4gIC8vIG9yIC0xIGlmIHRoZSBpdGVtIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGUgYXJyYXkuXG4gIC8vIElmIHRoZSBhcnJheSBpcyBsYXJnZSBhbmQgYWxyZWFkeSBpbiBzb3J0IG9yZGVyLCBwYXNzIGB0cnVlYFxuICAvLyBmb3IgKippc1NvcnRlZCoqIHRvIHVzZSBiaW5hcnkgc2VhcmNoLlxuICBfLmluZGV4T2YgPSBjcmVhdGVJbmRleEZpbmRlcigxLCBfLmZpbmRJbmRleCwgXy5zb3J0ZWRJbmRleCk7XG4gIF8ubGFzdEluZGV4T2YgPSBjcmVhdGVJbmRleEZpbmRlcigtMSwgXy5maW5kTGFzdEluZGV4KTtcblxuICAvLyBHZW5lcmF0ZSBhbiBpbnRlZ2VyIEFycmF5IGNvbnRhaW5pbmcgYW4gYXJpdGhtZXRpYyBwcm9ncmVzc2lvbi4gQSBwb3J0IG9mXG4gIC8vIHRoZSBuYXRpdmUgUHl0aG9uIGByYW5nZSgpYCBmdW5jdGlvbi4gU2VlXG4gIC8vIFt0aGUgUHl0aG9uIGRvY3VtZW50YXRpb25dKGh0dHA6Ly9kb2NzLnB5dGhvbi5vcmcvbGlicmFyeS9mdW5jdGlvbnMuaHRtbCNyYW5nZSkuXG4gIF8ucmFuZ2UgPSBmdW5jdGlvbihzdGFydCwgc3RvcCwgc3RlcCkge1xuICAgIGlmIChzdG9wID09IG51bGwpIHtcbiAgICAgIHN0b3AgPSBzdGFydCB8fCAwO1xuICAgICAgc3RhcnQgPSAwO1xuICAgIH1cbiAgICBzdGVwID0gc3RlcCB8fCAxO1xuXG4gICAgdmFyIGxlbmd0aCA9IE1hdGgubWF4KE1hdGguY2VpbCgoc3RvcCAtIHN0YXJ0KSAvIHN0ZXApLCAwKTtcbiAgICB2YXIgcmFuZ2UgPSBBcnJheShsZW5ndGgpO1xuXG4gICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKywgc3RhcnQgKz0gc3RlcCkge1xuICAgICAgcmFuZ2VbaWR4XSA9IHN0YXJ0O1xuICAgIH1cblxuICAgIHJldHVybiByYW5nZTtcbiAgfTtcblxuICAvLyBGdW5jdGlvbiAoYWhlbSkgRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIERldGVybWluZXMgd2hldGhlciB0byBleGVjdXRlIGEgZnVuY3Rpb24gYXMgYSBjb25zdHJ1Y3RvclxuICAvLyBvciBhIG5vcm1hbCBmdW5jdGlvbiB3aXRoIHRoZSBwcm92aWRlZCBhcmd1bWVudHNcbiAgdmFyIGV4ZWN1dGVCb3VuZCA9IGZ1bmN0aW9uKHNvdXJjZUZ1bmMsIGJvdW5kRnVuYywgY29udGV4dCwgY2FsbGluZ0NvbnRleHQsIGFyZ3MpIHtcbiAgICBpZiAoIShjYWxsaW5nQ29udGV4dCBpbnN0YW5jZW9mIGJvdW5kRnVuYykpIHJldHVybiBzb3VyY2VGdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgIHZhciBzZWxmID0gYmFzZUNyZWF0ZShzb3VyY2VGdW5jLnByb3RvdHlwZSk7XG4gICAgdmFyIHJlc3VsdCA9IHNvdXJjZUZ1bmMuYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgaWYgKF8uaXNPYmplY3QocmVzdWx0KSkgcmV0dXJuIHJlc3VsdDtcbiAgICByZXR1cm4gc2VsZjtcbiAgfTtcblxuICAvLyBDcmVhdGUgYSBmdW5jdGlvbiBib3VuZCB0byBhIGdpdmVuIG9iamVjdCAoYXNzaWduaW5nIGB0aGlzYCwgYW5kIGFyZ3VtZW50cyxcbiAgLy8gb3B0aW9uYWxseSkuIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBGdW5jdGlvbi5iaW5kYCBpZlxuICAvLyBhdmFpbGFibGUuXG4gIF8uYmluZCA9IGZ1bmN0aW9uKGZ1bmMsIGNvbnRleHQpIHtcbiAgICBpZiAobmF0aXZlQmluZCAmJiBmdW5jLmJpbmQgPT09IG5hdGl2ZUJpbmQpIHJldHVybiBuYXRpdmVCaW5kLmFwcGx5KGZ1bmMsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgaWYgKCFfLmlzRnVuY3Rpb24oZnVuYykpIHRocm93IG5ldyBUeXBlRXJyb3IoJ0JpbmQgbXVzdCBiZSBjYWxsZWQgb24gYSBmdW5jdGlvbicpO1xuICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuICAgIHZhciBib3VuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGV4ZWN1dGVCb3VuZChmdW5jLCBib3VuZCwgY29udGV4dCwgdGhpcywgYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7XG4gICAgfTtcbiAgICByZXR1cm4gYm91bmQ7XG4gIH07XG5cbiAgLy8gUGFydGlhbGx5IGFwcGx5IGEgZnVuY3Rpb24gYnkgY3JlYXRpbmcgYSB2ZXJzaW9uIHRoYXQgaGFzIGhhZCBzb21lIG9mIGl0c1xuICAvLyBhcmd1bWVudHMgcHJlLWZpbGxlZCwgd2l0aG91dCBjaGFuZ2luZyBpdHMgZHluYW1pYyBgdGhpc2AgY29udGV4dC4gXyBhY3RzXG4gIC8vIGFzIGEgcGxhY2Vob2xkZXIsIGFsbG93aW5nIGFueSBjb21iaW5hdGlvbiBvZiBhcmd1bWVudHMgdG8gYmUgcHJlLWZpbGxlZC5cbiAgXy5wYXJ0aWFsID0gZnVuY3Rpb24oZnVuYykge1xuICAgIHZhciBib3VuZEFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgdmFyIGJvdW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcG9zaXRpb24gPSAwLCBsZW5ndGggPSBib3VuZEFyZ3MubGVuZ3RoO1xuICAgICAgdmFyIGFyZ3MgPSBBcnJheShsZW5ndGgpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBhcmdzW2ldID0gYm91bmRBcmdzW2ldID09PSBfID8gYXJndW1lbnRzW3Bvc2l0aW9uKytdIDogYm91bmRBcmdzW2ldO1xuICAgICAgfVxuICAgICAgd2hpbGUgKHBvc2l0aW9uIDwgYXJndW1lbnRzLmxlbmd0aCkgYXJncy5wdXNoKGFyZ3VtZW50c1twb3NpdGlvbisrXSk7XG4gICAgICByZXR1cm4gZXhlY3V0ZUJvdW5kKGZ1bmMsIGJvdW5kLCB0aGlzLCB0aGlzLCBhcmdzKTtcbiAgICB9O1xuICAgIHJldHVybiBib3VuZDtcbiAgfTtcblxuICAvLyBCaW5kIGEgbnVtYmVyIG9mIGFuIG9iamVjdCdzIG1ldGhvZHMgdG8gdGhhdCBvYmplY3QuIFJlbWFpbmluZyBhcmd1bWVudHNcbiAgLy8gYXJlIHRoZSBtZXRob2QgbmFtZXMgdG8gYmUgYm91bmQuIFVzZWZ1bCBmb3IgZW5zdXJpbmcgdGhhdCBhbGwgY2FsbGJhY2tzXG4gIC8vIGRlZmluZWQgb24gYW4gb2JqZWN0IGJlbG9uZyB0byBpdC5cbiAgXy5iaW5kQWxsID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIGksIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsIGtleTtcbiAgICBpZiAobGVuZ3RoIDw9IDEpIHRocm93IG5ldyBFcnJvcignYmluZEFsbCBtdXN0IGJlIHBhc3NlZCBmdW5jdGlvbiBuYW1lcycpO1xuICAgIGZvciAoaSA9IDE7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAga2V5ID0gYXJndW1lbnRzW2ldO1xuICAgICAgb2JqW2tleV0gPSBfLmJpbmQob2JqW2tleV0sIG9iaik7XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gTWVtb2l6ZSBhbiBleHBlbnNpdmUgZnVuY3Rpb24gYnkgc3RvcmluZyBpdHMgcmVzdWx0cy5cbiAgXy5tZW1vaXplID0gZnVuY3Rpb24oZnVuYywgaGFzaGVyKSB7XG4gICAgdmFyIG1lbW9pemUgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHZhciBjYWNoZSA9IG1lbW9pemUuY2FjaGU7XG4gICAgICB2YXIgYWRkcmVzcyA9ICcnICsgKGhhc2hlciA/IGhhc2hlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIDoga2V5KTtcbiAgICAgIGlmICghXy5oYXMoY2FjaGUsIGFkZHJlc3MpKSBjYWNoZVthZGRyZXNzXSA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHJldHVybiBjYWNoZVthZGRyZXNzXTtcbiAgICB9O1xuICAgIG1lbW9pemUuY2FjaGUgPSB7fTtcbiAgICByZXR1cm4gbWVtb2l6ZTtcbiAgfTtcblxuICAvLyBEZWxheXMgYSBmdW5jdGlvbiBmb3IgdGhlIGdpdmVuIG51bWJlciBvZiBtaWxsaXNlY29uZHMsIGFuZCB0aGVuIGNhbGxzXG4gIC8vIGl0IHdpdGggdGhlIGFyZ3VtZW50cyBzdXBwbGllZC5cbiAgXy5kZWxheSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQpIHtcbiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcbiAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkobnVsbCwgYXJncyk7XG4gICAgfSwgd2FpdCk7XG4gIH07XG5cbiAgLy8gRGVmZXJzIGEgZnVuY3Rpb24sIHNjaGVkdWxpbmcgaXQgdG8gcnVuIGFmdGVyIHRoZSBjdXJyZW50IGNhbGwgc3RhY2sgaGFzXG4gIC8vIGNsZWFyZWQuXG4gIF8uZGVmZXIgPSBfLnBhcnRpYWwoXy5kZWxheSwgXywgMSk7XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCB3aGVuIGludm9rZWQsIHdpbGwgb25seSBiZSB0cmlnZ2VyZWQgYXQgbW9zdCBvbmNlXG4gIC8vIGR1cmluZyBhIGdpdmVuIHdpbmRvdyBvZiB0aW1lLiBOb3JtYWxseSwgdGhlIHRocm90dGxlZCBmdW5jdGlvbiB3aWxsIHJ1blxuICAvLyBhcyBtdWNoIGFzIGl0IGNhbiwgd2l0aG91dCBldmVyIGdvaW5nIG1vcmUgdGhhbiBvbmNlIHBlciBgd2FpdGAgZHVyYXRpb247XG4gIC8vIGJ1dCBpZiB5b3UnZCBsaWtlIHRvIGRpc2FibGUgdGhlIGV4ZWN1dGlvbiBvbiB0aGUgbGVhZGluZyBlZGdlLCBwYXNzXG4gIC8vIGB7bGVhZGluZzogZmFsc2V9YC4gVG8gZGlzYWJsZSBleGVjdXRpb24gb24gdGhlIHRyYWlsaW5nIGVkZ2UsIGRpdHRvLlxuICBfLnRocm90dGxlID0gZnVuY3Rpb24oZnVuYywgd2FpdCwgb3B0aW9ucykge1xuICAgIHZhciBjb250ZXh0LCBhcmdzLCByZXN1bHQ7XG4gICAgdmFyIHRpbWVvdXQgPSBudWxsO1xuICAgIHZhciBwcmV2aW91cyA9IDA7XG4gICAgaWYgKCFvcHRpb25zKSBvcHRpb25zID0ge307XG4gICAgdmFyIGxhdGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICBwcmV2aW91cyA9IG9wdGlvbnMubGVhZGluZyA9PT0gZmFsc2UgPyAwIDogXy5ub3coKTtcbiAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgIGlmICghdGltZW91dCkgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG5vdyA9IF8ubm93KCk7XG4gICAgICBpZiAoIXByZXZpb3VzICYmIG9wdGlvbnMubGVhZGluZyA9PT0gZmFsc2UpIHByZXZpb3VzID0gbm93O1xuICAgICAgdmFyIHJlbWFpbmluZyA9IHdhaXQgLSAobm93IC0gcHJldmlvdXMpO1xuICAgICAgY29udGV4dCA9IHRoaXM7XG4gICAgICBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgaWYgKHJlbWFpbmluZyA8PSAwIHx8IHJlbWFpbmluZyA+IHdhaXQpIHtcbiAgICAgICAgaWYgKHRpbWVvdXQpIHtcbiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcHJldmlvdXMgPSBub3c7XG4gICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgIGlmICghdGltZW91dCkgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgICAgfSBlbHNlIGlmICghdGltZW91dCAmJiBvcHRpb25zLnRyYWlsaW5nICE9PSBmYWxzZSkge1xuICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgcmVtYWluaW5nKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24sIHRoYXQsIGFzIGxvbmcgYXMgaXQgY29udGludWVzIHRvIGJlIGludm9rZWQsIHdpbGwgbm90XG4gIC8vIGJlIHRyaWdnZXJlZC4gVGhlIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGFmdGVyIGl0IHN0b3BzIGJlaW5nIGNhbGxlZCBmb3JcbiAgLy8gTiBtaWxsaXNlY29uZHMuIElmIGBpbW1lZGlhdGVgIGlzIHBhc3NlZCwgdHJpZ2dlciB0aGUgZnVuY3Rpb24gb24gdGhlXG4gIC8vIGxlYWRpbmcgZWRnZSwgaW5zdGVhZCBvZiB0aGUgdHJhaWxpbmcuXG4gIF8uZGVib3VuY2UgPSBmdW5jdGlvbihmdW5jLCB3YWl0LCBpbW1lZGlhdGUpIHtcbiAgICB2YXIgdGltZW91dCwgYXJncywgY29udGV4dCwgdGltZXN0YW1wLCByZXN1bHQ7XG5cbiAgICB2YXIgbGF0ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBsYXN0ID0gXy5ub3coKSAtIHRpbWVzdGFtcDtcblxuICAgICAgaWYgKGxhc3QgPCB3YWl0ICYmIGxhc3QgPj0gMCkge1xuICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCAtIGxhc3QpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgIGlmICghaW1tZWRpYXRlKSB7XG4gICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICBpZiAoIXRpbWVvdXQpIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBjb250ZXh0ID0gdGhpcztcbiAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICB0aW1lc3RhbXAgPSBfLm5vdygpO1xuICAgICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgICBpZiAoIXRpbWVvdXQpIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTtcbiAgICAgIGlmIChjYWxsTm93KSB7XG4gICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgdGhlIGZpcnN0IGZ1bmN0aW9uIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB0byB0aGUgc2Vjb25kLFxuICAvLyBhbGxvd2luZyB5b3UgdG8gYWRqdXN0IGFyZ3VtZW50cywgcnVuIGNvZGUgYmVmb3JlIGFuZCBhZnRlciwgYW5kXG4gIC8vIGNvbmRpdGlvbmFsbHkgZXhlY3V0ZSB0aGUgb3JpZ2luYWwgZnVuY3Rpb24uXG4gIF8ud3JhcCA9IGZ1bmN0aW9uKGZ1bmMsIHdyYXBwZXIpIHtcbiAgICByZXR1cm4gXy5wYXJ0aWFsKHdyYXBwZXIsIGZ1bmMpO1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBuZWdhdGVkIHZlcnNpb24gb2YgdGhlIHBhc3NlZC1pbiBwcmVkaWNhdGUuXG4gIF8ubmVnYXRlID0gZnVuY3Rpb24ocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICFwcmVkaWNhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGlzIHRoZSBjb21wb3NpdGlvbiBvZiBhIGxpc3Qgb2YgZnVuY3Rpb25zLCBlYWNoXG4gIC8vIGNvbnN1bWluZyB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBmdW5jdGlvbiB0aGF0IGZvbGxvd3MuXG4gIF8uY29tcG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgIHZhciBzdGFydCA9IGFyZ3MubGVuZ3RoIC0gMTtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgaSA9IHN0YXJ0O1xuICAgICAgdmFyIHJlc3VsdCA9IGFyZ3Nbc3RhcnRdLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB3aGlsZSAoaS0tKSByZXN1bHQgPSBhcmdzW2ldLmNhbGwodGhpcywgcmVzdWx0KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aWxsIG9ubHkgYmUgZXhlY3V0ZWQgb24gYW5kIGFmdGVyIHRoZSBOdGggY2FsbC5cbiAgXy5hZnRlciA9IGZ1bmN0aW9uKHRpbWVzLCBmdW5jKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKC0tdGltZXMgPCAxKSB7XG4gICAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aWxsIG9ubHkgYmUgZXhlY3V0ZWQgdXAgdG8gKGJ1dCBub3QgaW5jbHVkaW5nKSB0aGUgTnRoIGNhbGwuXG4gIF8uYmVmb3JlID0gZnVuY3Rpb24odGltZXMsIGZ1bmMpIHtcbiAgICB2YXIgbWVtbztcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoLS10aW1lcyA+IDApIHtcbiAgICAgICAgbWVtbyA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aW1lcyA8PSAxKSBmdW5jID0gbnVsbDtcbiAgICAgIHJldHVybiBtZW1vO1xuICAgIH07XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBleGVjdXRlZCBhdCBtb3N0IG9uZSB0aW1lLCBubyBtYXR0ZXIgaG93XG4gIC8vIG9mdGVuIHlvdSBjYWxsIGl0LiBVc2VmdWwgZm9yIGxhenkgaW5pdGlhbGl6YXRpb24uXG4gIF8ub25jZSA9IF8ucGFydGlhbChfLmJlZm9yZSwgMik7XG5cbiAgLy8gT2JqZWN0IEZ1bmN0aW9uc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gS2V5cyBpbiBJRSA8IDkgdGhhdCB3b24ndCBiZSBpdGVyYXRlZCBieSBgZm9yIGtleSBpbiAuLi5gIGFuZCB0aHVzIG1pc3NlZC5cbiAgdmFyIGhhc0VudW1CdWcgPSAhe3RvU3RyaW5nOiBudWxsfS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgndG9TdHJpbmcnKTtcbiAgdmFyIG5vbkVudW1lcmFibGVQcm9wcyA9IFsndmFsdWVPZicsICdpc1Byb3RvdHlwZU9mJywgJ3RvU3RyaW5nJyxcbiAgICAgICAgICAgICAgICAgICAgICAncHJvcGVydHlJc0VudW1lcmFibGUnLCAnaGFzT3duUHJvcGVydHknLCAndG9Mb2NhbGVTdHJpbmcnXTtcblxuICBmdW5jdGlvbiBjb2xsZWN0Tm9uRW51bVByb3BzKG9iaiwga2V5cykge1xuICAgIHZhciBub25FbnVtSWR4ID0gbm9uRW51bWVyYWJsZVByb3BzLmxlbmd0aDtcbiAgICB2YXIgY29uc3RydWN0b3IgPSBvYmouY29uc3RydWN0b3I7XG4gICAgdmFyIHByb3RvID0gKF8uaXNGdW5jdGlvbihjb25zdHJ1Y3RvcikgJiYgY29uc3RydWN0b3IucHJvdG90eXBlKSB8fCBPYmpQcm90bztcblxuICAgIC8vIENvbnN0cnVjdG9yIGlzIGEgc3BlY2lhbCBjYXNlLlxuICAgIHZhciBwcm9wID0gJ2NvbnN0cnVjdG9yJztcbiAgICBpZiAoXy5oYXMob2JqLCBwcm9wKSAmJiAhXy5jb250YWlucyhrZXlzLCBwcm9wKSkga2V5cy5wdXNoKHByb3ApO1xuXG4gICAgd2hpbGUgKG5vbkVudW1JZHgtLSkge1xuICAgICAgcHJvcCA9IG5vbkVudW1lcmFibGVQcm9wc1tub25FbnVtSWR4XTtcbiAgICAgIGlmIChwcm9wIGluIG9iaiAmJiBvYmpbcHJvcF0gIT09IHByb3RvW3Byb3BdICYmICFfLmNvbnRhaW5zKGtleXMsIHByb3ApKSB7XG4gICAgICAgIGtleXMucHVzaChwcm9wKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBSZXRyaWV2ZSB0aGUgbmFtZXMgb2YgYW4gb2JqZWN0J3Mgb3duIHByb3BlcnRpZXMuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBPYmplY3Qua2V5c2BcbiAgXy5rZXlzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKCFfLmlzT2JqZWN0KG9iaikpIHJldHVybiBbXTtcbiAgICBpZiAobmF0aXZlS2V5cykgcmV0dXJuIG5hdGl2ZUtleXMob2JqKTtcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIGlmIChfLmhhcyhvYmosIGtleSkpIGtleXMucHVzaChrZXkpO1xuICAgIC8vIEFoZW0sIElFIDwgOS5cbiAgICBpZiAoaGFzRW51bUJ1ZykgY29sbGVjdE5vbkVudW1Qcm9wcyhvYmosIGtleXMpO1xuICAgIHJldHVybiBrZXlzO1xuICB9O1xuXG4gIC8vIFJldHJpZXZlIGFsbCB0aGUgcHJvcGVydHkgbmFtZXMgb2YgYW4gb2JqZWN0LlxuICBfLmFsbEtleXMgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIFtdO1xuICAgIHZhciBrZXlzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikga2V5cy5wdXNoKGtleSk7XG4gICAgLy8gQWhlbSwgSUUgPCA5LlxuICAgIGlmIChoYXNFbnVtQnVnKSBjb2xsZWN0Tm9uRW51bVByb3BzKG9iaiwga2V5cyk7XG4gICAgcmV0dXJuIGtleXM7XG4gIH07XG5cbiAgLy8gUmV0cmlldmUgdGhlIHZhbHVlcyBvZiBhbiBvYmplY3QncyBwcm9wZXJ0aWVzLlxuICBfLnZhbHVlcyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7XG4gICAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIHZhciB2YWx1ZXMgPSBBcnJheShsZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhbHVlc1tpXSA9IG9ialtrZXlzW2ldXTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlcztcbiAgfTtcblxuICAvLyBSZXR1cm5zIHRoZSByZXN1bHRzIG9mIGFwcGx5aW5nIHRoZSBpdGVyYXRlZSB0byBlYWNoIGVsZW1lbnQgb2YgdGhlIG9iamVjdFxuICAvLyBJbiBjb250cmFzdCB0byBfLm1hcCBpdCByZXR1cm5zIGFuIG9iamVjdFxuICBfLm1hcE9iamVjdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHtcbiAgICBpdGVyYXRlZSA9IGNiKGl0ZXJhdGVlLCBjb250ZXh0KTtcbiAgICB2YXIga2V5cyA9ICBfLmtleXMob2JqKSxcbiAgICAgICAgICBsZW5ndGggPSBrZXlzLmxlbmd0aCxcbiAgICAgICAgICByZXN1bHRzID0ge30sXG4gICAgICAgICAgY3VycmVudEtleTtcbiAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgY3VycmVudEtleSA9IGtleXNbaW5kZXhdO1xuICAgICAgICByZXN1bHRzW2N1cnJlbnRLZXldID0gaXRlcmF0ZWUob2JqW2N1cnJlbnRLZXldLCBjdXJyZW50S2V5LCBvYmopO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gIH07XG5cbiAgLy8gQ29udmVydCBhbiBvYmplY3QgaW50byBhIGxpc3Qgb2YgYFtrZXksIHZhbHVlXWAgcGFpcnMuXG4gIF8ucGFpcnMgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgIHZhciBsZW5ndGggPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgcGFpcnMgPSBBcnJheShsZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHBhaXJzW2ldID0gW2tleXNbaV0sIG9ialtrZXlzW2ldXV07XG4gICAgfVxuICAgIHJldHVybiBwYWlycztcbiAgfTtcblxuICAvLyBJbnZlcnQgdGhlIGtleXMgYW5kIHZhbHVlcyBvZiBhbiBvYmplY3QuIFRoZSB2YWx1ZXMgbXVzdCBiZSBzZXJpYWxpemFibGUuXG4gIF8uaW52ZXJ0ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGtleXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlc3VsdFtvYmpba2V5c1tpXV1dID0ga2V5c1tpXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBSZXR1cm4gYSBzb3J0ZWQgbGlzdCBvZiB0aGUgZnVuY3Rpb24gbmFtZXMgYXZhaWxhYmxlIG9uIHRoZSBvYmplY3QuXG4gIC8vIEFsaWFzZWQgYXMgYG1ldGhvZHNgXG4gIF8uZnVuY3Rpb25zID0gXy5tZXRob2RzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIG5hbWVzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgaWYgKF8uaXNGdW5jdGlvbihvYmpba2V5XSkpIG5hbWVzLnB1c2goa2V5KTtcbiAgICB9XG4gICAgcmV0dXJuIG5hbWVzLnNvcnQoKTtcbiAgfTtcblxuICAvLyBFeHRlbmQgYSBnaXZlbiBvYmplY3Qgd2l0aCBhbGwgdGhlIHByb3BlcnRpZXMgaW4gcGFzc2VkLWluIG9iamVjdChzKS5cbiAgXy5leHRlbmQgPSBjcmVhdGVBc3NpZ25lcihfLmFsbEtleXMpO1xuXG4gIC8vIEFzc2lnbnMgYSBnaXZlbiBvYmplY3Qgd2l0aCBhbGwgdGhlIG93biBwcm9wZXJ0aWVzIGluIHRoZSBwYXNzZWQtaW4gb2JqZWN0KHMpXG4gIC8vIChodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3QvYXNzaWduKVxuICBfLmV4dGVuZE93biA9IF8uYXNzaWduID0gY3JlYXRlQXNzaWduZXIoXy5rZXlzKTtcblxuICAvLyBSZXR1cm5zIHRoZSBmaXJzdCBrZXkgb24gYW4gb2JqZWN0IHRoYXQgcGFzc2VzIGEgcHJlZGljYXRlIHRlc3RcbiAgXy5maW5kS2V5ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaiksIGtleTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAga2V5ID0ga2V5c1tpXTtcbiAgICAgIGlmIChwcmVkaWNhdGUob2JqW2tleV0sIGtleSwgb2JqKSkgcmV0dXJuIGtleTtcbiAgICB9XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgY29weSBvZiB0aGUgb2JqZWN0IG9ubHkgY29udGFpbmluZyB0aGUgd2hpdGVsaXN0ZWQgcHJvcGVydGllcy5cbiAgXy5waWNrID0gZnVuY3Rpb24ob2JqZWN0LCBvaXRlcmF0ZWUsIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0ID0ge30sIG9iaiA9IG9iamVjdCwgaXRlcmF0ZWUsIGtleXM7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0O1xuICAgIGlmIChfLmlzRnVuY3Rpb24ob2l0ZXJhdGVlKSkge1xuICAgICAga2V5cyA9IF8uYWxsS2V5cyhvYmopO1xuICAgICAgaXRlcmF0ZWUgPSBvcHRpbWl6ZUNiKG9pdGVyYXRlZSwgY29udGV4dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGtleXMgPSBmbGF0dGVuKGFyZ3VtZW50cywgZmFsc2UsIGZhbHNlLCAxKTtcbiAgICAgIGl0ZXJhdGVlID0gZnVuY3Rpb24odmFsdWUsIGtleSwgb2JqKSB7IHJldHVybiBrZXkgaW4gb2JqOyB9O1xuICAgICAgb2JqID0gT2JqZWN0KG9iaik7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICAgIHZhciB2YWx1ZSA9IG9ialtrZXldO1xuICAgICAgaWYgKGl0ZXJhdGVlKHZhbHVlLCBrZXksIG9iaikpIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgIC8vIFJldHVybiBhIGNvcHkgb2YgdGhlIG9iamVjdCB3aXRob3V0IHRoZSBibGFja2xpc3RlZCBwcm9wZXJ0aWVzLlxuICBfLm9taXQgPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgaWYgKF8uaXNGdW5jdGlvbihpdGVyYXRlZSkpIHtcbiAgICAgIGl0ZXJhdGVlID0gXy5uZWdhdGUoaXRlcmF0ZWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIga2V5cyA9IF8ubWFwKGZsYXR0ZW4oYXJndW1lbnRzLCBmYWxzZSwgZmFsc2UsIDEpLCBTdHJpbmcpO1xuICAgICAgaXRlcmF0ZWUgPSBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgIHJldHVybiAhXy5jb250YWlucyhrZXlzLCBrZXkpO1xuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIF8ucGljayhvYmosIGl0ZXJhdGVlLCBjb250ZXh0KTtcbiAgfTtcblxuICAvLyBGaWxsIGluIGEgZ2l2ZW4gb2JqZWN0IHdpdGggZGVmYXVsdCBwcm9wZXJ0aWVzLlxuICBfLmRlZmF1bHRzID0gY3JlYXRlQXNzaWduZXIoXy5hbGxLZXlzLCB0cnVlKTtcblxuICAvLyBDcmVhdGVzIGFuIG9iamVjdCB0aGF0IGluaGVyaXRzIGZyb20gdGhlIGdpdmVuIHByb3RvdHlwZSBvYmplY3QuXG4gIC8vIElmIGFkZGl0aW9uYWwgcHJvcGVydGllcyBhcmUgcHJvdmlkZWQgdGhlbiB0aGV5IHdpbGwgYmUgYWRkZWQgdG8gdGhlXG4gIC8vIGNyZWF0ZWQgb2JqZWN0LlxuICBfLmNyZWF0ZSA9IGZ1bmN0aW9uKHByb3RvdHlwZSwgcHJvcHMpIHtcbiAgICB2YXIgcmVzdWx0ID0gYmFzZUNyZWF0ZShwcm90b3R5cGUpO1xuICAgIGlmIChwcm9wcykgXy5leHRlbmRPd24ocmVzdWx0LCBwcm9wcyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBDcmVhdGUgYSAoc2hhbGxvdy1jbG9uZWQpIGR1cGxpY2F0ZSBvZiBhbiBvYmplY3QuXG4gIF8uY2xvbmUgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIG9iajtcbiAgICByZXR1cm4gXy5pc0FycmF5KG9iaikgPyBvYmouc2xpY2UoKSA6IF8uZXh0ZW5kKHt9LCBvYmopO1xuICB9O1xuXG4gIC8vIEludm9rZXMgaW50ZXJjZXB0b3Igd2l0aCB0aGUgb2JqLCBhbmQgdGhlbiByZXR1cm5zIG9iai5cbiAgLy8gVGhlIHByaW1hcnkgcHVycG9zZSBvZiB0aGlzIG1ldGhvZCBpcyB0byBcInRhcCBpbnRvXCIgYSBtZXRob2QgY2hhaW4sIGluXG4gIC8vIG9yZGVyIHRvIHBlcmZvcm0gb3BlcmF0aW9ucyBvbiBpbnRlcm1lZGlhdGUgcmVzdWx0cyB3aXRoaW4gdGhlIGNoYWluLlxuICBfLnRhcCA9IGZ1bmN0aW9uKG9iaiwgaW50ZXJjZXB0b3IpIHtcbiAgICBpbnRlcmNlcHRvcihvYmopO1xuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gUmV0dXJucyB3aGV0aGVyIGFuIG9iamVjdCBoYXMgYSBnaXZlbiBzZXQgb2YgYGtleTp2YWx1ZWAgcGFpcnMuXG4gIF8uaXNNYXRjaCA9IGZ1bmN0aW9uKG9iamVjdCwgYXR0cnMpIHtcbiAgICB2YXIga2V5cyA9IF8ua2V5cyhhdHRycyksIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIGlmIChvYmplY3QgPT0gbnVsbCkgcmV0dXJuICFsZW5ndGg7XG4gICAgdmFyIG9iaiA9IE9iamVjdChvYmplY3QpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBrZXkgPSBrZXlzW2ldO1xuICAgICAgaWYgKGF0dHJzW2tleV0gIT09IG9ialtrZXldIHx8ICEoa2V5IGluIG9iaikpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cblxuICAvLyBJbnRlcm5hbCByZWN1cnNpdmUgY29tcGFyaXNvbiBmdW5jdGlvbiBmb3IgYGlzRXF1YWxgLlxuICB2YXIgZXEgPSBmdW5jdGlvbihhLCBiLCBhU3RhY2ssIGJTdGFjaykge1xuICAgIC8vIElkZW50aWNhbCBvYmplY3RzIGFyZSBlcXVhbC4gYDAgPT09IC0wYCwgYnV0IHRoZXkgYXJlbid0IGlkZW50aWNhbC5cbiAgICAvLyBTZWUgdGhlIFtIYXJtb255IGBlZ2FsYCBwcm9wb3NhbF0oaHR0cDovL3dpa2kuZWNtYXNjcmlwdC5vcmcvZG9rdS5waHA/aWQ9aGFybW9ueTplZ2FsKS5cbiAgICBpZiAoYSA9PT0gYikgcmV0dXJuIGEgIT09IDAgfHwgMSAvIGEgPT09IDEgLyBiO1xuICAgIC8vIEEgc3RyaWN0IGNvbXBhcmlzb24gaXMgbmVjZXNzYXJ5IGJlY2F1c2UgYG51bGwgPT0gdW5kZWZpbmVkYC5cbiAgICBpZiAoYSA9PSBudWxsIHx8IGIgPT0gbnVsbCkgcmV0dXJuIGEgPT09IGI7XG4gICAgLy8gVW53cmFwIGFueSB3cmFwcGVkIG9iamVjdHMuXG4gICAgaWYgKGEgaW5zdGFuY2VvZiBfKSBhID0gYS5fd3JhcHBlZDtcbiAgICBpZiAoYiBpbnN0YW5jZW9mIF8pIGIgPSBiLl93cmFwcGVkO1xuICAgIC8vIENvbXBhcmUgYFtbQ2xhc3NdXWAgbmFtZXMuXG4gICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwoYSk7XG4gICAgaWYgKGNsYXNzTmFtZSAhPT0gdG9TdHJpbmcuY2FsbChiKSkgcmV0dXJuIGZhbHNlO1xuICAgIHN3aXRjaCAoY2xhc3NOYW1lKSB7XG4gICAgICAvLyBTdHJpbmdzLCBudW1iZXJzLCByZWd1bGFyIGV4cHJlc3Npb25zLCBkYXRlcywgYW5kIGJvb2xlYW5zIGFyZSBjb21wYXJlZCBieSB2YWx1ZS5cbiAgICAgIGNhc2UgJ1tvYmplY3QgUmVnRXhwXSc6XG4gICAgICAvLyBSZWdFeHBzIGFyZSBjb2VyY2VkIHRvIHN0cmluZ3MgZm9yIGNvbXBhcmlzb24gKE5vdGU6ICcnICsgL2EvaSA9PT0gJy9hL2knKVxuICAgICAgY2FzZSAnW29iamVjdCBTdHJpbmddJzpcbiAgICAgICAgLy8gUHJpbWl0aXZlcyBhbmQgdGhlaXIgY29ycmVzcG9uZGluZyBvYmplY3Qgd3JhcHBlcnMgYXJlIGVxdWl2YWxlbnQ7IHRodXMsIGBcIjVcImAgaXNcbiAgICAgICAgLy8gZXF1aXZhbGVudCB0byBgbmV3IFN0cmluZyhcIjVcIilgLlxuICAgICAgICByZXR1cm4gJycgKyBhID09PSAnJyArIGI7XG4gICAgICBjYXNlICdbb2JqZWN0IE51bWJlcl0nOlxuICAgICAgICAvLyBgTmFOYHMgYXJlIGVxdWl2YWxlbnQsIGJ1dCBub24tcmVmbGV4aXZlLlxuICAgICAgICAvLyBPYmplY3QoTmFOKSBpcyBlcXVpdmFsZW50IHRvIE5hTlxuICAgICAgICBpZiAoK2EgIT09ICthKSByZXR1cm4gK2IgIT09ICtiO1xuICAgICAgICAvLyBBbiBgZWdhbGAgY29tcGFyaXNvbiBpcyBwZXJmb3JtZWQgZm9yIG90aGVyIG51bWVyaWMgdmFsdWVzLlxuICAgICAgICByZXR1cm4gK2EgPT09IDAgPyAxIC8gK2EgPT09IDEgLyBiIDogK2EgPT09ICtiO1xuICAgICAgY2FzZSAnW29iamVjdCBEYXRlXSc6XG4gICAgICBjYXNlICdbb2JqZWN0IEJvb2xlYW5dJzpcbiAgICAgICAgLy8gQ29lcmNlIGRhdGVzIGFuZCBib29sZWFucyB0byBudW1lcmljIHByaW1pdGl2ZSB2YWx1ZXMuIERhdGVzIGFyZSBjb21wYXJlZCBieSB0aGVpclxuICAgICAgICAvLyBtaWxsaXNlY29uZCByZXByZXNlbnRhdGlvbnMuIE5vdGUgdGhhdCBpbnZhbGlkIGRhdGVzIHdpdGggbWlsbGlzZWNvbmQgcmVwcmVzZW50YXRpb25zXG4gICAgICAgIC8vIG9mIGBOYU5gIGFyZSBub3QgZXF1aXZhbGVudC5cbiAgICAgICAgcmV0dXJuICthID09PSArYjtcbiAgICB9XG5cbiAgICB2YXIgYXJlQXJyYXlzID0gY2xhc3NOYW1lID09PSAnW29iamVjdCBBcnJheV0nO1xuICAgIGlmICghYXJlQXJyYXlzKSB7XG4gICAgICBpZiAodHlwZW9mIGEgIT0gJ29iamVjdCcgfHwgdHlwZW9mIGIgIT0gJ29iamVjdCcpIHJldHVybiBmYWxzZTtcblxuICAgICAgLy8gT2JqZWN0cyB3aXRoIGRpZmZlcmVudCBjb25zdHJ1Y3RvcnMgYXJlIG5vdCBlcXVpdmFsZW50LCBidXQgYE9iamVjdGBzIG9yIGBBcnJheWBzXG4gICAgICAvLyBmcm9tIGRpZmZlcmVudCBmcmFtZXMgYXJlLlxuICAgICAgdmFyIGFDdG9yID0gYS5jb25zdHJ1Y3RvciwgYkN0b3IgPSBiLmNvbnN0cnVjdG9yO1xuICAgICAgaWYgKGFDdG9yICE9PSBiQ3RvciAmJiAhKF8uaXNGdW5jdGlvbihhQ3RvcikgJiYgYUN0b3IgaW5zdGFuY2VvZiBhQ3RvciAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uaXNGdW5jdGlvbihiQ3RvcikgJiYgYkN0b3IgaW5zdGFuY2VvZiBiQ3RvcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgKCdjb25zdHJ1Y3RvcicgaW4gYSAmJiAnY29uc3RydWN0b3InIGluIGIpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gQXNzdW1lIGVxdWFsaXR5IGZvciBjeWNsaWMgc3RydWN0dXJlcy4gVGhlIGFsZ29yaXRobSBmb3IgZGV0ZWN0aW5nIGN5Y2xpY1xuICAgIC8vIHN0cnVjdHVyZXMgaXMgYWRhcHRlZCBmcm9tIEVTIDUuMSBzZWN0aW9uIDE1LjEyLjMsIGFic3RyYWN0IG9wZXJhdGlvbiBgSk9gLlxuXG4gICAgLy8gSW5pdGlhbGl6aW5nIHN0YWNrIG9mIHRyYXZlcnNlZCBvYmplY3RzLlxuICAgIC8vIEl0J3MgZG9uZSBoZXJlIHNpbmNlIHdlIG9ubHkgbmVlZCB0aGVtIGZvciBvYmplY3RzIGFuZCBhcnJheXMgY29tcGFyaXNvbi5cbiAgICBhU3RhY2sgPSBhU3RhY2sgfHwgW107XG4gICAgYlN0YWNrID0gYlN0YWNrIHx8IFtdO1xuICAgIHZhciBsZW5ndGggPSBhU3RhY2subGVuZ3RoO1xuICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgLy8gTGluZWFyIHNlYXJjaC4gUGVyZm9ybWFuY2UgaXMgaW52ZXJzZWx5IHByb3BvcnRpb25hbCB0byB0aGUgbnVtYmVyIG9mXG4gICAgICAvLyB1bmlxdWUgbmVzdGVkIHN0cnVjdHVyZXMuXG4gICAgICBpZiAoYVN0YWNrW2xlbmd0aF0gPT09IGEpIHJldHVybiBiU3RhY2tbbGVuZ3RoXSA9PT0gYjtcbiAgICB9XG5cbiAgICAvLyBBZGQgdGhlIGZpcnN0IG9iamVjdCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuXG4gICAgYVN0YWNrLnB1c2goYSk7XG4gICAgYlN0YWNrLnB1c2goYik7XG5cbiAgICAvLyBSZWN1cnNpdmVseSBjb21wYXJlIG9iamVjdHMgYW5kIGFycmF5cy5cbiAgICBpZiAoYXJlQXJyYXlzKSB7XG4gICAgICAvLyBDb21wYXJlIGFycmF5IGxlbmd0aHMgdG8gZGV0ZXJtaW5lIGlmIGEgZGVlcCBjb21wYXJpc29uIGlzIG5lY2Vzc2FyeS5cbiAgICAgIGxlbmd0aCA9IGEubGVuZ3RoO1xuICAgICAgaWYgKGxlbmd0aCAhPT0gYi5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgICAgIC8vIERlZXAgY29tcGFyZSB0aGUgY29udGVudHMsIGlnbm9yaW5nIG5vbi1udW1lcmljIHByb3BlcnRpZXMuXG4gICAgICB3aGlsZSAobGVuZ3RoLS0pIHtcbiAgICAgICAgaWYgKCFlcShhW2xlbmd0aF0sIGJbbGVuZ3RoXSwgYVN0YWNrLCBiU3RhY2spKSByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIERlZXAgY29tcGFyZSBvYmplY3RzLlxuICAgICAgdmFyIGtleXMgPSBfLmtleXMoYSksIGtleTtcbiAgICAgIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgICAgLy8gRW5zdXJlIHRoYXQgYm90aCBvYmplY3RzIGNvbnRhaW4gdGhlIHNhbWUgbnVtYmVyIG9mIHByb3BlcnRpZXMgYmVmb3JlIGNvbXBhcmluZyBkZWVwIGVxdWFsaXR5LlxuICAgICAgaWYgKF8ua2V5cyhiKS5sZW5ndGggIT09IGxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgIC8vIERlZXAgY29tcGFyZSBlYWNoIG1lbWJlclxuICAgICAgICBrZXkgPSBrZXlzW2xlbmd0aF07XG4gICAgICAgIGlmICghKF8uaGFzKGIsIGtleSkgJiYgZXEoYVtrZXldLCBiW2tleV0sIGFTdGFjaywgYlN0YWNrKSkpIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gUmVtb3ZlIHRoZSBmaXJzdCBvYmplY3QgZnJvbSB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuXG4gICAgYVN0YWNrLnBvcCgpO1xuICAgIGJTdGFjay5wb3AoKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICAvLyBQZXJmb3JtIGEgZGVlcCBjb21wYXJpc29uIHRvIGNoZWNrIGlmIHR3byBvYmplY3RzIGFyZSBlcXVhbC5cbiAgXy5pc0VxdWFsID0gZnVuY3Rpb24oYSwgYikge1xuICAgIHJldHVybiBlcShhLCBiKTtcbiAgfTtcblxuICAvLyBJcyBhIGdpdmVuIGFycmF5LCBzdHJpbmcsIG9yIG9iamVjdCBlbXB0eT9cbiAgLy8gQW4gXCJlbXB0eVwiIG9iamVjdCBoYXMgbm8gZW51bWVyYWJsZSBvd24tcHJvcGVydGllcy5cbiAgXy5pc0VtcHR5ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gdHJ1ZTtcbiAgICBpZiAoaXNBcnJheUxpa2Uob2JqKSAmJiAoXy5pc0FycmF5KG9iaikgfHwgXy5pc1N0cmluZyhvYmopIHx8IF8uaXNBcmd1bWVudHMob2JqKSkpIHJldHVybiBvYmoubGVuZ3RoID09PSAwO1xuICAgIHJldHVybiBfLmtleXMob2JqKS5sZW5ndGggPT09IDA7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIERPTSBlbGVtZW50P1xuICBfLmlzRWxlbWVudCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiAhIShvYmogJiYgb2JqLm5vZGVUeXBlID09PSAxKTtcbiAgfTtcblxuICAvLyBJcyBhIGdpdmVuIHZhbHVlIGFuIGFycmF5P1xuICAvLyBEZWxlZ2F0ZXMgdG8gRUNNQTUncyBuYXRpdmUgQXJyYXkuaXNBcnJheVxuICBfLmlzQXJyYXkgPSBuYXRpdmVJc0FycmF5IHx8IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XSc7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YXJpYWJsZSBhbiBvYmplY3Q/XG4gIF8uaXNPYmplY3QgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIgdHlwZSA9IHR5cGVvZiBvYmo7XG4gICAgcmV0dXJuIHR5cGUgPT09ICdmdW5jdGlvbicgfHwgdHlwZSA9PT0gJ29iamVjdCcgJiYgISFvYmo7XG4gIH07XG5cbiAgLy8gQWRkIHNvbWUgaXNUeXBlIG1ldGhvZHM6IGlzQXJndW1lbnRzLCBpc0Z1bmN0aW9uLCBpc1N0cmluZywgaXNOdW1iZXIsIGlzRGF0ZSwgaXNSZWdFeHAsIGlzRXJyb3IuXG4gIF8uZWFjaChbJ0FyZ3VtZW50cycsICdGdW5jdGlvbicsICdTdHJpbmcnLCAnTnVtYmVyJywgJ0RhdGUnLCAnUmVnRXhwJywgJ0Vycm9yJ10sIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBfWydpcycgKyBuYW1lXSA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgJyArIG5hbWUgKyAnXSc7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gRGVmaW5lIGEgZmFsbGJhY2sgdmVyc2lvbiBvZiB0aGUgbWV0aG9kIGluIGJyb3dzZXJzIChhaGVtLCBJRSA8IDkpLCB3aGVyZVxuICAvLyB0aGVyZSBpc24ndCBhbnkgaW5zcGVjdGFibGUgXCJBcmd1bWVudHNcIiB0eXBlLlxuICBpZiAoIV8uaXNBcmd1bWVudHMoYXJndW1lbnRzKSkge1xuICAgIF8uaXNBcmd1bWVudHMgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgIHJldHVybiBfLmhhcyhvYmosICdjYWxsZWUnKTtcbiAgICB9O1xuICB9XG5cbiAgLy8gT3B0aW1pemUgYGlzRnVuY3Rpb25gIGlmIGFwcHJvcHJpYXRlLiBXb3JrIGFyb3VuZCBzb21lIHR5cGVvZiBidWdzIGluIG9sZCB2OCxcbiAgLy8gSUUgMTEgKCMxNjIxKSwgYW5kIGluIFNhZmFyaSA4ICgjMTkyOSkuXG4gIGlmICh0eXBlb2YgLy4vICE9ICdmdW5jdGlvbicgJiYgdHlwZW9mIEludDhBcnJheSAhPSAnb2JqZWN0Jykge1xuICAgIF8uaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIHR5cGVvZiBvYmogPT0gJ2Z1bmN0aW9uJyB8fCBmYWxzZTtcbiAgICB9O1xuICB9XG5cbiAgLy8gSXMgYSBnaXZlbiBvYmplY3QgYSBmaW5pdGUgbnVtYmVyP1xuICBfLmlzRmluaXRlID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIGlzRmluaXRlKG9iaikgJiYgIWlzTmFOKHBhcnNlRmxvYXQob2JqKSk7XG4gIH07XG5cbiAgLy8gSXMgdGhlIGdpdmVuIHZhbHVlIGBOYU5gPyAoTmFOIGlzIHRoZSBvbmx5IG51bWJlciB3aGljaCBkb2VzIG5vdCBlcXVhbCBpdHNlbGYpLlxuICBfLmlzTmFOID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIF8uaXNOdW1iZXIob2JqKSAmJiBvYmogIT09ICtvYmo7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIGJvb2xlYW4/XG4gIF8uaXNCb29sZWFuID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gdHJ1ZSB8fCBvYmogPT09IGZhbHNlIHx8IHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgQm9vbGVhbl0nO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFsdWUgZXF1YWwgdG8gbnVsbD9cbiAgXy5pc051bGwgPSBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSBudWxsO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFyaWFibGUgdW5kZWZpbmVkP1xuICBfLmlzVW5kZWZpbmVkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gdm9pZCAwO1xuICB9O1xuXG4gIC8vIFNob3J0Y3V0IGZ1bmN0aW9uIGZvciBjaGVja2luZyBpZiBhbiBvYmplY3QgaGFzIGEgZ2l2ZW4gcHJvcGVydHkgZGlyZWN0bHlcbiAgLy8gb24gaXRzZWxmIChpbiBvdGhlciB3b3Jkcywgbm90IG9uIGEgcHJvdG90eXBlKS5cbiAgXy5oYXMgPSBmdW5jdGlvbihvYmosIGtleSkge1xuICAgIHJldHVybiBvYmogIT0gbnVsbCAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcbiAgfTtcblxuICAvLyBVdGlsaXR5IEZ1bmN0aW9uc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIFJ1biBVbmRlcnNjb3JlLmpzIGluICpub0NvbmZsaWN0KiBtb2RlLCByZXR1cm5pbmcgdGhlIGBfYCB2YXJpYWJsZSB0byBpdHNcbiAgLy8gcHJldmlvdXMgb3duZXIuIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIFVuZGVyc2NvcmUgb2JqZWN0LlxuICBfLm5vQ29uZmxpY3QgPSBmdW5jdGlvbigpIHtcbiAgICByb290Ll8gPSBwcmV2aW91c1VuZGVyc2NvcmU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLy8gS2VlcCB0aGUgaWRlbnRpdHkgZnVuY3Rpb24gYXJvdW5kIGZvciBkZWZhdWx0IGl0ZXJhdGVlcy5cbiAgXy5pZGVudGl0eSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9O1xuXG4gIC8vIFByZWRpY2F0ZS1nZW5lcmF0aW5nIGZ1bmN0aW9ucy4gT2Z0ZW4gdXNlZnVsIG91dHNpZGUgb2YgVW5kZXJzY29yZS5cbiAgXy5jb25zdGFudCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH07XG4gIH07XG5cbiAgXy5ub29wID0gZnVuY3Rpb24oKXt9O1xuXG4gIF8ucHJvcGVydHkgPSBwcm9wZXJ0eTtcblxuICAvLyBHZW5lcmF0ZXMgYSBmdW5jdGlvbiBmb3IgYSBnaXZlbiBvYmplY3QgdGhhdCByZXR1cm5zIGEgZ2l2ZW4gcHJvcGVydHkuXG4gIF8ucHJvcGVydHlPZiA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiBvYmogPT0gbnVsbCA/IGZ1bmN0aW9uKCl7fSA6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIG9ialtrZXldO1xuICAgIH07XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIHByZWRpY2F0ZSBmb3IgY2hlY2tpbmcgd2hldGhlciBhbiBvYmplY3QgaGFzIGEgZ2l2ZW4gc2V0IG9mXG4gIC8vIGBrZXk6dmFsdWVgIHBhaXJzLlxuICBfLm1hdGNoZXIgPSBfLm1hdGNoZXMgPSBmdW5jdGlvbihhdHRycykge1xuICAgIGF0dHJzID0gXy5leHRlbmRPd24oe30sIGF0dHJzKTtcbiAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gXy5pc01hdGNoKG9iaiwgYXR0cnMpO1xuICAgIH07XG4gIH07XG5cbiAgLy8gUnVuIGEgZnVuY3Rpb24gKipuKiogdGltZXMuXG4gIF8udGltZXMgPSBmdW5jdGlvbihuLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgIHZhciBhY2N1bSA9IEFycmF5KE1hdGgubWF4KDAsIG4pKTtcbiAgICBpdGVyYXRlZSA9IG9wdGltaXplQ2IoaXRlcmF0ZWUsIGNvbnRleHQsIDEpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSBhY2N1bVtpXSA9IGl0ZXJhdGVlKGkpO1xuICAgIHJldHVybiBhY2N1bTtcbiAgfTtcblxuICAvLyBSZXR1cm4gYSByYW5kb20gaW50ZWdlciBiZXR3ZWVuIG1pbiBhbmQgbWF4IChpbmNsdXNpdmUpLlxuICBfLnJhbmRvbSA9IGZ1bmN0aW9uKG1pbiwgbWF4KSB7XG4gICAgaWYgKG1heCA9PSBudWxsKSB7XG4gICAgICBtYXggPSBtaW47XG4gICAgICBtaW4gPSAwO1xuICAgIH1cbiAgICByZXR1cm4gbWluICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKTtcbiAgfTtcblxuICAvLyBBIChwb3NzaWJseSBmYXN0ZXIpIHdheSB0byBnZXQgdGhlIGN1cnJlbnQgdGltZXN0YW1wIGFzIGFuIGludGVnZXIuXG4gIF8ubm93ID0gRGF0ZS5ub3cgfHwgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICB9O1xuXG4gICAvLyBMaXN0IG9mIEhUTUwgZW50aXRpZXMgZm9yIGVzY2FwaW5nLlxuICB2YXIgZXNjYXBlTWFwID0ge1xuICAgICcmJzogJyZhbXA7JyxcbiAgICAnPCc6ICcmbHQ7JyxcbiAgICAnPic6ICcmZ3Q7JyxcbiAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICBcIidcIjogJyYjeDI3OycsXG4gICAgJ2AnOiAnJiN4NjA7J1xuICB9O1xuICB2YXIgdW5lc2NhcGVNYXAgPSBfLmludmVydChlc2NhcGVNYXApO1xuXG4gIC8vIEZ1bmN0aW9ucyBmb3IgZXNjYXBpbmcgYW5kIHVuZXNjYXBpbmcgc3RyaW5ncyB0by9mcm9tIEhUTUwgaW50ZXJwb2xhdGlvbi5cbiAgdmFyIGNyZWF0ZUVzY2FwZXIgPSBmdW5jdGlvbihtYXApIHtcbiAgICB2YXIgZXNjYXBlciA9IGZ1bmN0aW9uKG1hdGNoKSB7XG4gICAgICByZXR1cm4gbWFwW21hdGNoXTtcbiAgICB9O1xuICAgIC8vIFJlZ2V4ZXMgZm9yIGlkZW50aWZ5aW5nIGEga2V5IHRoYXQgbmVlZHMgdG8gYmUgZXNjYXBlZFxuICAgIHZhciBzb3VyY2UgPSAnKD86JyArIF8ua2V5cyhtYXApLmpvaW4oJ3wnKSArICcpJztcbiAgICB2YXIgdGVzdFJlZ2V4cCA9IFJlZ0V4cChzb3VyY2UpO1xuICAgIHZhciByZXBsYWNlUmVnZXhwID0gUmVnRXhwKHNvdXJjZSwgJ2cnKTtcbiAgICByZXR1cm4gZnVuY3Rpb24oc3RyaW5nKSB7XG4gICAgICBzdHJpbmcgPSBzdHJpbmcgPT0gbnVsbCA/ICcnIDogJycgKyBzdHJpbmc7XG4gICAgICByZXR1cm4gdGVzdFJlZ2V4cC50ZXN0KHN0cmluZykgPyBzdHJpbmcucmVwbGFjZShyZXBsYWNlUmVnZXhwLCBlc2NhcGVyKSA6IHN0cmluZztcbiAgICB9O1xuICB9O1xuICBfLmVzY2FwZSA9IGNyZWF0ZUVzY2FwZXIoZXNjYXBlTWFwKTtcbiAgXy51bmVzY2FwZSA9IGNyZWF0ZUVzY2FwZXIodW5lc2NhcGVNYXApO1xuXG4gIC8vIElmIHRoZSB2YWx1ZSBvZiB0aGUgbmFtZWQgYHByb3BlcnR5YCBpcyBhIGZ1bmN0aW9uIHRoZW4gaW52b2tlIGl0IHdpdGggdGhlXG4gIC8vIGBvYmplY3RgIGFzIGNvbnRleHQ7IG90aGVyd2lzZSwgcmV0dXJuIGl0LlxuICBfLnJlc3VsdCA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHksIGZhbGxiYWNrKSB7XG4gICAgdmFyIHZhbHVlID0gb2JqZWN0ID09IG51bGwgPyB2b2lkIDAgOiBvYmplY3RbcHJvcGVydHldO1xuICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwKSB7XG4gICAgICB2YWx1ZSA9IGZhbGxiYWNrO1xuICAgIH1cbiAgICByZXR1cm4gXy5pc0Z1bmN0aW9uKHZhbHVlKSA/IHZhbHVlLmNhbGwob2JqZWN0KSA6IHZhbHVlO1xuICB9O1xuXG4gIC8vIEdlbmVyYXRlIGEgdW5pcXVlIGludGVnZXIgaWQgKHVuaXF1ZSB3aXRoaW4gdGhlIGVudGlyZSBjbGllbnQgc2Vzc2lvbikuXG4gIC8vIFVzZWZ1bCBmb3IgdGVtcG9yYXJ5IERPTSBpZHMuXG4gIHZhciBpZENvdW50ZXIgPSAwO1xuICBfLnVuaXF1ZUlkID0gZnVuY3Rpb24ocHJlZml4KSB7XG4gICAgdmFyIGlkID0gKytpZENvdW50ZXIgKyAnJztcbiAgICByZXR1cm4gcHJlZml4ID8gcHJlZml4ICsgaWQgOiBpZDtcbiAgfTtcblxuICAvLyBCeSBkZWZhdWx0LCBVbmRlcnNjb3JlIHVzZXMgRVJCLXN0eWxlIHRlbXBsYXRlIGRlbGltaXRlcnMsIGNoYW5nZSB0aGVcbiAgLy8gZm9sbG93aW5nIHRlbXBsYXRlIHNldHRpbmdzIHRvIHVzZSBhbHRlcm5hdGl2ZSBkZWxpbWl0ZXJzLlxuICBfLnRlbXBsYXRlU2V0dGluZ3MgPSB7XG4gICAgZXZhbHVhdGUgICAgOiAvPCUoW1xcc1xcU10rPyklPi9nLFxuICAgIGludGVycG9sYXRlIDogLzwlPShbXFxzXFxTXSs/KSU+L2csXG4gICAgZXNjYXBlICAgICAgOiAvPCUtKFtcXHNcXFNdKz8pJT4vZ1xuICB9O1xuXG4gIC8vIFdoZW4gY3VzdG9taXppbmcgYHRlbXBsYXRlU2V0dGluZ3NgLCBpZiB5b3UgZG9uJ3Qgd2FudCB0byBkZWZpbmUgYW5cbiAgLy8gaW50ZXJwb2xhdGlvbiwgZXZhbHVhdGlvbiBvciBlc2NhcGluZyByZWdleCwgd2UgbmVlZCBvbmUgdGhhdCBpc1xuICAvLyBndWFyYW50ZWVkIG5vdCB0byBtYXRjaC5cbiAgdmFyIG5vTWF0Y2ggPSAvKC4pXi87XG5cbiAgLy8gQ2VydGFpbiBjaGFyYWN0ZXJzIG5lZWQgdG8gYmUgZXNjYXBlZCBzbyB0aGF0IHRoZXkgY2FuIGJlIHB1dCBpbnRvIGFcbiAgLy8gc3RyaW5nIGxpdGVyYWwuXG4gIHZhciBlc2NhcGVzID0ge1xuICAgIFwiJ1wiOiAgICAgIFwiJ1wiLFxuICAgICdcXFxcJzogICAgICdcXFxcJyxcbiAgICAnXFxyJzogICAgICdyJyxcbiAgICAnXFxuJzogICAgICduJyxcbiAgICAnXFx1MjAyOCc6ICd1MjAyOCcsXG4gICAgJ1xcdTIwMjknOiAndTIwMjknXG4gIH07XG5cbiAgdmFyIGVzY2FwZXIgPSAvXFxcXHwnfFxccnxcXG58XFx1MjAyOHxcXHUyMDI5L2c7XG5cbiAgdmFyIGVzY2FwZUNoYXIgPSBmdW5jdGlvbihtYXRjaCkge1xuICAgIHJldHVybiAnXFxcXCcgKyBlc2NhcGVzW21hdGNoXTtcbiAgfTtcblxuICAvLyBKYXZhU2NyaXB0IG1pY3JvLXRlbXBsYXRpbmcsIHNpbWlsYXIgdG8gSm9obiBSZXNpZydzIGltcGxlbWVudGF0aW9uLlxuICAvLyBVbmRlcnNjb3JlIHRlbXBsYXRpbmcgaGFuZGxlcyBhcmJpdHJhcnkgZGVsaW1pdGVycywgcHJlc2VydmVzIHdoaXRlc3BhY2UsXG4gIC8vIGFuZCBjb3JyZWN0bHkgZXNjYXBlcyBxdW90ZXMgd2l0aGluIGludGVycG9sYXRlZCBjb2RlLlxuICAvLyBOQjogYG9sZFNldHRpbmdzYCBvbmx5IGV4aXN0cyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkuXG4gIF8udGVtcGxhdGUgPSBmdW5jdGlvbih0ZXh0LCBzZXR0aW5ncywgb2xkU2V0dGluZ3MpIHtcbiAgICBpZiAoIXNldHRpbmdzICYmIG9sZFNldHRpbmdzKSBzZXR0aW5ncyA9IG9sZFNldHRpbmdzO1xuICAgIHNldHRpbmdzID0gXy5kZWZhdWx0cyh7fSwgc2V0dGluZ3MsIF8udGVtcGxhdGVTZXR0aW5ncyk7XG5cbiAgICAvLyBDb21iaW5lIGRlbGltaXRlcnMgaW50byBvbmUgcmVndWxhciBleHByZXNzaW9uIHZpYSBhbHRlcm5hdGlvbi5cbiAgICB2YXIgbWF0Y2hlciA9IFJlZ0V4cChbXG4gICAgICAoc2V0dGluZ3MuZXNjYXBlIHx8IG5vTWF0Y2gpLnNvdXJjZSxcbiAgICAgIChzZXR0aW5ncy5pbnRlcnBvbGF0ZSB8fCBub01hdGNoKS5zb3VyY2UsXG4gICAgICAoc2V0dGluZ3MuZXZhbHVhdGUgfHwgbm9NYXRjaCkuc291cmNlXG4gICAgXS5qb2luKCd8JykgKyAnfCQnLCAnZycpO1xuXG4gICAgLy8gQ29tcGlsZSB0aGUgdGVtcGxhdGUgc291cmNlLCBlc2NhcGluZyBzdHJpbmcgbGl0ZXJhbHMgYXBwcm9wcmlhdGVseS5cbiAgICB2YXIgaW5kZXggPSAwO1xuICAgIHZhciBzb3VyY2UgPSBcIl9fcCs9J1wiO1xuICAgIHRleHQucmVwbGFjZShtYXRjaGVyLCBmdW5jdGlvbihtYXRjaCwgZXNjYXBlLCBpbnRlcnBvbGF0ZSwgZXZhbHVhdGUsIG9mZnNldCkge1xuICAgICAgc291cmNlICs9IHRleHQuc2xpY2UoaW5kZXgsIG9mZnNldCkucmVwbGFjZShlc2NhcGVyLCBlc2NhcGVDaGFyKTtcbiAgICAgIGluZGV4ID0gb2Zmc2V0ICsgbWF0Y2gubGVuZ3RoO1xuXG4gICAgICBpZiAoZXNjYXBlKSB7XG4gICAgICAgIHNvdXJjZSArPSBcIicrXFxuKChfX3Q9KFwiICsgZXNjYXBlICsgXCIpKT09bnVsbD8nJzpfLmVzY2FwZShfX3QpKStcXG4nXCI7XG4gICAgICB9IGVsc2UgaWYgKGludGVycG9sYXRlKSB7XG4gICAgICAgIHNvdXJjZSArPSBcIicrXFxuKChfX3Q9KFwiICsgaW50ZXJwb2xhdGUgKyBcIikpPT1udWxsPycnOl9fdCkrXFxuJ1wiO1xuICAgICAgfSBlbHNlIGlmIChldmFsdWF0ZSkge1xuICAgICAgICBzb3VyY2UgKz0gXCInO1xcblwiICsgZXZhbHVhdGUgKyBcIlxcbl9fcCs9J1wiO1xuICAgICAgfVxuXG4gICAgICAvLyBBZG9iZSBWTXMgbmVlZCB0aGUgbWF0Y2ggcmV0dXJuZWQgdG8gcHJvZHVjZSB0aGUgY29ycmVjdCBvZmZlc3QuXG4gICAgICByZXR1cm4gbWF0Y2g7XG4gICAgfSk7XG4gICAgc291cmNlICs9IFwiJztcXG5cIjtcblxuICAgIC8vIElmIGEgdmFyaWFibGUgaXMgbm90IHNwZWNpZmllZCwgcGxhY2UgZGF0YSB2YWx1ZXMgaW4gbG9jYWwgc2NvcGUuXG4gICAgaWYgKCFzZXR0aW5ncy52YXJpYWJsZSkgc291cmNlID0gJ3dpdGgob2JqfHx7fSl7XFxuJyArIHNvdXJjZSArICd9XFxuJztcblxuICAgIHNvdXJjZSA9IFwidmFyIF9fdCxfX3A9JycsX19qPUFycmF5LnByb3RvdHlwZS5qb2luLFwiICtcbiAgICAgIFwicHJpbnQ9ZnVuY3Rpb24oKXtfX3ArPV9fai5jYWxsKGFyZ3VtZW50cywnJyk7fTtcXG5cIiArXG4gICAgICBzb3VyY2UgKyAncmV0dXJuIF9fcDtcXG4nO1xuXG4gICAgdHJ5IHtcbiAgICAgIHZhciByZW5kZXIgPSBuZXcgRnVuY3Rpb24oc2V0dGluZ3MudmFyaWFibGUgfHwgJ29iaicsICdfJywgc291cmNlKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBlLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuXG4gICAgdmFyIHRlbXBsYXRlID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgcmV0dXJuIHJlbmRlci5jYWxsKHRoaXMsIGRhdGEsIF8pO1xuICAgIH07XG5cbiAgICAvLyBQcm92aWRlIHRoZSBjb21waWxlZCBzb3VyY2UgYXMgYSBjb252ZW5pZW5jZSBmb3IgcHJlY29tcGlsYXRpb24uXG4gICAgdmFyIGFyZ3VtZW50ID0gc2V0dGluZ3MudmFyaWFibGUgfHwgJ29iaic7XG4gICAgdGVtcGxhdGUuc291cmNlID0gJ2Z1bmN0aW9uKCcgKyBhcmd1bWVudCArICcpe1xcbicgKyBzb3VyY2UgKyAnfSc7XG5cbiAgICByZXR1cm4gdGVtcGxhdGU7XG4gIH07XG5cbiAgLy8gQWRkIGEgXCJjaGFpblwiIGZ1bmN0aW9uLiBTdGFydCBjaGFpbmluZyBhIHdyYXBwZWQgVW5kZXJzY29yZSBvYmplY3QuXG4gIF8uY2hhaW4gPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIgaW5zdGFuY2UgPSBfKG9iaik7XG4gICAgaW5zdGFuY2UuX2NoYWluID0gdHJ1ZTtcbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH07XG5cbiAgLy8gT09QXG4gIC8vIC0tLS0tLS0tLS0tLS0tLVxuICAvLyBJZiBVbmRlcnNjb3JlIGlzIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLCBpdCByZXR1cm5zIGEgd3JhcHBlZCBvYmplY3QgdGhhdFxuICAvLyBjYW4gYmUgdXNlZCBPTy1zdHlsZS4gVGhpcyB3cmFwcGVyIGhvbGRzIGFsdGVyZWQgdmVyc2lvbnMgb2YgYWxsIHRoZVxuICAvLyB1bmRlcnNjb3JlIGZ1bmN0aW9ucy4gV3JhcHBlZCBvYmplY3RzIG1heSBiZSBjaGFpbmVkLlxuXG4gIC8vIEhlbHBlciBmdW5jdGlvbiB0byBjb250aW51ZSBjaGFpbmluZyBpbnRlcm1lZGlhdGUgcmVzdWx0cy5cbiAgdmFyIHJlc3VsdCA9IGZ1bmN0aW9uKGluc3RhbmNlLCBvYmopIHtcbiAgICByZXR1cm4gaW5zdGFuY2UuX2NoYWluID8gXyhvYmopLmNoYWluKCkgOiBvYmo7XG4gIH07XG5cbiAgLy8gQWRkIHlvdXIgb3duIGN1c3RvbSBmdW5jdGlvbnMgdG8gdGhlIFVuZGVyc2NvcmUgb2JqZWN0LlxuICBfLm1peGluID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgXy5lYWNoKF8uZnVuY3Rpb25zKG9iaiksIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHZhciBmdW5jID0gX1tuYW1lXSA9IG9ialtuYW1lXTtcbiAgICAgIF8ucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gW3RoaXMuX3dyYXBwZWRdO1xuICAgICAgICBwdXNoLmFwcGx5KGFyZ3MsIGFyZ3VtZW50cyk7XG4gICAgICAgIHJldHVybiByZXN1bHQodGhpcywgZnVuYy5hcHBseShfLCBhcmdzKSk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIEFkZCBhbGwgb2YgdGhlIFVuZGVyc2NvcmUgZnVuY3Rpb25zIHRvIHRoZSB3cmFwcGVyIG9iamVjdC5cbiAgXy5taXhpbihfKTtcblxuICAvLyBBZGQgYWxsIG11dGF0b3IgQXJyYXkgZnVuY3Rpb25zIHRvIHRoZSB3cmFwcGVyLlxuICBfLmVhY2goWydwb3AnLCAncHVzaCcsICdyZXZlcnNlJywgJ3NoaWZ0JywgJ3NvcnQnLCAnc3BsaWNlJywgJ3Vuc2hpZnQnXSwgZnVuY3Rpb24obmFtZSkge1xuICAgIHZhciBtZXRob2QgPSBBcnJheVByb3RvW25hbWVdO1xuICAgIF8ucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgb2JqID0gdGhpcy5fd3JhcHBlZDtcbiAgICAgIG1ldGhvZC5hcHBseShvYmosIGFyZ3VtZW50cyk7XG4gICAgICBpZiAoKG5hbWUgPT09ICdzaGlmdCcgfHwgbmFtZSA9PT0gJ3NwbGljZScpICYmIG9iai5sZW5ndGggPT09IDApIGRlbGV0ZSBvYmpbMF07XG4gICAgICByZXR1cm4gcmVzdWx0KHRoaXMsIG9iaik7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gQWRkIGFsbCBhY2Nlc3NvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuXG4gIF8uZWFjaChbJ2NvbmNhdCcsICdqb2luJywgJ3NsaWNlJ10sIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICB2YXIgbWV0aG9kID0gQXJyYXlQcm90b1tuYW1lXTtcbiAgICBfLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJlc3VsdCh0aGlzLCBtZXRob2QuYXBwbHkodGhpcy5fd3JhcHBlZCwgYXJndW1lbnRzKSk7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gRXh0cmFjdHMgdGhlIHJlc3VsdCBmcm9tIGEgd3JhcHBlZCBhbmQgY2hhaW5lZCBvYmplY3QuXG4gIF8ucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuX3dyYXBwZWQ7XG4gIH07XG5cbiAgLy8gUHJvdmlkZSB1bndyYXBwaW5nIHByb3h5IGZvciBzb21lIG1ldGhvZHMgdXNlZCBpbiBlbmdpbmUgb3BlcmF0aW9uc1xuICAvLyBzdWNoIGFzIGFyaXRobWV0aWMgYW5kIEpTT04gc3RyaW5naWZpY2F0aW9uLlxuICBfLnByb3RvdHlwZS52YWx1ZU9mID0gXy5wcm90b3R5cGUudG9KU09OID0gXy5wcm90b3R5cGUudmFsdWU7XG5cbiAgXy5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJycgKyB0aGlzLl93cmFwcGVkO1xuICB9O1xuXG4gIC8vIEFNRCByZWdpc3RyYXRpb24gaGFwcGVucyBhdCB0aGUgZW5kIGZvciBjb21wYXRpYmlsaXR5IHdpdGggQU1EIGxvYWRlcnNcbiAgLy8gdGhhdCBtYXkgbm90IGVuZm9yY2UgbmV4dC10dXJuIHNlbWFudGljcyBvbiBtb2R1bGVzLiBFdmVuIHRob3VnaCBnZW5lcmFsXG4gIC8vIHByYWN0aWNlIGZvciBBTUQgcmVnaXN0cmF0aW9uIGlzIHRvIGJlIGFub255bW91cywgdW5kZXJzY29yZSByZWdpc3RlcnNcbiAgLy8gYXMgYSBuYW1lZCBtb2R1bGUgYmVjYXVzZSwgbGlrZSBqUXVlcnksIGl0IGlzIGEgYmFzZSBsaWJyYXJ5IHRoYXQgaXNcbiAgLy8gcG9wdWxhciBlbm91Z2ggdG8gYmUgYnVuZGxlZCBpbiBhIHRoaXJkIHBhcnR5IGxpYiwgYnV0IG5vdCBiZSBwYXJ0IG9mXG4gIC8vIGFuIEFNRCBsb2FkIHJlcXVlc3QuIFRob3NlIGNhc2VzIGNvdWxkIGdlbmVyYXRlIGFuIGVycm9yIHdoZW4gYW5cbiAgLy8gYW5vbnltb3VzIGRlZmluZSgpIGlzIGNhbGxlZCBvdXRzaWRlIG9mIGEgbG9hZGVyIHJlcXVlc3QuXG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoJ3VuZGVyc2NvcmUnLCBbXSwgZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gXztcbiAgICB9KTtcbiAgfVxufS5jYWxsKHRoaXMpKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi91bmRlcnNjb3JlL3VuZGVyc2NvcmUuanNcbi8vIG1vZHVsZSBpZCA9IDIzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGxhenlhY3Rpb24sIGxhenlpbWFnZSwgc3RpY2t5aGVhZGVyIH0gZnJvbSAnLi9TY3JvbGxBY3Rpb24vaW5kZXgnXG5pbXBvcnQgJy4vU2Nyb2xsQWN0aW9uL2xhenlpbWFnZS5jc3MnXG5pbXBvcnQgJy4vU2Nyb2xsQWN0aW9uL3N0aWNreWhlYWRlci5jc3MnXG5pbXBvcnQgJy4vbWFpbi5jc3MnXG5cbmZ1bmN0aW9uIGFjdGlvbiAoZWxlbWVudCwgbm93KSB7XG4gIGVsZW1lbnQudGV4dENvbnRlbnQgPSBgSGVsbG8sICR7bm93KCl9LmBcbn1cblxuZnVuY3Rpb24gaW5pdCAoZXYpIHtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldi50eXBlLCBpbml0KVxuICBsYXp5YWN0aW9uKCcubGF6eWFjdGlvbicsIGFjdGlvbiwgRGF0ZS5ub3cpXG4gIGxhenlpbWFnZSgnLmhvcml6b250YWwtc2Nyb2xsLWJveCAubGF6eWltYWdlJywgJ3NyYycsIHsgcGFyZW50OiAnLmhvcml6b250YWwtc2Nyb2xsLWJveCcgfSlcbiAgbGF6eWltYWdlKCcudmVydGljYWwtc2Nyb2xsLWFyZWEgLmxhenlpbWFnZScsICdzcmMnKVxuICBsYXp5aW1hZ2UoJy52ZXJ0aWNhbC1zY3JvbGwtYm94IC5sYXp5aW1hZ2UnLCAnc3JjJywgeyBwYXJlbnQ6ICcudmVydGljYWwtc2Nyb2xsLWJveCcgfSlcbiAgc3RpY2t5aGVhZGVyKCcuc3RpY2t5aGVhZGVyJylcbn1cblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXQsIGZhbHNlKVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3Njcm9sbGV2ZW50cy5qcyJdLCJzb3VyY2VSb290IjoiIn0=